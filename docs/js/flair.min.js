/**
 * @preserve
 * FlairJS
 * True Object Oriented JavaScript
 * Version 0.15.30
 * Sun, 17 Feb 2019 01:17:00 GMT
 * (c) 2017-2019 Vikas Burman
 * MIT
 * https://flairjs.com
 */
!function(e,n){"use strict";"function"==typeof define&&define.amd?define(n):"object"==typeof exports?(void 0!==module&&module.exports&&(exports=module.exports=n()),module.exports=exports=n()):e.flair=n()}(this,function(){"use strict";let e=new Function("try {return this===global;}catch(e){return false;}")(),n=!0,t=()=>{},r={},i=[],s={},a="";if(e){let e=process.argv.findIndex(e=>{return!!e.startsWith("--flairSymbols")});e!==-1&&(a=process.argv[e].substr(2).split("=")[1])}else a="undefined"!=typeof(!0).flairSymbols?(!0).flairSymbols:"";a&&(i=a.split(",").map(e=>e.trim())),s.symbols=Object.freeze(i),s.env=Object.freeze({type:e?"server":"client",global:n,isTesting:i.indexOf("TEST")!==-1,isServer:e,isClient:!e,isCordova:!e&&!!(!0).cordova,isNodeWebkit:e&&process.versions["node-webkit"],isProd:i.indexOf("DEBUG")===-1&&i.indexOf("PROD")!==-1,isDebug:i.indexOf("DEBUG")!==-1}),r.info=Object.freeze({name:"FlairJS",version:"0.15.30",copyright:"(c) 2017-2019 Vikas Burman",license:"MIT",link:"https://flairjs.com",lupdate:new Date("Sun, 17 Feb 2019 01:17:00 GMT")}),r.members=[],r.options=Object.freeze(s),r.Aspect=r.Class("Aspect",function(e){let n=null,t=null,r=null;e("abstract"),this.construct((...e)=>{this.args=e}),this.prop("args",[]),this.func("before",e=>{return"function"==typeof e&&(n=e),n}),this.func("after",e=>{return"function"==typeof e&&(t=e),t}),this.func("around",e=>{return"function"==typeof e&&(r=e),r})});let o=[],u=e=>{return e.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&")},c=e=>{return new RegExp("^"+e.split(/\*+/).map(u).join(".*")+"$")};r.Aspects={},r.Aspects.raw=(()=>{return o}),r.Aspects.register=((e,n)=>{let t=e||"~",r="",i="",s="",a="~",u="";if(t.indexOf("/")!==-1){let e=t.split("/");t=e[0].trim(),a=e[1].trim()}if("~"===t)r="~",i="~",s="~";else if(""===t)r="^",i="~",s="~";else if(t.indexOf(".")===-1)if(r="^",t.indexOf(":")===-1)i=t,s="~";else{let e=t.split(":");i=e[0].trim(),s=e[1].trim()}else if(r=t.substr(0,t.lastIndexOf(".")),t=t.substr(t.lastIndexOf(".")+1),t.indexOf(":")===-1)i=t,s="~";else{let e=t.split(":");i=e[0].trim(),s=e[1].trim()}"*"!==r&&""!==r||(r="~"),"*"!==i&&""!==i||(i="~"),"*"!==s&&""!==s||(s="~"),"*"!==a&&""!==a||(a="~"),u=`${r}=${i}=${s}=${a}`,o[u]=o[u]||[],o[u].push(n)}),r.Aspects.get=((e,n,t)=>{let r=[],i="",s="",a=n.trim();e.indexOf(".")!==-1?(i=e.substr(0,e.lastIndexOf(".")).trim(),s=e.substr(e.lastIndexOf(".")+1).trim()):(i="^",s=e.trim());for(let u in o){let e=u.split("="),n=e[0],f=c(n),l=e[1],p=c(l),m=e[2],d=c(m),y=e[3],g=c(y),h="~"===y;if((i===n||f.test(i))&&(s===l||p.test(s))&&(a===m||d.test(a))){if(!h)for(let e of t)if(e.name===y||g.test(e.name)){h=!0;break}if(h)for(let n of o[u])r.indexOf(n)===-1&&r.push(n)}}return r}),r.Aspects.attach=((e,n,t,r)=>{let i=[],s=[],a=[],o=null,u=null;for(let c of r)o=new c,u=o.before(),"function"==typeof u&&i.push(u),u=o.around(),"function"==typeof u&&a.push(u),u=o.after(),"function"==typeof u&&s.push(u);a.length>0&&a.reverse();let f=function(...r){let o=null,u=null,c={typeName:()=>{return n},funcName:()=>{return t},error:e=>{return e&&(o=e),o},result:e=>{return"undefined"!=typeof e&&(u=e),u},args:()=>{return r},data:{}};for(let f of i)try{f(c)}catch(e){o=e}const l=e=>{for(let n of s)try{n(e)}catch(e){c.error(e)}};let p=e,m=null;for(let d of a)p=d(c,p);try{m=p(...r),m&&"function"==typeof m.then?c.result(new Promise((e,n)=>{m.then(n=>{c.result(n),l(c),e(c.result())}).catch(e=>{c.error(e),l(c),n(c.error())})})):(c.result(m),l(c))}catch(e){c.error(e)}return c.result()};return f});const f=r.Aspects,l=function(e,n){if("string"==typeof e&&(n=e,e=!1),"string"!=typeof n)throw new k.InvalidArgument("constraints");let t={isModifier:e,constraints:n};return t},p=(e,...n)=>{if(!e||["string","class"].indexOf(Q(e)===-1))throw new k("InvalidArgument","Argument type is invalid. (name)");if(e&&"string"!=typeof e&&!H(e,"Attribute"))throw new k("InvalidArgument","Argument type is invalid. (name)");let t=null,r=null,i=null;if("string"==typeof e){if(i=p._.inbuilt[e]||null,!i){if(t=w.getType(e),!t)throw new k("NotFound",`Attribute is not found. (${e})`);e=t._.name}}else t=e,e=t._.name;if($(p._.bucket,"name",e)!==-1)throw new k("Duplicate",`Duplicate attributes are not allowed. (${e})`);t&&(r=new t(...n),i=new l(r.constraints)),p._.bucket.push({name:e,cfg:i,isCustom:null!==r,attr:r,args:n})};p._=Object.freeze({bucket:[],inbuilt:Object.freeze({static:new l(!0,"((class || struct) && !$abstract) || (((class || struct) && (prop || func)) && !$abstract && !$virtual && !$override)"),abstract:new l(!0,"((class || struct) && !$sealed && !$static) || (((class || struct) && (prop || func || event)) && !$override && !$sealed && !$static)"),virtual:new l(!0,"(class || struct) && (prop || func || construct || dispose || event) && !$abstract && !$override && !$sealed && !$static"),override:new l(!0,"(class || struct) && (prop || func || construct || dispose || event) && ((@virtual || @abstract) && !virtual && !abstract) && !$sealed, !$static)"),sealed:new l(!0,"(class || ((class && (prop || func || event)) && override)"),private:new l(!0,"(class || struct) && (prop || func || event) && !$protected && !@private && !$static"),protected:new l(!0,"(class || struct) && (prop || func || event) && !$private && !$static"),readonly:new l(!0,"(class || struct) && prop && !abstract"),async:new l(!0,"(class || struct) && func"),enumerate:new l("(class || struct) && prop || func || event"),dispose:new l("class && prop"),type:new l("(class || struct || mixin) && prop"),args:new l("(class || struct || mixin) && (func || construct)"),inject:new l("class && (prop || func || construct) && !static && !session && !state"),singleton:new l("(class && !$abstract && !$static && !(prop || func || event))"),serialize:new l("((class || struct) || ((class || struct) && prop)) && !$abstract, !$static"),deprecate:new l("!construct && !dispose"),session:new l("class && prop && !$static && !$state && !$readonly && !$abstract && !$virtual"),state:new l("class && prop && !$static && !$session && !$readonly && !$abstract && !$virtual"),conditional:new l("(class || struct || mixin) && (prop || func || event)"),noserialize:new l("(class || struct || mixin) && prop"),mixed:new l("prop || func || event"),event:new l("func")})}),p.collect=(()=>{let e=p._.bucket.slice();return p.clear(),e}),p.has=(e=>{return p._.bucket.findIndex(n=>n.name===e)!==-1}),p.clear=(()=>{p._.bucket.length=0}),r.attr=p,r.members.push("attr"),r.Attribute=r.Class("Attribute",function(e){let n=null;e("abstract"),this.construct((...e)=>{this.args=[];for(let n of e)if("string"==typeof n)if(n.startsWith("[")&&n.endsWith("]")){let e=n.replace("[","").replace("]",""),t=function(){let n=this[e];return"function"==typeof n?n():n};this.args.push(t)}else this.args.push(n);else this.args.push(n)}),this.func("constraints",""),this.prop("args",[]),this.func("decorate",e=>{return"function"==typeof e&&(n=e),n}),this.func("resetEventInterface",(e,n)=>{n.subscribe=e.subscribe,n.unsubscribe=e.unsubscribe,delete e.subscribe,delete e.unsubscribe})});const m=(e,n,t)=>{if(!Z(e,"flair"))throw new k.InvalidArgument("obj");n||(n="_construct");let r=[];if(t){let i=e._.attrs.members.probe(t,n).anywhere();i&&r.push(V(i,"name, isCustom, args, type",!0))}else{let t=e._.attrs.members.all(n).anywhere();t&&r.push(...V(t,"name, isCustom, args, type",!0))}return r};r.getAttr=m,r.members.push("getAttr");const d=(e,n)=>{if(!Z(e,"flair"))throw new k.InvalidArgument("Type");let t=[];if(n){let r=e._.attrs.type.probe(n).anywhere();r&&t.push(V(r,"name, isCustom, args, type",!0))}else{let n=e._.attrs.type.all().anywhere();n&&t.push(...V(n,"name, isCustom, args, type",!0))}return t};r.getTypeAttr=d,r.members.push("getTypeAttr");const y={build:e?require("./flair.build.js"):null};r.cli=Object.freeze(y),r.members.push("cli");let g={},h={};r.Assembly=(e=>{if("object"!=typeof e)throw k.InvalidArgument("ado");if("array"!==Q(e.types)||"array"!==Q(e.assets)||"string"!=typeof e.name||"string"!=typeof e.file)throw k.InvalidArgument("ado");let n=r.Struct("Assembly",function(){this.construct(e=>{this.ado=e,this.name=e.name,this.file=D(e.file,!0),this.desc=e.desc||"",this.version=e.version||"",this.copyright=e.copyright||"",this.license=e.license||"",this.types=e.types.slice()||[],this.settings=e.settings||{},this.assets=e.assets.slice()||[],this.hasAssets=e.assets.length>0}),this.props(["readonly"],["ado","name","file","desc","version","copyright","license","types","hasAssets"]),this.prop("isLoaded",!1),this.func("load",()=>{return r.Assembly.load(this.file)}),this.func("getType",e=>{if("string"!=typeof e)throw new k("InvalidArgument","Argument type is invalid. (name)");if(!this.isLoaded)throw new k("NotLoaded",`Assembly is not yet loaded. (${this.file})`);if(this.types.indexOf(e)===-1)throw new k("NotFound",`Type is not found in this assembly. (${e})`);let n=r.Namespace.getType(e);if(!n)throw new k("NotRegistered",`Type is not registered. (${e})`);return n}),this.func("createInstance",(e,...n)=>{if("string"!=typeof e)throw new k("InvalidArgument","Argument type is invalid. (name)");let t=r.Assembly.get(e),i=null;return i=n?new t(...n):new t})});return new n(e)}),r.Assembly.register=((...e)=>{if(!e)throw new k("InvalidArgument","Argument type is invalid. (ados)");let n=!1;for(let t of e){let e=r.Assembly(t),i=e.file;if(g[i])throw new k("DuplicateName",`Assembly is already registered. (${i})`);g[i]=e;for(let s of e.types){if(h[s])throw new k("DuplicateName",`Type is already registered. (${s})`);h[s]=e}n=!0}return n}),r.Assembly.load=(n=>{return new Promise((t,i)=>{if("string"!=typeof n)return void i(new k("InvalidArgument","Argument type is invalid. (file)"));if(!r.Assembly.isRegistered(n))return void i(new k("NotFound",`Assembly is not registered. (${n})`));if(g[n].isLoaded)return void t();if(e)try{require(n),g[n].markLoaded(),t()}catch(e){i(new k("FileLoad",`File load operation failed. (${n})`,e))}else{const e=r.options.env.global.document.createElement("script");e.onload=(()=>{g[n].isLoaded=!0,t()}),e.onerror=(e=>{i(new k("FileLoad",`File load operation failed. (${n})`,e))}),e.async=!0,e.src=n,r.options.env.global.document.body.appendChild(e)}})}),r.Assembly.isRegistered=(e=>{if("string"!=typeof e)throw new k("InvalidArgument","Argument type if not valid. (file)");return"undefined"!=typeof g[e]}),r.Assembly.isLoaded=(e=>{if("string"!=typeof e)throw new k("InvalidArgument","Argument type if not valid. (file)");return"undefined"!=typeof g[e]&&g[e].isLoaded}),r.Assembly.get=(e=>{if("string"!=typeof e)throw new k("InvalidArgument","Argument type if not valid. (name)");return h[e]||null}),r.Assembly.all=(()=>{return Object.values(g).slice()}),r.Assembly.allTypes=(()=>{return Object.keys(h).slice()}),r.Assembly._={reset:()=>{g={},h={}}},r.members.push("Assembly");const b=r.Assembly;r.Namespace=(e=>{if(["class","enum","interface","mixin","struct","resource"].indexOf(e._.type)===-1)throw`Type (${e._.type}) cannot be placed in a namespace.`;if(e._.namespace)throw`Type (${e._.name}) is already contained in a namespace.`;let n=!1;e._.name.startsWith(".")&&(e._.name=e._.name.substr(1),n=!0);let t=r.Namespace.root,i=e._.name,s="",a=i.substr(0,i.lastIndexOf("."));if(i=i.substr(i.lastIndexOf(".")+1),a){let n=a.split(".");for(let r of n)if(r){if("_"===r)throw`Special name "_" is used as namespace in ${e._.name}.`;if(t[r]=t[r]||{},s=r,t[r]._&&"namespace"!==t[r]._.type)throw`${e._.name} cannot be contained in another type (${t[r]._.name})`;t=t[r]}}else if(!n)return;if(t[i])throw`Type ${i} already contained at ${a}.`;t[i]=e,e._.namespace=t,t._=t._||{},t._.name=t._.name||s,t._.type=t._.type||"namespace",t._.types=t._.types||[],t._.types.push(e);let o=()=>{return t._.types.slice()},u=e=>{let n=null,r=t;if(e.indexOf(".")!==-1){let t=e.split(".");for(let i of t)if(i){if("_"===i)throw`Special name "_" is used as name in ${e}.`;if(r=r[i],!r)break}n=r}else n=r[e];return n&&n._&&["class","enum","interface","mixin","struct"].indexOf(n._.type)!==-1?n:null},c=(e,...n)=>{let r=t.getType(e);if(r&&"class"!=r._.type)throw`${name} is not a class.`;return r?new r(...n):null};t.getTypes=t.getTypes||o,t.getType=t.getType||u,t.createInstance=t.createInstance||c}),r.Namespace.root={},r.Namespace.getType=(e=>{return r.Namespace.root.getType?r.Namespace.root.getType(e):null}),r.Namespace.getTypes=(()=>{return r.Namespace.root.getTypes?r.Namespace.root.getTypes():[]}),r.Namespace.createInstance=((e,...n)=>{return r.Namespace.root.createInstance?r.Namespace.root.createInstance(e,...n):null});const w=r.Namespace;r.Namespace._={reset:()=>{}},r.members.push("Namespace"),r.Resource=((e,n,t)=>{const i=e=>{return btoa(encodeURIComponent(e).replace(/%([0-9A-F]{2})/g,function e(n,t){return String.fromCharCode("0x"+t)}))},s=e=>{return decodeURIComponent(atob(e).split("").map(function(e){return"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2)}).join(""))};let a=t,o=n.substr(n.lastIndexOf(".")+1).toLowerCase(),u=["txt","xml","js","json","md","css","html","svg"];if(u.indexOf(o)!==-1)if(r.options.env.isServer){let e=new Buffer(a).toString("base64");a=e.toString("utf8")}else a=s(a);else r.options.env.isServer&&(a=new Buffer(a).toString("base64"));let c={file:()=>{return n},type:()=>{return o},get:()=>{return a},load:(...e)=>{if(r.options.env.isClient&&!c._.isLoaded)if(c._.isLoaded=!0,["gif","jpeg","jpg","png"].indexOf(o)!==-1){let n=e[0];if(n){let e=new Image;e.src="data:image/png;base64,"+t,n.appendChild(e),c._.isLoaded=!0}}else{let t,i,s,u=null;switch(o){case"css":t=r.options.env.global.document.createElement("style"),t.type="text/css",t.name=n,t.innerHTML=a,r.options.env.global.document.head.appendChild(t);break;case"js":i=r.options.env.global.document.createElement("script"),i.type="text/javascript",i.name=n,i.src=a,"function"==typeof cb&&(i.onload=e[0],i.onerror=(()=>{c._.isLoaded=!1})),r.options.env.global.document.head.appendChild(i);break;case"html":s=e[0],u=e[1]||"",s&&(u?s.innerHTML=a:s.insertAdjacentHTML(u,a))}}return c._.isLoaded}};if(c._={name:e,type:"resource",namespace:null,file:n,isLoaded:!1,data:()=>{return a}},c.JSON=null,"json"===c.type())try{c.JSON=Object.freeze(JSON.parse(a))}catch(e){}return r.Namespace(c),Object.freeze(c)}),r.Resource.get=(e=>{let n=r.Namespace.getType(e);return n._&&"resource"===n._.type?n.get():null});let v={};r.Container=((e,n)=>{if("string"!=typeof e)throw new k("InvalidArgument","Argument type is invalid. (alias)");return n?(v[e]||[]).slice():v[e]&&v[e].length>0?v[e][0]:null}),r.Container.isRegistered=(e=>{if("string"!=typeof e)throw new k("InvalidArgument","Argument type is invalid. (alias)");return"undefined"!=typeof v[e]&&v[e].length>0}),r.Container.register=((e,n)=>{if("string"!=typeof e)throw new k("InvalidArgument","Argument type is invalid. (alias)");if(!n)throw new k("InvalidArgument","Argument type is invalid. (type)");if(Z(n,"flair"));else if("object"==typeof n);else{if("string"!=typeof n)throw new k("InvalidArgument",`Argument type is invalid. (${Q(n)})`);n=D(n),n.endsWith(".js")||n.endsWith(".mjs")}return v[e]||(v[e]=[]),v[e].push(n),!0}),r.Container.resolve=((e,n,...t)=>{if("string"!=typeof e)throw new k("InvalidArgument","Argument type is invalid. (alias)");if("boolean"!=typeof n)throw new k("InvalidArgument","Argument type is invalid. (isMultiResolve)");let i=null,s=e=>{let n=e;if("string"==typeof e)if(e.endsWith(".js")||e.endsWith(".mjs"));else{let n=r.Namespace.getType(e);n&&(e=n)}return["class","struct"].indexOf(Q(e))!==-1&&(n=t?new e(...t):new e),n};if(v[e]&&v[e].length>0)if(n){i=[];for(let n of v[e])i.push(s(n))}else{let n=v[e][0];i=s(n)}return i}),r.Container._={reset:()=>{v={}}},r.members.push("Container");const _=r.Container;let x=[];r.include=((e,n)=>{let t=Q(e),i=null;"string"!==t&&"array"!==t&&(i=new k("InvalidArgument","Argument type is invalid. (deps)")),i||"string"!==t||(e=[e]),i||"function"==typeof n||(i=new k("InvalidArgument","Argument type is invalid. (fn)"));let s={},a=i?null:e.slice(),o=(e,n)=>{if("string"!=typeof e)throw new k("InvalidArgument","Argument type is invalid. (name)");if(!s[e])throw new k("InvalidName",`Name is not valid. (${e})`);if(s[e].error&&n)throw s[e].error;return s[e].dep},u=()=>{"function"==typeof n&&n(o,i)},c=()=>{if(i||0===a.length)return void u();{let e=a.shift().trim(),n="",t=null,o=null;if(""===e)return i=new k("InvalidArgument",`Argument type is invalid. (deps)`),void u();let f=e.split(":");if(2!==f.length)return i=new k("InvalidArgument",`Argument type is invalid. (${e})`),void u();if(n=f[0].trim(),e=f[1].trim(),s[n])return i=new k("DuplicateName",`Duplicate names are not allowed. (${n})`),void u();s[n]={error:null,dep:null},e=D(e);let l=n=>{if(e.startsWith("[")&&e.endsWith("]")&&e.indexOf(".")===-1){let n=e.substr(1,e.length-2).trim();r.Container.isRegistered(n)&&(t=r.Container(n),"string"==typeof t&&(e=t,t=null))}n()},p=n=>{t=r.Namespace.getType(e),n()},m=n=>{let i=r.Assembly.get(e);i?i.isLoaded()?(t=r.Namespace.getType(e),n()):i.load().then(()=>{t=r.Namespace.getType(e),n()}).catch(e=>{o=new k("AssemblyLoad",`Assembly load operation failed with error: ${e}. (${i.file()})`),n()}):n()},d=n=>{let r=e.substr(e.lastIndexOf(".")+1).toLowerCase();r?"js"===r||"mjs"===r?(e=D(e,!0),n()):q(e).then(e=>{t=e,n()}).catch(t=>{o=new k("FileLoad",`File load failed. (${e})`,t),n()}):n()},y=n=>{B(e).then(e=>{t=e,n()}).catch(t=>{o=new k("ModuleLoad",`Module load operation failed with error: ${t}. (${e})`),n()})},g=e=>{s[n].error=o,s[n].dep=t,e||x.pop(),c()};if(""===e)return void g(!0);if(x.indexOf(e)!==-1)return o=new k("CircularDependency",`Circular dependency identified. (${e})`),void g(!0);x.push(e),l(()=>{t?g():p(()=>{t?g():m(()=>{t?g():d(()=>{t?g():y(()=>{return t?void g():(o=new k("DependencyResolution",`Failed to resolve dependency. ${e}`),void g())})})})})})}};c()}),r.include._={reset:()=>{x=[]}},r.members.push("include");const A=e=>{if("instance"!==Q(e))throw new k("InvalidArgument","Argument type is invalid. (obj)");e._.dispose()};r.dispose=A,r.members.push("dispose");const I=(e,n)=>{if("instance"!==Q(e))throw new k("InvalidArgument","Argument type is invalid. (obj)");if("function"!==Q(n))throw new k("InvalidArgument","Argument type is invalid. (fn)");let t=null,r=!1,i=!1,s=()=>{r||"function"!=typeof e._.dispose||(r=!0,e._.dispose())};try{t=n(e),t&&"function"==typeof t.finally&&(i=!0,t=t.finally(e=>{return s(),e}))}finally{i||s()}return t};r.using=I,r.members.push("using");const O=(...e)=>{if(0===e.length)throw new k("InvalidArgument","Argument must be defined. (patterns)");let n=(...n)=>{let t=null,r=null,i="",s="",a=-1,o=-1,u=!1,c=0,f={raw:n||[],index:-1,isInvalid:!1,error:null,values:{}};if(e)for(let l of e){a++,o=-1,u=!1,c=0,t=l.split(",");for(let e of t){if(o++,r=e.split(":"),2!==r.length?(i=`_${a}_${o}`,s=e.trim()||""):(i=r[0].trim()||"",s=r[1].trim()||""),o>f.raw.length){u=!1;break}if(!Z(f.raw[o],s)){u=!1;break}f.values[i]=f.raw[o],u=!0,c++}if(u&&c===f.raw.length){f.index=a;break}}return f.isInvalid=f.index===-1,f.error=f.isInvalid?new k("InvalidArguments","One or more argument types are invalid."):null,f};return Object.freeze(n)};r.Args=O,r.members.push("Args");const k=function(e,n,t){let r="",i="",s=null;e?"string"==typeof e?r=e:"object"==typeof e?(r=e.name||"UnknownException",s=e,i=s.message):r="UndefinedException":r="UndefinedException",n?"string"==typeof n?i=n:"object"==typeof n?s||(s=n,r=r||s.name,i=s.message):r="UndefinedException":s&&(r=r||s.name,i=s.message),t&&"object"==typeof t&&(s||(s=t)),r&&!r.endsWith("Exception")&&(r+="Exception");let a=new Error(i||"");return a.name=r||"UndefinedException",a.error=s||null,Object.freeze(a)};k.InvalidArgument=(e=>{return new k("InvalidArgument",`Argument type is invalid. (${e})`)}),r.Exception=k,r.members.push("Exception");const T=function(){let e={};this.add=((n,t)=>{if("string"!=typeof name)throw new k("InvalidArgument","Argument type is invalid. (event)");if("function"!=typeof t)throw new k("InvalidArgument","Argument type is invalid. (handler)");e[n]||(e[name]=[]),e[name].push(t)}),this.remove=((n,t)=>{if("string"!=typeof name)throw new k("InvalidArgument","Argument type is invalid. (event)");if("function"!=typeof t)throw new k("InvalidArgument","Argument type is invalid. (handler)");if(e[n]){let r=e[n].indexOf(t);r!==-1&&e[n].splice(r,1)}}),this.dispatch=((n,t)=>{e[n]&&e[n].forEach(e=>{setTimeout(()=>{e({name:n,args:t})},0)})}),this.count=(n=>{return e[n]?e[n].length:0}),this.clear=(()=>{e={}})},j=new T,N=j.dispatch,S=(e,n,t)=>{return t?void j.remove(e,n):void j.add(e,n)};r.on=Object.freeze(S),r.members.push("on");const C=(e,n)=>{let t=p.collect(),r=null,i=null,s="type"===e.level,a=M(!0,e),o=M(!1,e);s?(r=e.attrs.type,i=e.modifiers.type):(r=e.attrs.members[n]=[],i=e.modifiers.members[n]=[]);const u=t=>{let r=!1,i=["class","struct","enum","interface","mixin"],s=["prop","func","construct","dispose","event"],u=["static","abstract","sealed","virtual","override","private","protected","readonly","async"],c=[],f=[],l=t.constraints;const p=e=>{let n={withWhat:"",matchType:"",original:e,name:"",value:!1};switch(e.substr(0,1)){case"$":n.matchType="anywhere",n.name=e.substr(1);break;case"@":n.matchType="inherited",n.name=e.substr(1);break;default:n.matchType="current",n.name=e}e.endsWith("^")?(n.withWhat="typeName",n.name=n.name.replace("^","")):i.indexOf(n.name)!==-1?(n.withWhat="typeType",n.matchType="current"):s.indexOf(n.name)!==-1?(n.withWhat="memberType",n.matchType="current"):u.indexOf(n.name)!==0-1?n.withWhat="modifier":n.withWhat="attribute",c.push(n)},m=()=>{let e=new RegExp("/[^!&!|()]/g"),n="";for(;!0;){n=e.exec(l);{if(null===n)break;f.push(n)}}n="";for(let t of f)" "!==t[0]?n+=t[0]:(""!==n&&p(n),n="")};m();for(let d of c){switch(d.withWhat){case"typeName":switch(d.matchType){case"anywhere":d.value=d.name===n||e.Type._.isDerivedFrom(d.name);break;case"inherited":d.value=e.Type._.isDerivedFrom(d.name);break;case"current":d.value=d.name===n}break;case"typeType":d.value=e.type===d.name;break;case"memberType":d.value=e.members[n]===d.name;break;case"modifier":d.value=!!a.members.probe(d.name,n)[d.matchType]();break;case"attribute":d.value=!!o.members.probe(d.name,n)[d.matchType]()}l=U(l,d.original,d.value.toString())}if(r=new Function("try {return constraintsLex;}catch(e){return false;}")(),!r)throw new k("InvalidOperation",`${t.cfg.isModifier?"Modifier":"Attribute"} ${t.name} could not be applied. (${n})`);return r};for(let c of t)u(c)&&(c=V(c,null,!1,{type:e.name}),c.isCustom?r.push(c):c.cfg.isModifier?i.push(c):r.push(c))},M=(e,n)=>{let t=e?"modifiers":"attrs",r=(e,r,i)=>{let s="type"===n.level,a=null;if(s)if(i){let r=n.previous();for(;!0&&null!==r&&!(a=F(r[t].type,"name",e));)r=r.previous()}else a=F(n[t].type,"name",e);else if(i){let i=n.previous();for(;!0&&null!==i&&!(a=F(i[t].members[r],"name",e));)i=i.previous()}else a=F(n[t].members[r],"name",e);return a},i=(e,n,t)=>{return null!==c.get(e,n,t)};const s=(e,n)=>{let t={anywhere:()=>{return c.get(e,n)||c.get(e,n,!0)},current:()=>{return c.get(e,n)},inherited:()=>{return c.get(e,n,!0)},only:{current:()=>{return c.get(e,n)&&!c.get(e,n,!0)},inherited:()=>{return!c.get(e,n)&&c.get(e,n,!0)}}};return t},a=e=>{let n={anywhere:()=>{return c.get(e,"")||c.get(e,"",!0)},current:()=>{return c.get(e,"")},inherited:()=>{return c.get(e,"",!0)},only:{current:()=>{return c.get(e,"")&&!c.get(e,"",!0)},inherited:()=>{return!c.get(e,"")&&c.get(e,"",!0)}}};return n},o=e=>{let r={current:()=>{return n[t].members[e].slice()},inherited:()=>{let r=[],i=null,s=n.previous();for(;!0&&null!==s;)i=F(s[t].members,"name",e),i&&r.push(...i),s=s.previous();return r},anywhere:()=>{return[...r.current(),...r.inherited()]}};return r},u=()=>{let e={current:()=>{return n[t].type.slice()},inherited:()=>{let e=[],r=null,i=n.previous();for(;!0&&null!==i;)r=i[t].type.slice(),r&&e.push(...r),i=i.previous();return e},anywhere:()=>{return[...e.current(),...e.inherited()]}};return e},c={get:r,has:i,type:{get:(e,n)=>{return c.get(e,!0,n)},has:(e,n)=>{return c.has(e,!0,n)},all:u,probe:a},members:{get:r,has:i,all:o,probe:s}};return e&&(c.members.is=((e,n)=>{let t=s(e,n);switch(e){case"static":return t.anywhere();case"abstract":return t.anywhere()&&!(s.anywhere("virtual",n)||s.anywhere("override",n));case"virtual":return t.anywhere()&&!s.anywhere("override",n);case"override":return t.anywhere()&&!s.anywhere("sealed",n);case"sealed":return t.anywhere();case"private":return t.anywhere();case"protected":return t.anywhere();case"readonly":return t.anywhere();case"async":return t.anywhere()}}),c.members.type=(e=>{let t="type"===n.level,r="";if(!t){let t=n;for(;!0&&null!==t&&!(r=t.members[e]);)t=t.previous()}return r}),c.members.isProperty=(e=>{return"prop"===c.members.type(e)}),c.members.isFunction=(e=>{return"func"===c.members.type(e)}),c.members.isEvent=(e=>{return"event"===c.members.type(e)})),c},P=(n,r,i,a)=>{if(n.singleton&&i.isTopLevelInstance&&r._.singleInstance())return r._.singleInstance();let o={},u=null,c="_construct",l="_dispose",m={},d=null,y={name:n.params.typeName,type:n.types.type,Type:r,level:"object",members:{},attrs:{members:{}},modifiers:{members:{}},previous:()=>{return d}},g=null,h=!1,b=null,w="Use of 'state' is not support on server. Using 'session' instead.";const v={key:n=>{return e?!(!(!0).sessionStorage||!(!0).sessionStorage[n]):sessionStorage.key(n)},getItem:n=>{return e?(!0).sessionStorage&&(!0).sessionStorage[n]?(!0).sessionStorage[n]:null:sessionStorage.getItem(n)},setItem:(n,t)=>{e?((!0).sessionStorage||((!0).sessionStorage={}),(!0).sessionStorage[n]=t):sessionStorage.setItem(n,t)},removeItem:n=>{e?(!0).sessionStorage&&delete(!0).sessionStorage[n]:sessionStorage.removeItem(n)}},x={key:n=>{return e?(console.log(w),v.key(n)):localStorage.key(n)},getItem:n=>{return e?(console.log(w),v.getItem(n)):localStorage.getItem(n)},setItem:(n,t)=>{return e?(console.log(w),v.setItem(n,t)):void localStorage.setItem(n,t)},removeItem:n=>{return e?(console.log(w),v.removeItem(n)):void localStorage.removeItem(n)}},A=(e,n,t,r)=>{for(let i of q.members.all(n).current())if(i.isCustom){if("prop"===t){let s=i.attr.decorate(n,t,r.get,r.set);if(!s.get||!s.set)throw new k("Unexpected",`${i.name} decoration result is unexpected. (${n})`);s.get=s.get.bind(e),s.set=s.set.bind(e),r=s}else{let s=i.attr.decorate(n,t,r);if(!s)throw new k("Unexpected",`${i.name} decoration result is unexpected. (${n})`);r=s.bind(e)}i.attr=null}return r},I=(e,n)=>{let t=null,r=[];return r=f.get(y.name,e,q.members.all(e).anywhere()),y.aspects.members[e]=r,r.length>0&&(t=f.attach(n,y.name,e,r),t&&(n=t)),n},j=()=>{let e=!1,t=e=>{Object.defineProperty(o,e,Object.getOwnPropertyDescriptor(a,e))},r=Object.getOwnPropertyDescriptor(o,"_");r.enumerable=!1,Object.defineProperty(o,"_",r);for(let s in a)if(e=!1,a.hasOwnProperty(s)&&"_"!==s){if(e=!0,y.members[s]?(U.members.probe("private",s).current()&&(e=!1),e&&U.members.probe("protected",s).current()&&!i.isNeedProtected&&(e=!1)):U.members.probe("protected",s).anywhere()&&!i.isNeedProtected&&(e=!1),e&&t(s),e&&U.members.is("abstract",s))throw new k("InvalidDefinition",`Abstract member is not implemented. (${s})`);if(e){let e=q.members.probe("enumerate",s).current();if(e&&e.args[0]===!1){let e=Object.getOwnPropertyDescriptor(o,s);e.enumerable=!1,Object.defineProperty(o,s,e)}}e&&!i.isNeedProtected&&"function"==typeof a[s].subscribe&&o[s].strip(o)}i.isTopLevelInstance&&(o=J(o,n.ex.instance,!1)),i.isTopLevelInstance||(o._.def=y)},N=()=>{for(let e of y.interfaces){let n=new e;for(let t in n)if(n.hasOwnProperty(t)&&"_"!==t&&o[t]){let e=n._.modifiers.members.type(t);if(e!==y.members[t])throw new k("NotDefined",`Interface (${n._.name}) member is not defined as ${e}. (${t})`)}}delete y.interfaces},S=(e,t,r)=>{switch(["func","prop","event"].indexOf(t)!==-1&&e.startsWith("_")&&new k("InvalidName",`Name is not valid. (${e})`),t){case"func":if(!n.func)throw new k("InvalidOperation",`Function cannot be defined on this type. (${y.name})`);break;case"prop":if(!n.prop)throw new k("InvalidOperation",`Property cannot be defined on this type. (${y.name})`);break;case"event":if(!n.event)throw new k("InvalidOperation",`Event cannot be defined on this type. (${y.name})`);break;case"construct":if(!n.construct)throw new k("InvalidOperation",`Constructor cannot be defined on this type. (${y.name})`);t="func";break;case"dispose":if(!n.dispose)throw new k("InvalidOperation",`Dispose cannot be defined on this type. (${y.name})`);t="func"}return t},P=(e,r,i)=>{let o=!1,f=q.members.probe("conditional",e).current();if(f){let e=R(f.args[0]||[]);for(let n of e){if(n=n.toLowerCase(),"test"===n&&s.env.isTesting){o=!0;break}if("server"===n&&s.env.isServer){o=!0;break}if("client"===n&&s.env.isClient){o=!0;break}if("debug"===n&&s.env.isDebug){o=!0;break}if("prod"===n&&s.env.isProd){o=!0;break}if("cordova"===n&&s.env.isCordova){o=!0;break}if("nodewebkit"===n&&s.env.isNodeWebkit){o=!0;break}if(s.symbols.indexOf(n)!==-1){o=!0;break}}if(!o)return o}if(n.inheritance&&q.members.probe("abstract",e).current()&&(i!==t||null!==i)&&i.get&&i.get!==t)throw new k("InvalidDefinition",`Abstract member must point to noop function or a null value. (${e})`);if(n.static&&n.construct&&e===c&&0!==i.length)throw new k("InvalidDefinition",`Static constructors cannot have arguments. (construct)`);if(n.dispose&&e===l&&0!==i.length)throw new k("InvalidDefinition",`Destructor method cannot have arguments. (dispose)`);if(null===u&&"undefined"!=typeof a[e]&&!q.members.probe("mixed",e).current()&&(!n.inheritance||n.inheritance&&!q.members.probe("override",e).current()))throw new k("InvalidOperation",`Member with this name is already defined. (${e})`);if(n.inheritance&&q.members.probe("override",e).current()){if("undefined"==typeof a[e])throw new k("InvalidOperation",`Member not found to override. (${e})`);if(U.members.type(e)!==r)throw new k("InvalidOperation",`Overriding member type is invalid. (${e})`)}if(n.static&&q.members.probe("static",e).current())if("func"===r){if(z(i))throw new k("InvalidOperation",`Static functions cannot be defined as an arrow function. (${e})`)}else if("prop"===r&&i.get&&"function"==typeof i.get)throw new k("InvalidOperation",`Static properties cannot be defined with a custom getter/setter. (${e})`);if(n.storage&&q.members.probe("session",e).current()&&i.get&&"function"==typeof i.get)throw new k("InvalidOperation",`Session properties cannot be defined with a custom getter/setter. (${e})`);if(n.storage&&q.members.probe("state",e).current()){if(i.get&&"function"==typeof i.get)throw new k("InvalidOperation",`State properties cannot be defined with a custom getter/setter. (${e})`);if(!x)throw new k("NotConfigured","Port is not configured. (localStorage)")}return o},E=(e,r,s)=>{let o={get:null,set:null},u=t,c=t,f=q.members.probe("readonly",e).anywhere(),l=q.members.probe("static",e).anywhere(),p=q.members.probe("session",e).anywhere(),d=q.members.probe("state",e).anywhere(),g=q.members.probe("deprecate",e).current(),h=q.members.probe("inject",e).current(),b=q.members.probe("type",e).current(),w=null!==g,O=w?g.args[0]||`Event is marked as deprecate. (${e})`:"",T=m,j=a,N=y.name+"_"+e,S=!1,C=[];if(s.get||s.set)s.get&&"function"==typeof s.get&&(u=s.get),s.set&&"function"==typeof s.set&&(c=s.set),o.get=function(){return w&&console.log(O),u.apply(j)}.bind(j),o.set=function(n){if(w&&console.log(O),f&&!a._.constructing)throw new k("InvalidOperation",`Property is readonly. (${e})`);if(b&&b.args[0]&&!Z(n,b.args[0]))throw new k("InvalidArgument","Argument type is invalid. (value)");return c.apply(j,[n])}.bind(j);else{if(n.static&&l){if(T=i.staticInterface._.props,j=i.staticInterface,b&&b.args[0]&&!Z(s,b.args[0]))throw new k("InvalidArgument","Argument type is invalid. (value)");T[N]=s}else if(n.storage&&(p||d)){if(T=p?v:x,S=!0,N=a._.id+"_"+N,W(p?"session":"state",N),!T.key(N)){if(b&&b.args[0]&&!Z(s,b.args[0]))throw new k("InvalidArgument","Argument type is invalid. (value)");T.setItem(N,JSON.stringify({value:s}))}}else{if(b&&b.args[0]&&!Z(s,b.args[0]))throw new k("InvalidArgument","Argument type is invalid. (value)");T[N]=s;
}o.get=function(){return w&&console.log(O),S?JSON.parse(T.getItem(N)).value:T[N]}.bind(j),o.set=function(n){if(w&&console.log(O),f&&!l&&!a._.constructing)throw new k("InvalidOperation",`Property is readonly. (${e})`);if(b&&b.args[0]&&!Z(n,b.args[0]))throw new k("InvalidArgument","Argument type is invalid. (value)");S?T.setItem(N,JSON.stringify({value:n})):T[N]=n}.bind(j)}if(h&&!l&&!S){let e=h.args[0],n=h.args.length>0?h.args[1]:[],t=h.args.length>1&&h.args[2];C=_.resolve(e,n,t),Array.isArray(C)||(C=[C]),o.set(C)}return(q.members.probe("dispose",e).anywhere()||h)&&W("prop",e),n.customAttrs&&(o=A(j,e,r,o)),n.aop&&(o=I(e,o)),o},D=(e,t,r)=>{let s=null,o=a,u=n.inheritance&&q.members.probe("override",e).current(),c=n.static&&q.members.probe("static",e).current(),f=U.members.probe("async",e).current(),l=q.members.probe("deprecate",e).current(),p=q.members.probe("inject",e).current(),m=q.members.probe("args",e).current(),d=null!==l,y=d?l.args[0]||`Function is marked as deprecate. (${e})`:"",g=null,h=[];if(u?g=a[e].bind(o):c&&(o=i.staticInterface),p){let e=p.args[0],n=p.args.length>0?p.args[1]:[],t=p.args.length>1&&p.args[2];h=_.resolve(e,n,t),Array.isArray(h)||(h=[h])}return s=f?function(...e){return new Promise(function(n,t){d&&console.log(y);let i=[];if(g&&i.push(g),h.length>0&&i.push(h),i.push(n),i.push(t),m&&e.attr.args.length>0){let n=O(...e.attr.args)(...e);if(n.isInvalid)throw n.error;i.push(n)}else i.concat(e);return r.apply(o,i)}.bind(o))}.bind(o):function(...e){d&&console.log(y);let n=[];if(g&&n.push(g),h.length>0&&n.push(h),m&&e.attr.args.length>0){let t=O(...e.attr.args)(...e);if(t.isInvalid)throw t.error;n.push(t)}else n.concat(e);return r.apply(o,n)}.bind(o),n.customAttrs&&(s=A(o,e,t,s)),n.aop&&(s=I(e,s)),s},$=(e,t,r)=>{let i=null,s=null,o=null,u=null,c=n.inheritance&&q.members.probe("override",e).current(),f=q.members.probe("deprecate",e).current(),l=null!==f,p=l?f.args[0]||`Event is marked as deprecate. (${e})`:"",m=a;return b||(b=new T,W("event",b)),c&&(o=a[e]._.processor),i=function(...e){return l&&console.log(p),u=o?[o].concat(e):e,r.apply(m,u)}.bind(m),n.customAttrs&&(i=A(m,e,t,i)),n.aop&&(i=I(e,i)),s=i,i=function(...e){let n=e;"function"==typeof s&&(n=s(...e)),b.dispatch(name,n)}.bind(m),i._=Object.freeze({processor:s}),i.add=(e=>{b.add(name,e)}),i.remove=(e=>{b.remove(name,e)}),i.strip=(e=>{let n=Object.freeze(J({},i,!0,["strip"]));return delete i.strip,delete e.strip,n}),i},F=(e,t,r)=>{if(t=S(e,t,r),y.members[e]=t,y.attrs.members[e]=[],y.modifiers.members[e]=[],n.aop&&(y.aspects={members:{}}),n.mixins&&null!==u&&p("mixed",u),C(y,e),P(e,t,r)){let s=null,o=n.static&&q.members.probe("static",e).current(),u=o?i.staticInterface:a;switch(t){case"func":s=D(e,t,r),Object.defineProperty(u,e,{configurable:!0,enumerable:!0,value:s});break;case"prop":s=E(e,t,r),Object.defineProperty(u,e,{configurable:!0,enumerable:!0,get:s.get,set:s.set});break;case"event":s=$(e,t,r),Object.defineProperty(a,e,{configurable:!0,enumerable:!0,value:s})}y.members[e]=s}},W=(e,n)=>{a._.disposables.push({type:e,data:n})},U=M(!0,y),q=M(!1,y);if(n.inheritance){if(i.isTopLevelInstance&&U.type.has("abstract"))throw new k("InvalidOperation",`Cannot create instance of an abstract type. (${y.name})`);let e=r._.inherits;if(e){if(e._.isSealed()||e._.isSingleton()||e._.isStatic())throw new k("InvalidOperation",`Cannot inherit from a sealed, static or singleton type. (${e._.name})`);if(e._.type!==r._.type)throw new k("InvalidOperation",`Cannot inherit from another type family. (${e._.type})`);a=new e(i._flagName,i.staticInterface,i.args),d=a._.def,delete a._.def}}if("undefined"==typeof a._&&(a._=J({},n.mex.instance,!1),n.mixins&&(y.mixins=n.params.mixins),n.interfaces&&(y.interfaces=n.params.interfaces),n.dispose&&(a._.disposables=[])),a._.id=a._.id||L(),a._.type=n.types.instance,i.isTopLevelInstance&&(a._.Type=r,a._.isInstanceOf=(e=>{if(!e)throw new k("InvalidArgument","Argument type is invalid. (name)");return e._&&e._.name&&(e=e._.name),a._.Type._.name===e||r._.isDerivedFrom(e)}),n.mixins&&(a._.isMixed=(e=>{return a._.Type._.isMixed(e)})),n.interfaces&&(a._.isImplements=(e=>{return a._.Type._.isImplements(e)})),a._.modifiers=U,a._.attrs=q),h=!0,g=new Proxy({},{get:(e,n)=>{return a[n]},set:(e,n,t)=>{if(h){let e="";e="construct"===n?"construct":"dispose"===n?"dispose":"function"==typeof t?p.has("event")?"event":"func":"prop",F(n,e,t)}else{if("function"==typeof t)throw new k("InvalidOperation",`Redefinition of members is not allowed. (${n})`);a[n]=t}return!0}}),n.mixins){for(let e of y.mixins)u=e,e.apply(g),u=null;delete y.mixins}if(i.factory.apply(g),p.clear(),h=!1,i.isTopLevelInstance&&(n.construct&&"function"==typeof a[c]&&(a._.construct=a[c],delete a[c]),n.dispose&&"function"==typeof a[l])){let e=a[l];delete a[l],a._.dispose=(()=>{for(let n of a._.disposables)switch(n.type){case"session":v.removeItem(n.data);break;case"state":x.removeItem(n.data);break;case"prop":a[n.data]=null;break;case"event":a[n.data].clear()}"function"==typeof e&&e(),a._.disposables.length=0,a._.Type=null,a._.modifiers=null,a._.attrs=null,a._=null,m=null,d=null,y=null,g=null,b=null,o=null,a=null})}return j(),n.interfaces&&N(),n.construct&&i.isTopLevelInstance&&"function"==typeof o._[c]&&(o._.constructing=!0,o._[c](...i.args),delete o._.constructing),i.isTopLevelInstance&&n.singleton&&q.type.has("singleton")&&(r._.singleInstance=(()=>{return o}),r._.singleInstance.clear=(()=>{r._.singleInstance=(()=>{return null})})),i.isTopLevelInstance&&(o._=Object.freeze(o._),o=Object.seal(o)),o},E=e=>{e.mixins=e.mixins||!1,e.interfaces=e.interfaces||!1,e.inheritance=e.inheritance||!1,e.singleton=e.singleton||!1,e.static=e.static||!1,e.func=e.func||!1,e.construct=e.construct||!1,e.dispose=e.dispose||!1,e.prop=e.prop||!1,e.storage=e.storage||!1,e.event=e.event||!1,e.aop=e.aop||!1,e.customAttrs=e.customAttrs||!1,e.types.instance=e.types.instance||"unknown",e.types.type=e.types.type||"unknown",e.mex.instance=e.mex&&e.mex.instance?e.mex.instance:{},e.mex.type=e.mex&&e.mex.type?e.mex.type:{},e.ex.instance=e.ex&&e.ex.instance?e.ex.instance:{},e.ex.type=e.ex&&e.ex.type?e.ex.type:{},e.params.typeName=e.params.typeName||"unknown",e.params.inherits=e.params.inherits||null,e.params.mixins=[],e.params.interfaces=[],e.params.factory=e.params.factory||null,e.func||(e.construct=!1,e.dispose=!1),e.prop||(e.storage=!1),e.inheritance||(e.singleton=!1),e.func||e.prop||e.event||(e.aop=!1,e.customAttrs=!1);for(let n of e.params.mixinsAndInterfaces)if(n._&&n._.type)switch(n._.type){case"mixin":e.params.mixins.push(n);break;case"interface":e.params.interfaces.push(n)}delete e.params.mixinsAndInterfaces;let r={};e.ex.instance=J(e.ex.instance,r,!1);let i="___flag___",s=function(n,t,...r){let a={_flagName:i};"undefined"!=typeof n&&n===i?(a.isNeedProtected=!0,a.isTopLevelInstance=!1,a.staticInterface=t,a.args=r):(a.isNeedProtected=!1,a.isTopLevelInstance=!0,a.staticInterface=s,"undefined"!=typeof n?"undefined"!=typeof t?a.args=[n,t].concat(r):a.args=[n]:a.args=[]);let o={};return P(e,s,a,o)};s=J(s,e.ex.type,!1);let a={name:e.params.typeName,type:e.types.type,Type:s,level:"type",members:{},attrs:{type:[]},modifiers:{type:[]},previous:()=>{return s._.inherits?s._.inherits._.def():null}};const o=M(!0,a),u=M(!1,a);if(C(a,e.params.typeName),s._=J({},e.mex.type,!0),s._.name=e.params.typeName,s._.type=e.types.type,s._.id=L(),s._.namespace=null,s._.assembly=(()=>{return b.get(s._.name)||null}),s._.inherits=null,e.inheritance&&(s._.inherits=e.params.inherits||null,s._.isAbstract=(()=>{return o.type.has("abstract")}),s._.isSealed=(()=>{return o.type.has("sealed")}),s._.isDerivedFrom=(n=>{if("string"!=typeof n)throw new k("InvalidArgument","Argument type is invalid. (name)");n._&&n._.name&&(n=n._.name);let t=!1,r=e.params.inherits;if(!t)for(;!0&&null!==r;){if(r._.name===n){t=!0;break}r=r._.inherits}return t}),s._.inherits)){let e=s._.inherits._.isDeprecated();e&&console.log(e)}return e.static&&(s._.isStatic=(()=>{return o.type.has("static")}),s._.props={}),e.singleton&&(s._.isSingleton=(()=>{return u.type.has("singleton")}),s._.singleInstance=(()=>{return null}),s._.singleInstance.clear=t),e.mixins&&(s._.mixins=e.params.mixins,s._.isMixed=(e=>{if("string"!=typeof e)throw new k("InvalidArgument","Argument type is invalid. (name)");e._&&e._.name&&(e=e._.name);let n=!1,t=s;for(;!0&&null!==t&&!(n=F(t._.mixins,"name",e)!==-1);)t=t._.inherits;return n})),e.interfaces&&(s._.interfaces=e.params.interfaces,s._.isImplements=(e=>{if("string"!=typeof e)throw new k("InvalidArgument","Argument type is invalid. (name)");e._&&e._.name&&(e=e._.name);let n=!1,t=s;for(;!0&&null!==t&&!(n=F(t._.interfaces,"name",e)!==-1);)t=t._.inherits;return n})),s._.isDeprecated=(()=>{let e=u.type.get("deprecate");return!!e&&(e.args[0]||`Type is marked as deprecated. (${s._.name})`)}),s._.def=(()=>{return a}),s._.modifiers=o,s._.attrs=u,w(s),s._=Object.freeze(s._),s._.isStatic()?new s:Object.freeze(s)},L=()=>{return"_xxxxxxxx_xxxx_4xxx_yxxx_xxxxxxxxxxxx".replace(/[xy]/g,e=>{var n=16*Math.random()|0,t="x"==e?n:3&n|8;return t.toString(16)})},D=(e,n)=>{if(n){if(e.indexOf("{.min}")!==-1)return r.options.env.isProd?e.replace("{.min}",".min"):e.replace("{.min}","")}else if(e.indexOf("|")!==-1){let n=e.split("|"),t="";return t=r.options.env.isServer?n[0].trim():n[1].trim(),"x"===t&&(t=""),t}return e},z=e=>{return!e.hasOwnProperty("prototype")},$=(e,n,t)=>{return e.findIndex(e=>{return e[n]===t})},F=(e,n,t)=>{let r=e.findIndex(e=>{return e[n]===t});return r!==-1?e[r]:null},R=e=>{return e.split(",").map(e=>{return e.trim()})},W=e=>{return e.replace(/([.*+?\^=!:${}()|\[\]\/\\])/g,"\\$1")},U=(e,n,t)=>{return e.replace(new RegExp(W(n),"g"),t)},J=(e,n,t,r)=>{r||(r=[]);for(let i in n)if(n.hasOwnProperty(i)&&r.indexOf(i)===-1){if(!t&&i in e)continue;e[i]=n[i]}return e},q=n=>{return new Promise((t,r)=>{let i=n.substr(n.lastIndexOf(".")+1).toLowerCase();if(e)try{let e=null,s="";e=n.startsWith("https")?require("https"):require("http"),e.get(n,e=>{e.on("data",e=>{s+=e}),e.on("end",()=>{t("json"===i?JSON.parse(s):s)})}).on("error",r)}catch(e){r(e)}else fetch(n).then(e=>{200!==e.status?r(e.status):"json"===i?e.json().then(t).catch(r):t(e.text())}).catch(r)})},B=n=>{return new Promise((t,i)=>{if(e)try{t(require(n))}catch(e){i(e)}else{let e=n.substr(n.lastIndexOf(".")+1).toLowerCase();try{if("undefined"!=typeof require)require([n],t,i);else{let s=r.options.env.global.document.createElement("script");"mjs"===e?s.type="module":s.type="text/javascript",s.name=n,s.src=n,s.onload=t,s.onerror=i,r.options.env.global.document.head.appendChild(s)}}catch(e){i(e)}}})},V=(e,n,t,r)=>{let i=R(n);const s=n=>{let s={};if(i.length>0)for(let a of i)s[a]=n[a];else for(let a in e)e.hasOwnProperty(a)&&(s[a]=e[a]);if(r)for(let a in r)s[a]=r[a];return t&&(s=Object.freeze(s)),s};if(Array.isArray(e)){let n=[];for(let t of e)n.push(s(t));return n}return s(e)};r.Class=((e,n,t,r)=>{if("string"!=typeof e)throw new k("InvalidArgument","Argument type is invalid. (name)");switch(Q(n)){case"function":r=n,n=null,t=[];break;case"array":if("function"!=typeof t)throw new k("InvalidArgument","Argument type is invalid. (factory)");r=t,t=n,n=null;break;case"class":if(["array","function"].indexOf(Q(t))===-1)throw new k("InvalidArgument","Argument type is invalid. (factory)");if("function"==typeof t)r=t,t=[];else if("function"!=typeof r)throw new k("InvalidArgument","Argument type is invalid. (factory)");break;default:throw new k("InvalidArgument","Argument type is invalid. (factory)")}let i={mixins:!0,interfaces:!0,inheritance:!0,singleton:!0,static:!0,func:!0,construct:!0,dispose:!0,prop:!0,event:!0,storage:!0,aop:!0,customAttrs:!0,types:{instance:"instance",type:"class"},params:{typeName:e,inherits:n,mixinsAndInterfaces:t,factory:r},mex:{instance:{},type:{}},ex:{instance:{},type:{}}};return E(i)}),r.members.push("Class");const G=e=>{return e._&&e._.Type||null};r.getTypeOf=G,r.members.push("getTypeOf");const H=(e,n)=>{if("class"!==Q(e))throw new k("InvalidArgument","Argument type is invalid. (type)");if(["string","class"].indexOf(Q(n))===-1)throw new k("InvalidArgument","Argument type is invalid. (parent)");return e._.isDerivedFrom(n)};r.isDerivedFrom=H,r.members.push("isDerivedFrom");const K=(e,n)=>{let t=Q(e),r=Q(n),i=!1;if(["instance","sinstance"].indexOf(t)===-1)throw new k("InvalidArgument","Argument type is invalid. (obj)");if(["string","class","interface","struct","mixin"].indexOf(r)===-1)throw new k("InvalidArgument","Argument type is invalid. (type)");switch(r){case"class":case"struct":i=e._.isInstanceOf(n);break;case"interface":i=e._.isImplements(n);break;case"mixin":i=e._.isMixed(n);break;case"string":i=e._.isInstanceOf(n),i||"function"!=typeof e._.isImplements||(i=e._.isImplements(n)),i||"function"!=typeof e._.isMixed||(i=e._.isMixed(n))}return i};r.isInstanceOf=K,r.members.push("isInstanceOf");const X=(e,n,t)=>{if("string"!=typeof e)throw k.InvalidArgument("name");if("array"===Q(n)){if("function"!=typeof t)throw k.InvalidArgument("factory")}else{if("function"!=typeof n)throw k.InvalidArgument("factory");t=n,n=[]}let r={mixins:!0,interfaces:!0,static:!0,func:!0,construct:!0,prop:!0,event:!0,customAttrs:!0,types:{instance:"sinstance",type:"struct"},params:{typeName:e,inherits:null,mixinsAndInterfaces:n,factory:t}};return E(r)};r.Struct=Object.freeze(X),r.members.push("Struct");const Q=e=>{let n="";return"undefined"==typeof e&&(n="undefined"),n||null!==e||(n="null"),!n&&Array.isArray(e)&&(n="array"),!n&&e instanceof Date&&(n="date"),!n&&e._&&e._.type&&(n=e._.type),n||(n=typeof e),n};r.typeOf=Q,r.members.push("typeOf"),r.Types=(e=>{if("string"!==Q(e))throw new k("InvalidArgument","Argument type is invalid. (name)");return r.Namespace.getType(e)}),r.members.push("Types");const Y=(e,n)=>{return Z(e,n)?e:null};r.as=Y,r.members.push("as"),r.Interface=((e,n)=>{let t={},i={};const s=e=>{return["constructor","dispose","_constructor","_dispose","_"].indexOf(e)!==-1};return i.func=(n=>{if("undefined"!=typeof t[n])throw`${e}.${n} is already defined.`;if(s(n))throw`${e}.${n} can only be defined for a class.`;t[n]=[],t[n].type="func"}),i.prop=(n=>{if("undefined"!=typeof t[n])throw`${e}.${n} is already defined.`;if(s(n))throw`${e}.${n} can only be defined as a function for a class.`;t[n]=[],t[n].type="prop"}),i.event=(n=>{if("undefined"!=typeof t[n])throw`${e}.${n} is already defined.`;if(s(n))throw`${e}.${n} can only be defined as a function for a class.`;t[n]=[],t[n].type="event"}),t._={name:e,type:"interface",namespace:null},r.Namespace(t),n.apply(i),delete i.func,delete i.prop,delete i.event,t}),r.members.push("Interface");const Z=(e,n)=>{if("string"!==Q(n))throw new k("InvalidArgument","Argument type is invalid. (type)");let t=!1,r="";return e&&("array"!==n&&"Array"!==n||(t=Array.isArray(e)),t||"date"!==n&&"Date"!==n||(t=e instanceof Date),!t&&"flair"===n&&e._&&e._.type&&(t=!0),t||(t=typeof e===n),t||e._&&e._.type&&(r=e._.type,t=r===n),!t&&r&&["instance","sinstance"].indexOf(r)!==-1&&(t=K(e,n))),t};r.is=Z,r.members.push("is");const ee=(e,n)=>{if(!e)throw new k("InvalidArgument","Argument type is invalid. (obj)");if("interface"!==Q(n))throw new k("InvalidArgument","Argument type is invalid. (intf)");let t=!0;for(let r in n)if(n.hasOwnProperty(r)&&"_"!==r&&typeof e[r]!=typeof n[r]){t=!1;break}return t};r.isComplies=ee,r.members.push("isComplies");const ne=(e,n)=>{if(["instance","class","sinstance","struct"].indexOf(Q(e))===-1)throw new k("InvalidArgument","Argument type is invalid. (obj)");if(["string","interface"].indexOf(Q(n))===-1)throw new k("InvalidArgument","Argument type is invalid. (intf)");return e._.isImplements(n)};r.isImplements=ne,r.members.push("isImplements");const te=(e,n)=>{if("string"!=typeof e)throw k.InvalidArgument("name");if("function"!=typeof n)throw k.InvalidArgument("factory");let t={prop:!0,types:{instance:"einstance",type:"enum"},params:{typeName:e,inherits:null,mixinsAndInterfaces:null,factory:n}};return E(t)};r.Enum=Object.freeze(te),r.members.push("Enum"),r.noop=Object.freeze(t),r.members.push("noop");let re=t,ie=[],se=500;const ae={on:(e,...n)=>{re===t&&("string"==typeof e?n.unshift(e):"function"==typeof e&&S("telemetry",e),re=((e,t)=>{if(0===n.length||n.indexOf(e)!==-1){let n=Object.freeze({type:e,data:t});ie.push(n),ie.length>se-25&&ie.splice(0,25),N("telemetry",n)}}))},collect:()=>{if(re!==t){let e=ie.slice();return ie.length=0,e}return[]},off:e=>{return re!==t?("function"==typeof e&&S("telemetry",e,!0),re=t,ae.collect()):[]},isOn:()=>{return re!==t},types:Object.freeze({RAW:"raw",EXEC:"exec",INFO:"info",INCL:"incl"})};r.telemetry=Object.freeze(ae),r.members.push("telemetry");const oe=(e,n)=>{if(["instance","class","sinstance","struct"].indexOf(Q(e))===-1)throw new k("InvalidArgument","Argument type is invalid. (obj)");if(["string","mixin"].indexOf(Q(n))===-1)throw new k("InvalidArgument","Argument type is invalid. (mixin)");return e._.isMixed(n)};r.isMixed=oe,r.members.push("isMixed"),r.Mixin=((e,n)=>{return n._={name:e,type:"mixin",namespace:null},r.Namespace(n),n}),r.members.push("Mixin"),r.Reflector=function(e){const n=function(e){this.getType=(()=>{return e._.type}),this.getName=(()=>{return e._.name||""}),this.getNamespace=(()=>{let n=e._.namespace;return n?new h(n):null}),this.getAssembly=(()=>{let n=r.Assembly.get(e._.name);return n?new b(n):null}),this.getTarget=(()=>{return e}),this.isInstance=(()=>{return"instance"===e._.type}),this.isClass=(()=>{return"class"===e._.type}),this.isEnum=(()=>{return"enum"===e._.type}),this.isStruct=(()=>{return"struct"===e._.type}),this.isStructInstance=(()=>{return"sinstance"===e._.type}),this.isNamespace=(()=>{return"namespace"===e._.type}),this.isResource=(()=>{return"resource"===e._.type}),this.isAssembly=(()=>{return"assembly"===e._.type}),this.isMixin=(()=>{return"mixin"===e._.type}),this.isInterface=(()=>{return"interface"===e._.type})},t=function(e,n,t){this.getType=(()=>{return"member"}),this.getMemberType=(()=>{return e}),this.getTarget=(()=>{return n}),this.getTargetType=(()=>{return n._.type}),this.getName=(()=>{return t})},i=function(e,n,t,r){this.getType=(()=>{return"attribute"}),this.getName=(()=>{return n}),this.getTarget=(()=>{return r}),this.getArgs=(()=>{return t.slice()}),this.getClass=(()=>{return e?new m(e):null})},s=function(e,n){this.getType=(()=>{return"aspect"}),this.getName=(()=>{return e._.name}),this.getTarget=(()=>{return n}),this.getClass=(()=>{return e?new m(e):null})},a=function(e,n,r,s){let a=new t(e,n,r);return a.getRef=(()=>{return s}),a.getAttributes=(()=>{let e=[],t=[];for(let s of n._.instanceOf)if(s.meta[r]){t=s.meta[r];for(let a of t)e.push(new i(a.Attr,a.name,a.args,n))}return e}),a.hasAttribute=(e=>{let t=!1,i=[];for(let s of n._.instanceOf){if(s.meta[r]){i=s.meta[r];for(let n of i)if(n.name==e){t=!0;break}}if(t)break}return t}),a.getAttribute=(e=>{let t=null;for(let s of n._.instanceOf){if(s.meta[r]){let a=s.meta[r];for(let o of a)if(o.name===e){t=new i(o.Attr,o.name,o.args,n);break}}if(null!==t)break}return t}),a.isEnumerable=(()=>{return!!n[r]&&Object.getOwnPropertyDescriptor(n,r).enumerable}),a.isDeprecated=(()=>{return n._._.hasAttrEx("deprecate",r)}),a.isConditional=(()=>{return n._._.hasAttrEx("conditional",r)}),a.isOverridden=(()=>{return n._._.hasAttrEx("override",r)}),a.isOwn=(()=>{return n._.isOwnMember(r)}),a.isDerived=(()=>{return n._._.isDerivedMember(r)}),a.isPrivate=(()=>{return n._._.hasAttrEx("private",r)}),a.isProtected=(()=>{return n._._.isProtectedMember(r)}),a.isPublic=(()=>{return!a.isPrivate&&!a.isProtected}),a.isSealed=(()=>{return n._._.isSealedMember(r)}),a.isMixed=(()=>{return n._._.hasAttrEx("mixed",r)}),a.getMixin=(()=>{if(a.isMixed()){let e=a.getAttribute("mixed").getArgs()[0];return new w(e)}return null}),a.isInterfaceEnforced=(()=>{return a.getInterfaces().length>0}),a.getInterfaces=(()=>{let e=[],t=[];for(let i of n._.instanceOf)if(i.meta[r]){t=i.meta[r].interfaces;for(let s of t)e.push(new v(s,n))}return e}),a.isProp=(()=>{return"prop"===e}),a.isFunc=(()=>{return"func"===e}),a.isEvent=(()=>{return"event"===e}),a},o=function(e,n,t){let r=new a("prop",e,n,t);return r.getValue=(()=>{return e[n]}),r.setValue=(t=>{return e[n]=t}),r.getRaw=(()=>{return t}),r.isReadOnly=(()=>{return e._._.hasAttrEx("readonly",n)}),r.isSetOnce=(()=>{return e._._.hasAttrEx("readonly",n)&&e._._.hasAttrEx("once",n)}),r.isStatic=(()=>{return e._._.hasAttrEx("static",n)}),r.isSerializable=(()=>{return e._._.isSerializableMember(n)}),r},u=function(e,n,t,r){let i=new a("func",e,n,t);return i.invoke=((...t)=>{return e[n](...t)}),i.getAspects=(()=>{let t=[],r=[];for(let i of e._.instanceOf)if(i.meta[n]){r=i.meta[n].aspects;for(let a of r)t.push(new s(a,e))}return t}),i.getRaw=(()=>{return r}),i.isASync=(()=>{return e._._.hasAttrEx("async",n)}),i.isConstructor=(()=>{return"_constructor"===n}),i.isDisposer=(()=>{return"_dispose"===n}),i},c=function(e,n,t){let r=new a("event",e,n,t);return r.raise=((...e)=>{return t(...e)}),r.isSubscribed=(()=>{return t.subscribe.all().length>0}),r},f=function(e,n){let r=new t("key",e,n);return r.getValue=(()=>{return e[n]}),r},l=function(e){let t=new n(e),r=(e,n,t)=>{if(""===n&&0===t.length)return e.slice();let r=[],i=!0;for(let s of e)if("member"===s.getType()&&(""===n||s.getMemberType()===n)){if(i=!0,0!==t.length)for(let e of t)if(!s.hasAttribute(e)){i=!1;break}i&&r.push(s)}return r},i=n=>{let t=[],i=[],s=null,a=null;for(let f of e._.instanceOf){for(let r in f.meta){if(f.meta.hasOwnProperty(r)){switch(i=f.meta[r],f.meta[r].type){case"func":s=new u(e,r,f.meta[r].ref,f.meta[r].raw),t.push(s);break;case"prop":s=new o(e,r,f.meta[r].ref),t.push(s);break;case"event":s=new c(e,r,f.meta[r].argNames,f.meta[r].ref),t.push(s);break;default:throw"Unknown member type"}"undefined"!=typeof n&&r===n&&(t=[],a=s)}if(null!==a)break}if(null!==a)break}return null!==a?a:{all:(...e)=>{return r(t,"",e)},func:(...e)=>{return r(t,"func",e)},prop:(...e)=>{return r(t,"prop",e)},event:(...e)=>{return r(t,"event",e)}}};return t.getClass=(()=>{return null!==e._.inherits?new m(e._.inherits):null}),t.getFamily=(()=>{let n=[],t=e._.inherits;for(;!0&&null!==t;)n.push(new m(t)),t=t._.inherits;return n}),t.getMixins=(()=>{let e=[],n=t.getFamily();for(let r of n)e=e.concat(r.getMixins());return e}),t.getInterfaces=(()=>{let e=[],n=t.getFamily();for(let r of n)e=e.concat(r.getInterfaces());return e}),t.getMembers=((...e)=>{let n=i();return 0!==e.length?n.all(...e):n}),t.getMember=(e=>{return i(e)}),t.isSingleton=(()=>{return t.getClass().isSingleton()}),t.isInstanceOf=(n=>{return e._.isInstanceOf(n)}),t.isMixed=(n=>{return e._.isMixed(n)}),t.isImplements=(n=>{return e._.isImplements(n)}),t},p=function(e){let t=new n(e);return t.getStruct=(()=>{return null!==e._.inherits?new g(e._.inherits):null}),t.getMembers=(()=>{let n=Object.keys(e),t=n.indexOf("_");return t!==-1&&n.splice(t,1),n}),t.getMember=(n=>{return e[n]}),t.invoke=((...n)=>{return e[name](...n)}),t.isInstanceOf=(n=>{return e._.inherits._.name===n}),t},m=function(e){let t=new n(e);return t.getParent=(()=>{return null!==e._.inherits?new m(e._.inherits):null}),t.getFamily=(()=>{let n=[],t=e._.inherits;for(;!0&&null!==t;)n.push(new m(t)),t=t._.inherits;return n}),t.getMixins=(()=>{let n=[];for(let t of e._.mixins)n.push(new w(t));return n}),t.getInterfaces=(()=>{let n=[];for(let t of e._.interfaces)n.push(new v(t));return n}),t.isSingleton=(()=>{return e._.isSingleton()}),t.isSingleInstanceCreated=(()=>{return null!==e._.singleInstance()}),t.isSealed=(()=>{return e._.isSealed()}),t.isDerivedFrom=(n=>{return e._.isDerivedFrom(n)}),t.isMixed=(n=>{return e._.isMixed(n)}),t.isImplements=(n=>{return e._.isImplements(n)}),t},d=function(e){let t=new n(e);return t.getMembers=(()=>{let n=e._.keys(),t=[];for(let r of n)t.push(new f(e,r));return t}),t.getMember=(n=>{if("undefined"==typeof e[n])throw`${n} is not defined.`;return new f(e,n)}),t.getKeys=(()=>{return e._.keys()}),t.getValues=(()=>{return e._.values()}),t},y=function(e){let t=new n(e);return t.getFile=(()=>{return e.file()}),t.getResType=(()=>{return e.type()}),t.getContent=(()=>{return e.get()}),t},g=function(e){let t=new n(e);return t},h=function(e){let t=new n(e);return t.getMembers=(()=>{let n=e.getTypes(),t=[];if(n)for(let r of n)switch(r._.type){case"class":t.push(new m(r));break;case"enum":t.push(new d(r));break;case"struct":t.push(new g(r));break;case"mixin":t.push(new w(r));break;case"interface":t.push(new v(r))}return t}),t.getMember=(n=>{let t=e.getType(n),r=null;if(t)switch(t._.type){case"class":r=new m(t);break;case"enum":r=new d(t);break;case"struct":r=new g(t);break;case"mixin":r=new w(t);break;case"interface":r=new v(t)}return r}),t.createInstance=((n,...t)=>{return e.createInstance(n,...t)}),t},b=function(e){let t=new n(e);return t.getTypes=(()=>{return e.types}),t.getAssets=(()=>{return e.assets}),t.getADO=(()=>{return e._.ado}),t.load=(()=>{return e.load()}),t},w=function(e){let t=new n(e);return t},v=function(e){let r=new n(e),i=()=>{let n=[];for(let r in e)e.hasOwnProperty(r)&&"_"!==r&&n.push(new t(e[r].type,e,r));return n};return r.getMembers=(()=>{return i()}),r.getMember=(n=>{if("undefined"==typeof e[n])throw`${n} is not defined.`;return new t(e[n].type,e,n)}),r};let _=null;switch(e._.type){case"instance":_=new l(e);break;case"sinstance":_=new p(e);break;case"class":_=new m(e);break;case"enum":_=new d(e);break;case"resource":_=new y(e);break;case"struct":_=new g(e);break;case"namespace":_=new h(e);break;case"assembly":_=new b(e);break;case"mixin":_=new w(e);break;case"interface":_=new v(e);break;default:throw`Unknown type ${e._.type}.`}return _},r.members.push("Reflector");const ue=(e,n)=>{let t=null,r=null,i=n?JSON.parse(e):e,s=n?null:e._.Type;const a=(e,n)=>{let t=e._.attrs,r=e._.modifiers,i=[],s=!1;for(let a in e)e.hasOwnProperty(a)&&"_"!==a&&(s=r.members.isProperty(a),s&&(s=n?!t.members.probe("noserialize",a).anywhere():t.members.probe("serialize",a).anywhere(),s&&(s=!(r.members.is("private",a)||r.members.is("protected",a)||r.members.is("static",a)||r.members.is("readonly",a)||t.members.probe("inject",a).anywhere()))),s&&i.push(a));return i};if(n){if(!i.type&&!i.data)throw k.InvalidArgument("json");if(s=w.getType(i.type),!s)throw new k("NotRegistered",`Type is not registered. (${i.type})`);t=new s,r=s._.attrs.type.has("serialize",!0)?a(t,!0):a(t,!1);for(let e of r)t[e]=i.data[e]}else{r=s._.attrs.type.has("serialize",!0)?a(i,!0):a(i,!1),t={type:i._.Type._.name,data:{}};for(let e of r)t.data[e]=i[e];t=JSON.stringify(t)}return t},ce={serialize:e=>{if(!(e&&e._&&e._.type)||["instance","sinstance"].indexOf(e._.type)===-1)throw k.InvalidArgument("instance");return ue(e)},deserialize:e=>{if(!e||"string"!=typeof e)throw k.InvalidArgument("json");return ue(e,!0)}};return r.Serializer=Object.freeze(ce),r.members.push("Serializer"),r.members=Object.freeze(r.members),Object.freeze(r)});