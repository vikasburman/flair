/**
 * @preserve
 * Flair.js
 * True Object Oriented JavaScript
 * 
 * Assembly: flair.app
 *     File: ./flair.app.js
 *  Version: 0.26.2
 *  Sun, 24 Mar 2019 19:29:33 GMT
 * 
 * (c) 2017-2019 Vikas Burman
 * Licensed under MIT
 */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.page=e()}(this,function(){"use strict";var t=Array.isArray||function(t){return"[object Array]"==Object.prototype.toString.call(t)},e=y,n=a,i=c,r=p,o=g,s=new RegExp(["(\\\\.)","([\\/.])?(?:(?:\\:(\\w+)(?:\\(((?:\\\\.|[^()])+)\\))?|\\(((?:\\\\.|[^()])+)\\))([+*?])?|(\\*))"].join("|"),"g");function a(t){for(var e=[],n=0,i=0,r="",o;null!=(o=s.exec(t));){var a=o[0],c=o[1],p=o.index;if(r+=t.slice(i,p),i=p+a.length,c)r+=c[1];else{r&&(e.push(r),r="");var h=o[2],u=o[3],f=o[4],d=o[5],v=o[6],m=o[7],g="+"===v||"*"===v,y="?"===v||"*"===v,w=h||"/",b=f||d||(m?".*":"[^"+w+"]+?");e.push({name:u||n++,prefix:h||"",delimiter:w,optional:y,repeat:g,pattern:l(b)})}}return i<t.length&&(r+=t.substr(i)),r&&e.push(r),e}function c(t){return p(a(t))}function p(e){for(var n=new Array(e.length),i=0;i<e.length;i++)"object"==typeof e[i]&&(n[i]=new RegExp("^"+e[i].pattern+"$"));return function(i){for(var r="",o=i||{},s=0;s<e.length;s++){var a=e[s];if("string"!=typeof a){var c=o[a.name],p;if(null==c){if(a.optional)continue;throw new TypeError('Expected "'+a.name+'" to be defined')}if(t(c)){if(!a.repeat)throw new TypeError('Expected "'+a.name+'" to not repeat, but received "'+c+'"');if(0===c.length){if(a.optional)continue;throw new TypeError('Expected "'+a.name+'" to not be empty')}for(var h=0;h<c.length;h++){if(p=encodeURIComponent(c[h]),!n[s].test(p))throw new TypeError('Expected all "'+a.name+'" to match "'+a.pattern+'", but received "'+p+'"');r+=(0===h?a.prefix:a.delimiter)+p}}else{if(p=encodeURIComponent(c),!n[s].test(p))throw new TypeError('Expected "'+a.name+'" to match "'+a.pattern+'", but received "'+p+'"');r+=a.prefix+p}}else r+=a}return r}}function h(t){return t.replace(/([.+*?=^!:${}()[\]|\/])/g,"\\$1")}function l(t){return t.replace(/([=!:$\/()])/g,"\\$1")}function u(t,e){return t.keys=e,t}function f(t){return t.sensitive?"":"i"}function d(t,e){var n=t.source.match(/\((?!\?)/g);if(n)for(var i=0;i<n.length;i++)e.push({name:i,prefix:null,delimiter:null,optional:!1,repeat:!1,pattern:null});return u(t,e)}function v(t,e,n){for(var i=[],r=0;r<t.length;r++)i.push(y(t[r],e,n).source);var o;return u(new RegExp("(?:"+i.join("|")+")",f(n)),e)}function m(t,e,n){for(var i=a(t),r=g(i,n),o=0;o<i.length;o++)"string"!=typeof i[o]&&e.push(i[o]);return u(r,e)}function g(t,e){for(var n=(e=e||{}).strict,i=!1!==e.end,r="",o=t[t.length-1],s="string"==typeof o&&/\/$/.test(o),a=0;a<t.length;a++){var c=t[a];if("string"==typeof c)r+=h(c);else{var p=h(c.prefix),l=c.pattern;c.repeat&&(l+="(?:"+p+l+")*"),r+=l=c.optional?p?"(?:"+p+"("+l+"))?":"("+l+")?":p+"("+l+")"}}return n||(r=(s?r.slice(0,-2):r)+"(?:\\/(?=$))?"),r+=i?"$":n&&s?"":"(?=\\/|$)",new RegExp("^"+r,f(e))}function y(e,n,i){return t(n=n||[])?i||(i={}):(i=n,n=[]),e instanceof RegExp?d(e,n,i):t(e)?v(e,n,i):m(e,n,i)}e.parse=n,e.compile=i,e.tokensToFunction=r,e.tokensToRegExp=o;var w="undefined"!=typeof document,b=void 0!==!0,_="undefined"!=typeof history,x="undefined"!=typeof process,$=w&&document.ontouchstart?"touchstart":"click",E=b&&!(!(!0).history.location&&!(!0).location),k;function R(){this.callbacks=[],this.exits=[],this.current="",this.len=0,this._decodeURLComponents=!0,this._base="",this._strict=!1,this._running=!1,this._hashbang=!1,this.clickHandler=this.clickHandler.bind(this),this._onpopstate=this._onpopstate.bind(this)}function S(){var t=new R;function e(){return O.apply(t,arguments)}return e.callbacks=t.callbacks,e.exits=t.exits,e.base=t.base.bind(t),e.strict=t.strict.bind(t),e.start=t.start.bind(t),e.stop=t.stop.bind(t),e.show=t.show.bind(t),e.back=t.back.bind(t),e.redirect=t.redirect.bind(t),e.replace=t.replace.bind(t),e.dispatch=t.dispatch.bind(t),e.exit=t.exit.bind(t),e.configure=t.configure.bind(t),e.sameOrigin=t.sameOrigin.bind(t),e.clickHandler=t.clickHandler.bind(t),e.create=S,Object.defineProperty(e,"len",{get:function(){return t.len},set:function(e){t.len=e}}),Object.defineProperty(e,"current",{get:function(){return t.current},set:function(e){t.current=e}}),e.Context=L,e.Route=U,e}function O(t,e){if("function"==typeof t)return O.call(this,"*",t);if("function"==typeof e)for(var n=new U(t,null,this),i=1;i<arguments.length;++i)this.callbacks.push(n.middleware(arguments[i]));else"string"==typeof t?this["string"==typeof e?"redirect":"show"](t,e):this.start(t)}function C(t){if(!t.handled){var e,n=this,i=this._window;(e=this._hashbang?E&&this._getBase()+i.location.hash.replace("#!",""):E&&i.location.pathname+i.location.search)!==t.canonicalPath&&(this.stop(),t.handled=!1,E&&(i.location.href=t.canonicalPath))}}function A(t){return t.replace(/([.+*?=^!:${}()[\]|/\\])/g,"\\$1")}function L(t,e,n){var i=this.page=n||O,r=i._window,o=i._hashbang,s=i._getBase();"/"===t[0]&&0!==t.indexOf(s)&&(t=s+(o?"#!":"")+t);var a=t.indexOf("?");this.canonicalPath=t;var c=new RegExp("^"+A(s));if(this.path=t.replace(c,"")||"/",o&&(this.path=this.path.replace("#!","")||"/"),this.title=w&&r.document.title,this.state=e||{},this.state.path=t,this.querystring=~a?i._decodeURLEncodedURIComponent(t.slice(a+1)):"",this.pathname=i._decodeURLEncodedURIComponent(~a?t.slice(0,a):t),this.params={},this.hash="",!o){if(!~this.path.indexOf("#"))return;var p=this.path.split("#");this.path=this.pathname=p[0],this.hash=i._decodeURLEncodedURIComponent(p[1])||"",this.querystring=this.querystring.split("#")[0]}}function U(t,n,i){var r=this.page=i||j,o=n||{};o.strict=o.strict||i._strict,this.path="*"===t?"(.*)":t,this.method="GET",this.regexp=e(this.path,this.keys=[],o)}R.prototype.configure=function(t){var e=t||{};this._window=e.window||b&&!0,this._decodeURLComponents=!1!==e.decodeURLComponents,this._popstate=!1!==e.popstate&&b,this._click=!1!==e.click&&w,this._hashbang=!!e.hashbang;var n=this._window;this._popstate?n.addEventListener("popstate",this._onpopstate,!1):b&&n.removeEventListener("popstate",this._onpopstate,!1),this._click?n.document.addEventListener($,this.clickHandler,!1):w&&n.document.removeEventListener($,this.clickHandler,!1),this._hashbang&&b&&!_?n.addEventListener("hashchange",this._onpopstate,!1):b&&n.removeEventListener("hashchange",this._onpopstate,!1)},R.prototype.base=function(t){if(0===arguments.length)return this._base;this._base=t},R.prototype._getBase=function(){var t=this._base;if(t)return t;var e=b&&this._window&&this._window.location;return b&&this._hashbang&&e&&"file:"===e.protocol&&(t=e.pathname),t},R.prototype.strict=function(t){if(0===arguments.length)return this._strict;this._strict=t},R.prototype.start=function(t){var e=t||{};if(this.configure(e),!1!==e.dispatch){var n;if(this._running=!0,E){var i,r=this._window.location;n=this._hashbang&&~r.hash.indexOf("#!")?r.hash.substr(2)+r.search:this._hashbang?r.search+r.hash:r.pathname+r.search+r.hash}this.replace(n,null,!0,e.dispatch)}},R.prototype.stop=function(){if(this._running){this.current="",this.len=0,this._running=!1;var t=this._window;this._click&&t.document.removeEventListener($,this.clickHandler,!1),b&&t.removeEventListener("popstate",this._onpopstate,!1),b&&t.removeEventListener("hashchange",this._onpopstate,!1)}},R.prototype.show=function(t,e,n,i){var r=new L(t,e,this),o=this.prevContext;return this.prevContext=r,this.current=r.path,!1!==n&&this.dispatch(r,o),!1!==r.handled&&!1!==i&&r.pushState(),r},R.prototype.back=function(t,e){var n=this;if(this.len>0){var i=this._window;_&&i.history.back(),this.len--}else t?setTimeout(function(){n.show(t,e)}):setTimeout(function(){n.show(n._getBase(),e)})},R.prototype.redirect=function(t,e){var n=this;"string"==typeof t&&"string"==typeof e&&O.call(this,t,function(t){setTimeout(function(){n.replace(e)},0)}),"string"==typeof t&&void 0===e&&setTimeout(function(){n.replace(t)},0)},R.prototype.replace=function(t,e,n,i){var r=new L(t,e,this),o=this.prevContext;return this.prevContext=r,this.current=r.path,r.init=n,r.save(),!1!==i&&this.dispatch(r,o),r},R.prototype.dispatch=function(t,e){var n=0,i=0,r=this;function o(){var t=r.exits[i++];if(!t)return s();t(e,o)}function s(){var e=r.callbacks[n++];if(t.path===r.current)return e?void e(t,s):C.call(r,t);t.handled=!1}e?o():s()},R.prototype.exit=function(t,e){if("function"==typeof t)return this.exit("*",t);for(var n=new U(t,null,this),i=1;i<arguments.length;++i)this.exits.push(n.middleware(arguments[i]))},R.prototype.clickHandler=function(t){if(1===this._which(t)&&!(t.metaKey||t.ctrlKey||t.shiftKey||t.defaultPrevented)){var e=t.target,n=t.path||(t.composedPath?t.composedPath():null);if(n)for(var i=0;i<n.length;i++)if(n[i].nodeName&&"A"===n[i].nodeName.toUpperCase()&&n[i].href){e=n[i];break}for(;e&&"A"!==e.nodeName.toUpperCase();)e=e.parentNode;if(e&&"A"===e.nodeName.toUpperCase()){var r="object"==typeof e.href&&"SVGAnimatedString"===e.href.constructor.name;if(!e.hasAttribute("download")&&"external"!==e.getAttribute("rel")){var o=e.getAttribute("href");if((this._hashbang||!this._samePath(e)||!e.hash&&"#"!==o)&&!(o&&o.indexOf("mailto:")>-1)&&(r?!e.target.baseVal:!e.target)&&(r||this.sameOrigin(e.href))){var s=r?e.href.baseVal:e.pathname+e.search+(e.hash||"");s="/"!==s[0]?"/"+s:s,x&&s.match(/^\/[a-zA-Z]:\//)&&(s=s.replace(/^\/[a-zA-Z]:\//,"/"));var a=s,c=this._getBase();0===s.indexOf(c)&&(s=s.substr(c.length)),this._hashbang&&(s=s.replace("#!","")),(!c||a!==s||E&&"file:"===this._window.location.protocol)&&(t.preventDefault(),this.show(a))}}}}},R.prototype._onpopstate=(k=!1,b?(w&&"complete"===document.readyState?k=!0:(!0).addEventListener("load",function(){setTimeout(function(){k=!0},0)}),function t(e){if(k){var n=this;if(e.state){var i=e.state.path;this.replace(i,e.state)}else if(E){var r=this._window.location;this.show(r.pathname+r.search+r.hash,void 0,void 0,!1)}}}):function(){}),R.prototype._which=function(t){return null==(t=t||b&&this._window.event).which?t.button:t.which},R.prototype._toURL=function(t){var e=this._window;if("function"==typeof URL&&E)return new URL(t,e.location.toString());if(w){var n=e.document.createElement("a");return n.href=t,n}},R.prototype.sameOrigin=function(t){if(!t||!E)return!1;var e=this._toURL(t),n,i=this._window.location;return i.protocol===e.protocol&&i.hostname===e.hostname&&i.port===e.port},R.prototype._samePath=function(t){if(!E)return!1;var e,n=this._window.location;return t.pathname===n.pathname&&t.search===n.search},R.prototype._decodeURLEncodedURIComponent=function(t){return"string"!=typeof t?t:this._decodeURLComponents?decodeURIComponent(t.replace(/\+/g," ")):t},L.prototype.pushState=function(){var t=this.page,e=t._window,n=t._hashbang;t.len++,_&&e.history.pushState(this.state,this.title,n&&"/"!==this.path?"#!"+this.path:this.canonicalPath)},L.prototype.save=function(){var t=this.page;_&&t._window.history.replaceState(this.state,this.title,t._hashbang&&"/"!==this.path?"#!"+this.path:this.canonicalPath)},U.prototype.middleware=function(t){var e=this;return function(n,i){if(e.match(n.path,n.params))return t(n,i);i()}},U.prototype.match=function(t,e){var n=this.keys,i=t.indexOf("?"),r=~i?t.slice(0,i):t,o=this.regexp.exec(decodeURIComponent(r));if(!o)return!1;for(var s=1,a=o.length;s<a;++s){var c=n[s-1],p=this.page._decodeURLEncodedURIComponent(o[s]);void 0===p&&hasOwnProperty.call(e,c.name)||(e[c.name]=p)}return!0};var j=S(),H=j,T=j;return H.default=T,H}),(()=>{"use strict";const t=void 0!==!0?require("flairjs"):"undefined"!=typeof WorkerGlobalScope?WorkerGlobalScope.flair:(!0).flair,{Class:e,Struct:n,Enum:i,Interface:r,Mixin:o}=t,{Aspects:s}=t,{AppDomain:a}=t,c=t.AppDomain.context.current().name,{$$:p,attr:h}=t,{bring:l,Container:u,include:f}=t,{Port:d}=t,{on:v,post:m,telemetry:g}=t,{Reflector:y}=t,{Serializer:w}=t,{Tasks:b}=t,{TaskInfo:_}=t.Tasks,{as:x,is:$,isComplies:E,isDerivedFrom:k,isImplements:R,isInstanceOf:S,isMixed:O}=t,{getAssembly:C,getAttr:A,getContext:L,getResource:U,getRoute:j,getType:H,ns:T,getTypeOf:P,typeOf:I}=t,{dispose:B,using:M}=t,{Args:D,Exception:z,noop:q,nip:F,nim:V,nie:W,event:N}=t,{env:G}=t.options,{forEachAsync:K,replaceAll:J,splitAndTrim:Z,findIndexByProp:Q,findItemByProp:X,which:Y,isArrowFunc:tt,isASyncFunc:et,sieve:nt,b64EncodeUnicode:it,b64DecodeUnicode:rt}=t.utils,{$static:ot,$abstract:st,$virtual:at,$override:ct,$sealed:pt,$private:ht,$privateSet:lt,$protected:ut,$protectedSet:ft,$readonly:dt,$async:vt}=p,{$overload:mt,$enumerate:gt,$dispose:yt,$post:wt,$on:bt,$timer:_t,$type:xt,$args:$t,$inject:Et,$resource:kt,$asset:Rt,$singleton:St,$serialize:Ot,$deprecate:Ct,$session:At,$state:Lt,$conditional:Ut,$noserialize:jt,$ns:Ht}=p;let Tt=JSON.parse('{"host":"flair.boot.ServerHost | flair.boot.ClientHost","app":"flair.app.App","load":[],"container":{},"envVars":[],"envVarsloadOptions":{"overwrite":true},"mounts":{"main":"/"},"main-appSettings":[],"main-middlewares":[],"server-http":{"enable":false,"port":80,"timeout":-1},"server-https":{"enable":false,"port":443,"timeout":-1,"privateKey":"","publicCert":""}}'),Pt=t.Port("settingsReader");if("function"==typeof Pt){let t=Pt("flair.app");t&&(Tt=Object.assign(Tt,t))}Tt=Object.freeze(Tt),t.AppDomain.context.current().currentAssemblyBeingLoaded("./flair.app{.min}.js"),(async()=>{p("abstract"),p("ns","(root)"),e("Bootware",function(){p("virtual"),this.construct=((t,e,n)=>{let i=D("name: string, version: string","name: string, version: string, isMountSpecific: boolean","name: string, isMountSpecific: boolean","name: string")(t,e,n);i.throwOnError(this.construct),this.info=Object.freeze({name:i.name||"",version:i.version||"",isMountSpecific:i.isMountSpecific||!1})}),p("virtual"),p("async"),this.boot=q,p("readonly"),this.info=null,p("virtual"),p("async"),this.ready=q})})(),(async()=>{const{IDisposable:t}=T(),{Bootware:n}=T("flair.app");p("ns","(root)"),e("Host",n,[t],function(){p("privateSet"),this.isStarted=!1,p("virtual"),this.start=(async()=>{this.isStarted=!0}),p("virtual"),this.stop=(async()=>{this.isStarted=!1}),this.restart=(async()=>{await this.stop(),await this.start()}),this.error=N(t=>({error:t})),this.raiseError=(t=>{this.error(t)})})})(),(async()=>{const{IDisposable:t}=T(),{Bootware:n}=T("flair.app");p("ns","(root)"),e("App",n,[t],function(){p("override"),this.construct=(t=>{let e=C(this);t(e.title,e.version)}),p("override"),this.boot=(async t=>{t(),a.host().error.add(this.onError)}),p("virtual"),p("async"),this.start=q,p("virtual"),p("async"),this.stop=q,p("virtual"),this.onError=(t=>{throw z.OperationFailed(t.error,this.onError)}),p("virtual"),this.dispose=(()=>{a.host().error.remove(this.onError)})})})(),(async()=>{const{Bootware:t}=T("flair.app");p("static"),p("ns","(root)"),e("BootEngine",function(){this.start=async function(e){let n=[],i=[];const r=()=>{a.entryPoint(e)},o=async()=>{let t=null,e=null,r=null;for(let o of Tt.load)(o=Y(o))&&(t=await f(o))&&(e=x(t,e))&&(r=new e,n.push(r),r.info.isMountSpecific&&i.push(r))},s=async t=>{if(G.isWorker){0!==i.length&&console.warn("Mount specific bootwares are not supported for worker environment. Revisit worker:flair.app->load setting.");for(let e of n)e.info.isMountSpecific||await e[t]()}else{let e=a.host().mounts,r=Object.keys(e),o="",s=null;s=e[o="main"];for(let e of n)await e[t](o,s);for(let n of r)if("main"!==n){s=e[n];for(let e of i)await e[t](n,s)}}},c=async()=>{if(!G.isWorker){let e=Y(Tt.host),n=x(await f(e),t),i=null;if(!n)throw z.InvalidDefinition(e,this.start);i=new n,await i.boot(),a.host(i)}await s("boot");let e=Y(Tt.app),n=x(await f(e),t),i=null;if(!n)throw z.InvalidDefinition(e,this.start);i=new n,await i.boot(),a.app(i)},p=async()=>{G.isWorker||await a.host().start(),await a.app().start()},h=()=>new Promise((t,e)=>{G.global.document.addEventListener("DOMContentLoaded",t)}),l=()=>new Promise((t,e)=>{document.addEventListener("deviceready",t,!1)}),u=async()=>{G.isClient&&!G.isWorker&&(await h(),G.isCordova&&await l()),G.isWorker||await a.host().ready(),await s("ready"),await a.app().ready()};r(),await o(),await c(),await p(),await u()}})})(),(async()=>{const{Host:t}=T("flair.app");p("sealed"),p("ns","flair.boot"),e("ClientHost",t,function(){let t={},e=G.global.page,n=null;p("override"),this.construct=(t=>{t("Page","1.x")}),this.app=(()=>this.mounts["main"]),this.mounts={get:()=>t,set:q},p("override"),this.boot=(async n=>{n();let i=null,r="",o=null;const s=t=>{let e={},n=Tt[`${t}-appSettings`];if(n&&n.length>0)for(let t of n)e[t.name]=t.value;return e.click=!1,e.popstate=!1,e.dispatch=!1,e.hashbang=!1,e.decodeURLComponents=!0,e};i=s("main");let a=e.create(i);a.strict(i.strict),a.base("/");for(let n of Object.keys(Tt.mounts))"main"===n?(r="/",o=a):(i=s(n),r=Tt.mounts[n],(o=e.create(i)).strict(i.strict),o.base(r)),t[n]=Object.freeze({name:n,root:r,app:o});t=Object.freeze(t)}),p("override"),this.start=(async t=>{t(),n=(()=>{let t=G.global.location.hash;"#!/"===t.substr(0,3)&&(t=t.substr(3)),"#!"===t.substr(0,2)&&(t=t.substr(2)),"#/"===t.substr(0,2)&&(t=t.substr(2)),"#"===t.substr(0,1)&&(t=t.substr(1));let e=null;for(let n of this.mounts)if(t.startsWith(n.root)){e=n.app,t=t.substr(n.root.length);break}e||(e=this.mounts["main"]),setTimeout(()=>{try{e(t)}catch(t){this.error(t)}},0)})}),p("override"),this.ready=(async t=>{t(),G.global.addEventListener("hashchange",n),console.log(`${a.app().info.name}, v${a.app().info.version}`)}),p("override"),this.stop=(async t=>{t(),G.global.removeEventListener("hashchange",n)}),p("override"),this.dispose=(e=>{e(),t=null})})})(),(async()=>{const t=require("express"),n=require("fs"),i=require("http"),r=require("https"),o=require("http-shutdown"),{Host:s}=T("flair.app");p("sealed"),p("ns","flair.boot"),e("ServerHost",s,function(){let e={},s=null,c=null,h=Tt["server-https"],l=Tt["server-http"];p("override"),this.construct=(t=>{t("Express","4.x")}),this.app=(()=>this.mounts["main"]),this.mounts={get:()=>e,set:q},p("override"),this.boot=(async n=>{n();const i=(t,e)=>{let n=Tt[`${t}-appSettings`];if(n&&n.length>0)for(let t of n)e.set(t.name,t.value)};let r=t();i("main",r);let o="",s=null;for(let n of Object.keys(Tt.mounts))"main"===n?(o="/",s=r):(o=Tt.mounts[n],s=t()),e[n]=Object.freeze({name:n,root:o,app:s}),"main"!==n&&(i(n,s),r.use(o,s));e=Object.freeze(e)}),p("override"),this.start=(async t=>{if(t(),l.enable&&(s=i.createServer(this.app()),(s=o(s)).on("error",this.error),-1!==l.timeout&&(s.timeout=l.timeout)),h.enable){const t=n.readFileSync(h.privateKey,"utf8"),e=n.readFileSync(h.publicCert,"utf8"),i={key:t,cert:e};c=r.createServer(i,this.app()),(c=o(c)).on("error",this.error),-1!==h.timeout&&(c.timeout=h.timeout)}}),p("override"),this.ready=(async t=>{t();let e=l.port||80,n=process.env.PORT||h.port||443;s&&c?s.listen(e,()=>{s.listen(n,()=>{console.log(`${a.app().info.name}, v${a.app().info.version} (http: ${e}, https: ${n})`)})}):s?s.listen(e,()=>{console.log(`${a.app().info.name}, v${a.app().info.version} (http: ${e})`)}):c?c.listen(n,()=>{console.log(`${a.app().info.name}, v${a.app().info.version} (https: ${n})`)}):console.log(`${a.app().info.name}, v${a.app().info.version}`)}),p("override"),this.stop=(async t=>{t(),s&&(console.log("http server is shutting down..."),s.shutdown(()=>{s=null,console.log("http server is cleanly shutdown!")})),c&&(console.log("https server is shutting down..."),c.shutdown(()=>{c=null,console.log("https server is cleanly shutdown!")}))}),p("override"),this.dispose=(t=>{t(),e=null})})})(),(async()=>{const{Bootware:t}=T("flair.app");p("sealed"),p("ns","flair.bw"),e("DIContainer",t,function(){p("override"),this.construct=(t=>{t("DI Container")}),p("override"),this.boot=(async()=>{let t=Tt.container;for(let e in t)t.hasOwnProperty(e)&&u.register(e,t[e])})})})(),(async()=>{const{Bootware:t}=T("flair.app");p("sealed"),p("ns","flair.bw"),e("Middlewares",t,function(){p("override"),this.construct=(t=>{t("Express Middlewares",!0)}),p("override"),this.boot=(async t=>{let e=Tt[`${t.name}-middlewares`];if(e&&e.length>0){let n=null,i=null;for(let r of e)if(r.module)try{n=require(r.name),i=r.func?n[r.func]:n;let e=[],o=null;r.args=r.args||[];for(let t of r.args){if("string"==typeof t&&t.startsWith("return "))o=new Function(t)();else if("object"==typeof t)for(let e in t)t.hasOwnProperty(e)&&"string"==typeof(o=t[e])&&o.startsWith("return ")&&(o=new Function(t)(),t[e]=o);else o=t;e.push(o)}t.app.use(i(...e))}catch(t){throw z.OperationFailed(`Middleware ${r.module} load failed.`,t,this.boot)}}})})})(),(async()=>{const t=require("node-env-file"),{Bootware:n}=T("flair.app");p("sealed"),p("ns","flair.bw"),e("NodeEnv",n,function(){p("override"),this.construct=(t=>{t("Node Server Environment")}),p("override"),this.boot=(async()=>{if(Tt.envVars.length>0)for(let e of Tt.envVars)t(e,Tt.envVarsLoadOptions)})})})(),(async()=>{const{Bootware:t}=T("flair.app");p("sealed"),p("ns","flair.bw"),e("ResHeaders",t,function(){p("override"),this.construct=(t=>{t("Server Response Headers",!0)}),p("override"),this.boot=(async t=>{let e=Tt[`${t.name}-resHeaders`];e&&e.length>0&&t.app.use((t,n,i)=>{for(let t of e)n.setHeader(t.name,t.value);i()})})})})(),(async()=>{const{Bootware:t}=T("flair.app");p("sealed"),p("ns","flair.bw"),e("Router",t,function(){let t=null;p("override"),this.construct=(t=>{t("Router",!0)}),p("override"),this.boot=(async e=>{t||(t=a.context.current().allRoutes(!0)).sort((t,e)=>t.index<e.index?-1:t.index>e.index?1:0);let n=null,i=!1;const r=()=>{for(let r of t)r.mount===e.name&&(e.app[r.verb]=(r.path,(t,e,o)=>{const s=t=>{t?e.end():o()},c=t=>{e.status(500).end(),a.host().raiseError(t)};try{n=new r.Handler,"function"==typeof(i=n[r.verb](t,e)).then?i.then(t=>{s(t)}).catch(c):s(i)}catch(t){c(t)}}))},o=()=>{for(let r of t)r.mount===e.name&&e.app(r.path,(t,e)=>{const o=t=>{t||e()},s=t=>{a.host().raiseError(t)};try{n=new r.Handler,"function"==typeof(i=n[r.verb](t)).then?i.then(t=>{o(t)}).catch(s):o(i)}catch(t){s(t)}})};G.isServer?r():o()})})})(),t.AppDomain.context.current().currentAssemblyBeingLoaded(""),t.AppDomain.registerAdo('{"name":"flair.app","file":"./flair.app{.min}.js","desc":"True Object Oriented JavaScript","title":"Flair.js","version":"0.26.2","lupdate":"Sun, 24 Mar 2019 19:29:33 GMT","builder":{"name":"<<name>>","version":"<<version>>","format":"fasm","formatVersion":"1","contains":["initializer","types","enclosureVars","enclosedTypes","resources","assets","routes","selfreg"]},"copyright":"(c) 2017-2019 Vikas Burman","license":"MIT","types":["flair.app.Bootware","flair.app.Host","flair.app.App","flair.app.BootEngine","flair.boot.ClientHost","flair.boot.ServerHost","flair.bw.DIContainer","flair.bw.Middlewares","flair.bw.NodeEnv","flair.bw.ResHeaders","flair.bw.Router"],"resources":[],"assets":[],"routes":[]}')})();