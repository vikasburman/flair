/**
 * @preserve
 * Flair.js
 * True Object Oriented JavaScript
 * 
 * Assembly: flair.app
 *     File: ./flair.app.js
 *  Version: 0.6.0
 *  Sat, 11 May 2019 01:25:27 GMT
 * 
 * (c) 2017-2019 Vikas Burman
 * MIT
 */
!function(t,e){"use strict";"function"==typeof!0&&(!0).amd?(!0)(e):"object"==typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=e),module.exports=exports=e):t["flair.app"]=e}(this,async function(t){"use strict";const e=void 0!==!0?require("flairjs"):(!0).flair,{Class:i,Struct:a,Enum:r,Interface:s,Mixin:o,Aspects:n,AppDomain:l,$$:p,attr:c,bring:f,Container:d,include:u,Port:$,on:y,post:h,telemetry:w,Reflector:v,Serializer:m,Tasks:b,as:g,is:S,isComplies:A,isDerivedFrom:O,isAbstract:I,isSealed:k,isStatic:x,isSingleton:B,isDeprecated:E,isImplements:M,isInstanceOf:D,isMixed:j,getAssembly:C,getAttr:T,getContext:P,getResource:W,getRoute:z,getType:H,ns:F,getTypeOf:L,getTypeName:R,typeOf:V,dispose:J,using:N,Args:U,Exception:q,noop:G,nip:K,nim:Q,nie:X,event:Y}=e,{TaskInfo:Z}=e.Tasks,{env:_}=e.options,{forEachAsync:tt,replaceAll:et,splitAndTrim:it,findIndexByProp:at,findItemByProp:rt,which:st,guid:ot,isArrowFunc:nt,isASyncFunc:lt,sieve:pt,deepMerge:ct,b64EncodeUnicode:ft,b64DecodeUnicode:dt}=e.utils,{$$static:ut,$$abstract:$t,$$virtual:yt,$$override:ht,$$sealed:wt,$$private:vt,$$privateSet:mt,$$protected:bt,$$protectedSet:gt,$$readonly:St,$$async:At,$$overload:Ot,$$enumerate:It,$$dispose:kt,$$post:xt,$$on:Bt,$$timer:Et,$$type:Mt,$$args:Dt,$$inject:jt,$$resource:Ct,$$asset:Tt,$$singleton:Pt,$$serialize:Wt,$$deprecate:zt,$$session:Ht,$$state:Ft,$$conditional:Lt,$$noserialize:Rt,$$ns:Vt}=p,Jt=_.isServer||_.isWorker?null:(!0).document,Nt=l.context.current().name,Ut=t,qt=Ut.substr(0,Ut.lastIndexOf("/")+1);l.loadPathOf("flair.app",qt);let Gt=JSON.parse('{"types":{"host":"flair.app.ServerHost | flair.app.ClientHost","app":"flair.app.App"},"boot":{"load":[]},"di":{"container":{}}}'),Kt=e.Port("settingsReader");if("function"==typeof Kt){let t=Kt("flair.app");t&&(Gt=ct([Gt,t],!1))}Gt=Object.freeze(Gt);let Qt=JSON.parse("{}");Qt=Object.freeze(Qt);let Xt=()=>{};l.context.current().currentAssemblyBeingLoaded("./flair.app{.min}.js"),await(async()=>{p("abstract"),p("ns","flair.app"),i("Bootware",function(){p("virtual"),this.construct=((t,e,i)=>{let a=U("name: string, version: string","name: string, version: string, isMountSpecific: boolean","name: string, isMountSpecific: boolean","name: string")(t,e,i);a.throwOnError(this.construct),this.info=Object.freeze({name:a.values.name||"",version:a.values.version||"",isMountSpecific:a.values.isMountSpecific||!1})}),p("virtual"),p("async"),this.boot=G,p("readonly"),this.info=null,p("virtual"),p("async"),this.ready=G,p("virtual"),this.dispose=G})})(),await(async()=>{const{IDisposable:t}=F();p("ns","flair.app"),i("Handler",[t],function(){p("virtual"),this.construct=(()=>{}),p("virtual"),this.dispose=(()=>{})})})(),await(async()=>{const{IDisposable:t}=F(),{Bootware:e}=F("flair.app");p("ns","flair.app"),i("App",e,[t],function(){p("override"),this.construct=(t=>{let e=C(this);t(e.title,e.version)}),p("override"),this.boot=(async t=>{t(),l.host().error.add(this.onError)}),p("virtual"),this.start=(async()=>{if(!_.isServer&&!_.isWorker){const{ViewState:t}=F("flair.ui");new t}}),p("virtual"),this.stop=(async()=>{if(!_.isServer&&!_.isWorker){const{ViewState:t}=F("flair.ui");(new t).clear()}}),p("virtual"),this.onError=(t=>{throw q.OperationFailed(t.error,this.onError)}),p("override"),this.dispose=(t=>{t(),l.host().error.remove(this.onError)})})})(),await(async()=>{const{IDisposable:t}=F(),{Bootware:e}=F("flair.app");p("ns","flair.app"),i("Host",e,[t],function(){p("privateSet"),this.isStarted=!1,p("virtual"),this.start=(async()=>{this.isStarted=!0}),p("virtual"),this.stop=(async()=>{this.isStarted=!1}),this.restart=(async()=>{await this.stop(),await this.start()}),this.error=Y(t=>({error:t})),this.raiseError=(t=>{this.error(t)})})})(),await(async()=>{const{Bootware:t}=F("flair.app");p("static"),p("ns","flair.app"),i("BootEngine",function(){this.start=async function(){let e=[],i=[];const a=async()=>{let a=null,r=null,s=null;for(let o of Gt.boot.load)(o=st(o))&&(a=await u(o))&&"boolean"!=typeof a&&(r=g(a,t))&&(s=new r,e.push(s),s.info.isMountSpecific&&i.push(s))},r=async t=>{if(_.isWorker){0!==i.length&&console.warn("Mount specific bootwares are not supported for worker environment. Revisit worker:flair.app->load setting.");for(let i of e)i.info.isMountSpecific||await i[t]()}else{let a=l.host().mounts,r=Object.keys(a),s="",o=null;o=a[s="main"];for(let i of e)await i[t](o);for(let e of r)if("main"!==e){o=a[e];for(let e of i)await e[t](o)}}},s=async()=>{if(!_.isWorker){let e=st(Gt.types.host),i=g(await u(e),t),a=null;if(!i)throw q.InvalidDefinition(e,this.start);a=new i,await a.boot(),l.host(a)}await r("boot");let e=st(Gt.types.app),i=g(await u(e),t),a=null;if(!i)throw q.InvalidDefinition(e,this.start);a=new i,await a.boot(),l.app(a)},o=async()=>{_.isWorker||await l.host().start(),await l.app().start()},n=()=>new Promise((t,e)=>{"loading"!==document.readyState?t():(!0).document.addEventListener("DOMContentLoaded",()=>{t()})}),p=()=>new Promise((t,e)=>{(!0).document.addEventListener("deviceready",()=>{t()},!1)}),c=async()=>{_.isClient&&!_.isWorker&&(await n(),_.isCordova&&await p()),_.isWorker||await l.host().ready(),await r("ready"),await l.app().ready()};await a(),await s(),await o(),await c(),console.log("ready!")}})})(),await(async()=>{const{Bootware:t}=F("flair.app");p("sealed"),p("ns","flair.boot"),i("DIContainer",t,function(){p("override"),this.construct=(t=>{t("DI Container")}),p("override"),this.boot=(async t=>{t();let e=Gt.di.container;for(let t in e)e.hasOwnProperty(t)&&d.register(t,e[t])})})})(),l.context.current().currentAssemblyBeingLoaded(""),l.registerAdo('{"name":"flair.app","file":"./flair.app{.min}.js","mainAssembly":"flair","desc":"True Object Oriented JavaScript","title":"Flair.js","version":"0.6.0","lupdate":"Sat, 11 May 2019 01:25:27 GMT","builder":{"name":"flairBuild","version":"1","format":"fasm","formatVersion":"1","contains":["init","func","type","vars","reso","asst","rout","sreg"]},"copyright":"(c) 2017-2019 Vikas Burman","license":"MIT","types":["flair.app.Bootware","flair.app.Handler","flair.app.App","flair.app.Host","flair.app.BootEngine","flair.boot.DIContainer"],"resources":[],"assets":[],"routes":[]}')});