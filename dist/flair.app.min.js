/**
 * @preserve
 * Flair.js
 * True Object Oriented JavaScript
 * 
 * Assembly: flair.app
 *     File: ./flair.app.js
 *  Version: 0.6.82
 *  Mon, 13 May 2019 19:15:31 GMT
 * 
 * (c) 2017-2019 Vikas Burman
 * MIT
 */
!function(t,e){"use strict";"function"==typeof!0&&(!0).amd?(!0)(e):"object"==typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=e),module.exports=exports=e):t["flair.app"]=e}(this,async function(t,e){"use strict";const{Class:i,Struct:a,Enum:n,Interface:r,Mixin:s,Aspects:o,AppDomain:l,$$:c,attr:p,bring:h,Container:u,include:d,Port:f,on:m,post:y,telemetry:v,Reflector:w,Serializer:g,Tasks:$,as:b,is:x,isComplies:O,isDerivedFrom:V,isAbstract:A,isSealed:S,isStatic:F,isSingleton:I,isDeprecated:C,isImplements:E,isInstanceOf:M,isMixed:D,getAssembly:P,getAttr:L,getContext:H,getResource:j,getRoute:R,getType:T,ns:B,getTypeOf:k,getTypeName:W,typeOf:z,dispose:N,using:J,Args:U,Exception:q,noop:K,nip:G,nim:_,nie:Q,event:X}=t,{TaskInfo:Y}=t.Tasks,{env:Z}=t.options,{forEachAsync:tt,replaceAll:et,splitAndTrim:it,findIndexByProp:at,findItemByProp:nt,which:rt,guid:st,isArrowFunc:ot,isASyncFunc:lt,sieve:ct,deepMerge:pt,getLoadedScript:ht,b64EncodeUnicode:ut,b64DecodeUnicode:dt}=t.utils,{$$static:ft,$$abstract:mt,$$virtual:yt,$$override:vt,$$sealed:wt,$$private:gt,$$privateSet:$t,$$protected:bt,$$protectedSet:xt,$$readonly:Ot,$$async:Vt,$$overload:At,$$enumerate:St,$$dispose:Ft,$$post:It,$$on:Ct,$$timer:Et,$$type:Mt,$$args:Dt,$$inject:Pt,$$resource:Lt,$$asset:Ht,$$singleton:jt,$$serialize:Rt,$$deprecate:Tt,$$session:Bt,$$state:kt,$$conditional:Wt,$$noserialize:zt,$$ns:Nt}=c,Jt=Z.isServer||Z.isWorker?null:(!0).document,Ut=l.context.current().name,qt=e,Kt=qt.substr(0,qt.lastIndexOf("/")+1);l.loadPathOf("flair.app",Kt);let Gt=JSON.parse('{"host":"flair.app.ServerHost | flair.app.ClientHost","app":"flair.app.App","boot":{"files":[],"preambles":[],"bootwares":[]},"di":{"container":{}},"client":{"view":{"el":"main","title":"","transition":""},"url":{"404":"/404","hashbang":false,"i18n":false,"home":"/"},"vue":{"components":[],"filters":[],"mixins":[],"directives":[],"plugins":[],"pluginOptions":{}},"i18n":{"enabled":true,"locale":"en","locales":[{"code":"en","name":"English","native":"English"}]},"routing":{"mounts":{"main":"/"},"main-options":[],"main-interceptors":[]}},"server":{"express":{"server-http":{"enable":false,"port":80,"timeout":-1},"server-https":{"enable":false,"port":443,"timeout":-1,"privateKey":"","publicCert":""}},"envVars":{"vars":[],"options":{"overwrite":true}},"routing":{"mounts":{"main":"/"},"main-appSettings":[],"main-middlewares":[],"main-interceptors":[],"main-resHeaders":[]}}}'),_t=t.Port("settingsReader");if("function"==typeof _t){let t=_t("flair.app");t&&(Gt=pt([Gt,t],!1))}Gt=Object.freeze(Gt);let Qt=JSON.parse("{}");Qt=Object.freeze(Qt);let Xt=()=>{};return l.context.current().currentAssemblyBeingLoaded("./flair.app{.min}.js"),await(async()=>{c("abstract"),c("ns","flair.app"),i("Bootware",function(){c("virtual"),this.construct=((t,e,i)=>{let a=U("name: string, version: string","name: string, version: string, isMountSpecific: boolean","name: string, isMountSpecific: boolean","name: string")(t,e,i);a.throwOnError(this.construct),this.info=Object.freeze({name:a.values.name||"",version:a.values.version||"",isMountSpecific:a.values.isMountSpecific||!1})}),c("virtual"),c("async"),this.boot=K,c("readonly"),this.info=null,c("virtual"),c("async"),this.ready=K,c("virtual"),this.dispose=K})})(),await(async()=>{const{IDisposable:t}=B();c("ns","flair.app"),i("Handler",[t],function(){c("virtual"),this.construct=(()=>{}),c("virtual"),this.dispose=(()=>{})})})(),await(async()=>{const{IDisposable:t}=B(),{Bootware:e}=B("flair.app");c("ns","flair.app"),i("App",e,[t],function(){c("override"),this.construct=(t=>{let e=P(this);t(e.title,e.version)}),c("override"),c("sealed"),this.boot=(async t=>{t(),l.host().error.add(this.handleError)}),this.start=(async()=>{if(!Z.isServer&&!Z.isWorker){const{ViewState:t}=B("flair.ui");new t}await this.onStart()}),c("virtual"),c("async"),this.onStart=K,c("override"),c("sealed"),this.ready=(async()=>{await this.onReady()}),c("virtual"),c("async"),this.onReady=K,this.stop=(async()=>{if(!Z.isServer&&!Z.isWorker){const{ViewState:t}=B("flair.ui");(new t).clear()}await this.onStop()}),c("virtual"),c("async"),this.onStop=K,c("private"),this.handleError=(t=>{this.onError(t.error)}),c("virtual"),this.onError=(t=>{throw q.OperationFailed(t,this.onError)}),c("override"),this.dispose=(t=>{t(),l.host().error.remove(this.handleError)})})})(),await(async()=>{const{IDisposable:t}=B(),{Bootware:e}=B("flair.app");c("ns","flair.app"),i("Host",e,[t],function(){c("virtual"),c("async"),this.start=K,c("virtual"),c("async"),this.stop=K,this.error=X(t=>({error:t})),this.raiseError=(t=>{this.error(t)})})})(),await(async()=>{c("ns","flair.ui.vue"),s("VueComponentMembers",function(){var t=this;c("private"),this.define=(async()=>{const e=await d("vue/vue{.min}.js"),{ViewState:i}=B("flair.ui"),{VueFilter:a,VueMixin:n,VueDirective:r,VueComponent:s}=B("flair.ui.vue");let o=new i,l={},c=f("clientFile");if(this.style&&this.style.endsWith(".css")&&(this.style=await c(this.style)),this.html&&this.html.endsWith(".html")&&(this.html=await c(this.html)),Gt.client.i18n.enabled&&this.i18n){let t="";for(let e in this.i18n)this.i18n.hasOwnProperty(e)&&(t=this.$self.assemblyName+"/locales/"+this.locale()+"/"+this.i18n[e],this.i18n[e]=await c(t))}if(this.template?l.template=this.template:this.style&&this.html?l.template="<div><style scoped>"+this.style.trim()+"</style><div>"+this.html.trim()+"</div></div>":this.html&&(l.template=this.html.trim()),this.render&&"function"==typeof this.render&&(l.render=this.render),"boolean"==typeof this.functional&&(l.functional=this.functional),this.computed)for(let t in this.computed)this.computed.hasOwnProperty(t)&&(l.computed=l.computed||{},l.computed[t]=this.computed[t]);if(this.state&&Array.isArray(this.state))for(let t of this.state){if(l.computed[t.name])throw q.InvalidDefinition(`Computed (state) property already defined. (${t.name})`);l.computed=l.computed||{},l.computed[t.name]={get:function(){return o.get(t.path,t.name)||t.value},set:function(e){o.set(t.path,t.name,e)}}}if(this.methods)for(let t in this.methods)this.methods.hasOwnProperty(t)&&(l.methods=l.methods||{},l.methods[t]=this.methods[t]);if(l.methods=l.methods||{},l.methods["path"]=(e=>t.path(e)),l.methods=l.methods||{},l.methods["route"]=((e,i)=>t.route(e,i)),Gt.client.i18n.enabled&&(l.methods["locale"]=(e=>t.locale(e)),l.methods["i18n"]=((e,i,a)=>t.i18n&&t.i18n[e]&&t.i18n[e][i]?t.i18n[e][i]||a||"(i18n: 404)":a||"(i18n: 404)")),this.watch)for(let t in this.watch)this.watch.hasOwnProperty(t)&&(l.watch=l.watch||{},l.watch[t]=this.watch[t]);if(this.lifecycle)for(let t in this.lifecycle)this.lifecycle.hasOwnProperty(t)&&(l[t]=this.lifecycle[t]);if(this.components&&Array.isArray(this.components)){let t=null,i=null;for(let a of this.components){if(!a.name)throw q.OperationFailed(`Component name cannot be empty. (${a.type})`);if(!a.type)throw q.OperationFailed(`Component type cannot be empty. (${a.name})`);if(!(t=b(await d(a.name),s)))throw q.InvalidArgument(a.type);try{if(i=new t,e.options.components[a.name])throw q.Duplicate(`Component already registered. (${a.name})`);if(i.components&&i.components[a.name])throw q.Duplicate(`Component already registered. (${a.name})`);i.components=i.components||{},i.components[a.name]=await i.factory()}catch(t){throw q.OperationFailed(`Component registration failed. (${a.type})`,t)}}}if(this.mixins&&Array.isArray(this.mixins)){let t=null,e=null;for(let i of this.mixins){if(!i.name)throw q.OperationFailed(`Mixin name cannot be empty. (${i.type})`);if(!i.type)throw q.OperationFailed(`Mixin type cannot be empty. (${i.name})`);if(!(t=b(await d(i.type),n)))throw q.InvalidArgument(i.type);try{if(e=new t,l.mixins&&l.mixins[i.name])throw q.Duplicate(`Mixin already registered. (${i.name})`);l.mixins=l.mixins||{},l.mixins[i.name]=await e.factory()}catch(t){throw q.OperationFailed(`Mixin registration failed. (${i.type})`,t)}}}if(this.directives&&Array.isArray(this.directives)){let t=null,e=null;for(let i of this.directives){if(!i.name)throw q.OperationFailed(`Directive name cannot be empty. (${i.type})`);if(!i.type)throw q.OperationFailed(`Directive type cannot be empty. (${i.name})`);if(!(t=b(await d(i.type),r)))throw q.InvalidArgument(i.type);try{if(e=new t,l.directives&&l.directives[i.name])throw q.Duplicate(`Directive already registered. (${i.name})`);l.directives=l.directives||{},l.directives[i.name]=await e.factory()}catch(t){throw q.OperationFailed(`Directive registration failed. (${i.type})`,t)}}}if(this.filters&&Array.isArray(this.filters)){let t=null,e=null;for(let i of this.filters){if(!i.name)throw q.OperationFailed(`Filter name cannot be empty. (${i.type})`);if(!i.type)throw q.OperationFailed(`Filter type cannot be empty. (${i.name})`);if(!(t=b(await d(i.type),a)))throw q.InvalidArgument(i.type);try{if(e=new t,l.filters&&l.filters[i.name])throw q.Duplicate(`Filter already registered. (${i.name})`);l.filters=l.filters||{},l.filters[i.name]=await e.factory()}catch(t){throw q.OperationFailed(`Filter registration failed. (${i.type})`,t)}}}return this.provide&&Array.isArray(this.provide)&&(l.provide=this.provide),this.inject&&Array.isArray(this.inject)&&(l.inject=this.inject),l}),c("protected"),this.locale=(t=>l.host().locale(t)),c("protected"),this.path=(t=>l.host().path(t)),c("protected"),this.route=((t,e)=>l.host().route(t,e)),c("protected"),this.i18n=null,c("protected"),this.style="",c("protected"),this.html="",c("protected"),this.template=null,c("protected"),this.render=null,c("protected"),this.functional=!1,c("protected"),this.computed=null,c("protected"),this.state=null,c("protected"),this.methods=null,c("protected"),this.watch=null,c("protected"),this.lifecycle=null,c("protected"),this.components=null,c("protected"),this.mixins=null,c("protected"),this.directives=null,c("protected"),this.filters=null,c("protected"),this.provide=null,c("protected"),this.inject=null})})(),await(async()=>{const{Handler:t}=B("flair.app");c("ns","flair.api"),i("RestHandler",t,function(){c("virtual"),this.get=K,c("virtual"),this.post=K,c("virtual"),this.put=K,c("virtual"),this.delete=K})})(),await(async()=>{c("ns","flair.api"),i("RestInterceptor",function(){c("virtual"),c("async"),this.run=K})})(),await(async()=>{const{Bootware:e}=B("flair.app");c("static"),c("ns","flair.app"),i("BootEngine",function(){this.start=async function(){let i=[],a=[];const n=async()=>{for(let t of Gt.boot.files)(t=rt(t))&&await d(t)},r=async()=>{for(let e of Gt.boot.preambles)(e=rt(e))&&await d(e)(t)},s=async()=>{let t=null,n=null,r=null;for(let s of Gt.boot.bootwares)(s=rt(s))&&(t=await d(s))&&"boolean"!=typeof t&&(n=b(t,e))&&(r=new n,i.push(r),r.info.isMountSpecific&&a.push(r))},o=async t=>{if(Z.isWorker){0!==a.length&&console.warn("Mount specific bootwares are not supported for worker environment. Revisit worker:flair.app->load setting.");for(let e of i)e.info.isMountSpecific||await e[t]()}else{let e=l.host().mounts,n=Object.keys(e),r="",s=null;s=e[r="main"];for(let e of i)await e[t](s);for(let i of n)if("main"!==i){s=e[i];for(let e of a)await e[t](s)}}},c=async()=>{const t=await d(Gt.host),e=await d(Gt.app);if(!Z.isWorker){let e=new t;await e.boot(),l.host(e)}await o("boot");let i=new e;await i.boot(),l.app(i)},p=async()=>{Z.isWorker||await l.host().start(),await l.app().start()},h=()=>new Promise((t,e)=>{"loading"!==document.readyState?t():(!0).document.addEventListener("DOMContentLoaded",()=>{t()})}),u=()=>new Promise((t,e)=>{(!0).document.addEventListener("deviceready",()=>{t()},!1)}),f=async()=>{Z.isClient&&!Z.isWorker&&(await h(),Z.isCordova&&await u()),Z.isWorker||await l.host().ready(),await o("ready"),await l.app().ready()};await n(),await r(),await s(),await c(),await p(),await f(),console.log("ready!")}})})(),await(async()=>{const{Host:t}=B("flair.app");c("sealed"),c("ns","flair.app"),i("ClientHost",t,function(){let t={},e=null;c("override"),this.construct=(t=>{t("Page","1.x")}),this.app={get:()=>this.mounts["main"].app,set:K},this.mounts={get:()=>t,set:K},c("state"),c("private"),this.currentLocale=Gt.client.i18n.locale,this.defaultLocale={get:()=>Gt.client.i18n.locale,set:K},this.supportedLocales={get:()=>Gt.client.i18n.locales.slice(),set:K},this.locale=((t,i)=>Gt.client.i18n.enabled?(t&&this.currentLocale!==t&&(this.currentLocale=t,i||(Gt.client.url.i18n?window.location.hash=this.replaceLocale((!0).location.hash):e&&e())),this.currentLocale):""),c("private"),this.cleanPath=(t=>("/"===t.substr(0,1)&&(t=t.substr(1)),"#!/"===t.substr(0,3)&&(t=t.substr(3)),"#!"===t.substr(0,2)&&(t=t.substr(2)),"#/"===t.substr(0,2)&&(t=t.substr(2)),"#"===t.substr(0,1)&&(t=t.substr(1)),"/"===t.substr(0,1)&&(t=t.substr(1)),t)),c("private"),this.extractLocale=(t=>{if(!Gt.client.url.i18n)return"";let e=t.indexOf("/");if(-1!==e){let i=t.substr(0,e);if(-1!==this.supportedLocales.indexOf(i))return i}return""}),c("private"),this.trimLocale=((t,e)=>{let i=e+"/",a=t.indexOf(i);return-1!==a?t.substr(a+i.length):t}),c("private"),this.replaceLocale=(t=>{if(Gt.client.url.i18n){t=this.cleanPath(t);let e=this.extractLocale(t);e&&(t=this.trimLocale(t,e)),t=this.path(t)}return t}),this.path=(t=>t?(t=this.cleanPath(t),t=Gt.client.url.hashbang?"/#!/"+t:"/#/"+t,Gt.client.i18n.enabled&&Gt.client.url.i18n&&(t=(this.currentLocale||this.defaultLocale)+"/"+t),t):""),this.route=((t,e)=>{if(!t)return;let i="",a=l.context.current().getRoute(t);if(a&&(i=a.path),i&&e){let t=i.indexOf(":"),a=-1,n="";for(;-1!==t;)n=-1===(a=i.substr(t+1).indexOf("/"))?i.substr(t+1):i.substr(t+1,a),t=(i=et(i,":"+n,e[n])).indexOf(":")}return this.path(i)}),c("override"),this.boot=(async e=>{e();const i=await d("page/page{.min}.js","page");let a=null,n="",r=null;const s=t=>{let e={},i=Gt.client.routing[`${t}-options`];if(i&&i.length>0)for(let t of i)e[t.name]=t.value;return e.click=!1,e.popstate=!1,e.dispatch=!1,e.hashbang=!1,e.decodeURLComponents=!0,e.window=!0,e};i(a=s("main"));let o=i;o.strict(a.strict),o.base("/");for(let e of Object.keys(Gt.client.routing.mounts))"main"===e?(n="/",r=o):(a=s(e),n=Gt.client.routing.mounts[e],(r=i.create(a)).strict(a.strict),r.base(n)),t[e]=Object.freeze({name:e,root:n,app:r});t=Object.freeze(t)}),c("override"),this.start=(async t=>{t(),e=(()=>{let t=this.cleanPath((!0).location.hash);if(Gt.client.i18n.enabled&&Gt.client.url.i18n){let e=this.extractLocale(t);e&&(t=this.trimLocale(t,e),this.locale(e,!0))}t=("/"!==t.substr(0,1)?"/":"")+t;let e=null,i="";for(let a of this.mounts)if(t.startsWith(a.root)){e=a.app,t=t.substr(a.root.length),i=a;break}e||(i="main",e=this.mounts[i]),"/"!==t.substr(0,1)&&(t="/"+t),setTimeout(()=>{try{e(t)}catch(t){this.error(t)}},0)})}),c("override"),this.ready=(async t=>{t(),(!0).addEventListener("hashchange",e),this.app.redirect(Gt.client.url.home),console.log(`${l.app().info.name}, v${l.app().info.version}`)}),c("override"),this.stop=(async t=>{t(),(!0).removeEventListener("hashchange",e)}),c("override"),this.dispose=(e=>{e(),t=null})})})(),await(async()=>{const{Host:t}=B("flair.app");c("sealed"),c("ns","flair.app"),i("ServerHost",t,function(){let t={},e=null,i=null,a=Gt.server.express["server-http"],n=Gt.server.express["server-https"];c("override"),this.construct=(t=>{t("Express","4.x")}),this.app={get:()=>this.mounts["main"].app,set:K},this.mounts={get:()=>t,set:K},c("override"),this.boot=(async e=>{e();const i=await d("express | x"),a=(t,e)=>{let i=Gt.server.routing[`${t}-appSettings`];if(i&&i.length>0)for(let t of i)e.set(t.name,t.value)};let n=i();a("main",n);let r="",s=null;for(let e of Object.keys(Gt.server.routing.mounts))"main"===e?(r="/",s=n):(r=Gt.server.routing.mounts[e],s=i()),t[e]=Object.freeze({name:e,root:r,app:s}),"main"!==e&&(a(e,s),n.use(r,s));t=Object.freeze(t)}),c("override"),this.start=(async t=>{t();const r=await d("fs | x"),s=await d("http | x"),o=await d("https | x"),c=await d("http-shutdown | x");if(a.enable&&((e=c(e=s.createServer(this.app))).on("error",t=>{this.error(t)}),-1!==a.timeout&&(e.timeout=a.timeout)),n.enable){const t=r.readFileSync(l.resolvePath(n.privateKey),"utf8"),e=r.readFileSync(l.resolvePath(n.publicCert),"utf8"),a={key:t,cert:e};(i=c(i=o.createServer(a,this.app))).on("error",t=>{this.error(t)}),-1!==n.timeout&&(i.timeout=n.timeout)}}),c("override"),this.ready=(t=>new Promise((r,s)=>{t();let o=a.port||80,c=process.env.PORT||n.port||443;e&&i?e.listen(o,()=>{i.listen(c,()=>{console.log(`${l.app().info.name}, v${l.app().info.version} (http: ${o}, https: ${c})`),r()})}):e?e.listen(o,()=>{console.log(`${l.app().info.name}, v${l.app().info.version} (http: ${o})`),r()}):i?i.listen(c,()=>{console.log(`${l.app().info.name}, v${l.app().info.version} (https: ${c})`),r()}):(console.log(`${l.app().info.name}, v${l.app().info.version}`),r())})),c("override"),this.stop=(async t=>{t(),e&&(console.log("http server is shutting down..."),e.shutdown(()=>{e=null,console.log("http server is cleanly shutdown!")})),i&&(console.log("https server is shutting down..."),i.shutdown(()=>{i=null,console.log("https server is cleanly shutdown!")}))}),c("override"),this.dispose=(e=>{e(),t=null})})})(),await(async()=>{const{Bootware:t}=B("flair.app");c("sealed"),c("ns","flair.boot"),i("ClientRouter",t,function(){const{ViewHandler:t,ViewInterceptor:e}=B("flair.ui");let i=null;c("override"),this.construct=(t=>{t("Client Router",!0)}),c("override"),this.boot=(async(a,n)=>{a(),i||(i=l.context.current().allRoutes(!0)).sort((t,e)=>t.index<e.index?-1:t.index>e.index?1:0);const r=(t,e)=>new Promise((i,a)=>{try{let n;(new t).run(e).then(()=>{e.$stop?a():i()}).catch(a)}catch(t){a(t)}}),s=(t,i)=>tt(t,(t,a,n)=>{d(n).then(s=>{let o=b(s,e);o?r(o,i).then(t).catch(a):a(q.InvalidDefinition(`Invalid interceptor type. (${n})`))}).catch(a)});let o="view";for(let e of i)e.mount===n.name&&n.app(e.path,i=>{const a=t=>{l.host().raiseError(t)},r=t=>{n.app.redirect(t)},c=()=>{d(e.handler).then(n=>{let s=b(n,t);if(s)try{J(new s,t=>{t[o](i).then(()=>{i.handled=!0,i.$redirect&&r(i.$redirect)}).catch(a)})}catch(t){a(t)}else a(q.InvalidDefinition(`Invalid route handler. (${e.handler})`))}).catch(a)};i.$stop=!1,i.$redirect="";let p=Gt.client.routing[`${n.name}-interceptors`]||[];s(p,i).then(()=>{i.$stop?(i.handled=!0,i.$redirect&&r(i.$redirect)):c()}).catch(t=>{i.$stop?(i.handled=!0,i.$redirect&&r(i.$redirect)):a(t)})});n.app("*",t=>{let e=Gt.client.url["404"];e?(t.handled=!0,t.pathname!==e&&n.app.redirect(e)):(!0).history.back()})})})})(),await(async()=>{const{Bootware:t}=B("flair.app");c("sealed"),c("ns","flair.boot"),i("DIContainer",t,function(){c("override"),this.construct=(t=>{t("DI Container")}),c("override"),this.boot=(async t=>{t();let e=Gt.di.container;for(let t in e)e.hasOwnProperty(t)&&u.register(t,e[t])})})})(),await(async()=>{const{Bootware:t}=B("flair.app");c("sealed"),c("ns","flair.boot"),i("Middlewares",t,function(){c("override"),this.construct=(t=>{t("Express Middlewares",!0)}),c("override"),this.boot=(async(t,e)=>{t();let i=Gt.server.routing[`${e.name}-middlewares`];if(i&&i.length>0){let t=null,a=null;for(let n of i)if(n.name)try{t=require(n.name),a=n.func?t[n.func]:t;let i=[],r=null;n.args=n.args||[];for(let t of n.args){if("string"==typeof t&&t.startsWith("return "))r=new Function(t)();else if("object"==typeof t){for(let e in t)t.hasOwnProperty(e)&&"string"==typeof(r=t[e])&&r.startsWith("return ")&&(r=new Function(t)(),t[e]=r);r=t}else r=t;i.push(r)}e.app.use(a(...i))}catch(t){throw q.OperationFailed(`Middleware ${n.module} load failed.`,t,this.boot)}}})})})(),await(async()=>{const{Bootware:t}=B("flair.app");c("sealed"),c("ns","flair.boot"),i("NodeEnv",t,function(){c("override"),this.construct=(t=>{t("Node Server Environment")}),c("override"),this.boot=(async t=>{if(t(),Gt.server.envVars.vars.length>0){const t=await d("node-env-file | x");if(t)for(let e of Gt.server.envVars.vars)t(l.resolvePath(e),Gt.server.envVars.options)}})})})(),await(async()=>{const{Bootware:t}=B("flair.app");c("sealed"),c("ns","flair.boot"),i("ResHeaders",t,function(){c("override"),this.construct=(t=>{t("Server Response Headers",!0)}),c("override"),this.boot=(async(t,e)=>{t();let i=Gt[`${e.name}-resHeaders`];i&&i.length>0&&e.app.use((t,e,a)=>{for(let t of i)e.setHeader(t.name,t.value);a()})})})})(),await(async()=>{const{Bootware:t}=B("flair.app");c("sealed"),c("ns","flair.boot"),i("ServerRouter",t,function(){const{RestHandler:t,RestInterceptor:e}=B("flair.api");let i=null;c("override"),this.construct=(t=>{t("Server Router",!0)}),c("override"),this.boot=(async(a,n)=>{a(),i||(i=l.context.current().allRoutes(!0)).sort((t,e)=>t.index<e.index?-1:t.index>e.index?1:0);let r=!1;const s=(t,e,i)=>new Promise((a,n)=>{try{let r;(new t).run(e,i).then(()=>{e.$stop?n():a()}).catch(n)}catch(t){n(t)}}),o=(t,i,a)=>tt(t,(t,n,r)=>{d(r).then(o=>{let l=b(o,e);l?s(l,i,a).then(t).catch(n):n(q.InvalidDefinition(`Invalid interceptor type. (${r})`))}).catch(n)});for(let e of i)e.mount===n.name&&e.verbs.forEach(i=>{n.app[i](e.path,(a,s,l)=>{const c=t=>{l(t)},p=t=>{t||l()},h=()=>{d(e.handler).then(n=>{let o=b(n,t);if(o)try{J(new o,t=>{(r=t[i](a,s))&&"function"==typeof r.then?r.then(t=>{p(t)}).catch(c):p(r)})}catch(t){c(t)}else c(q.InvalidDefinition(`Invalid route handler. ${e.handler}`))}).catch(c)};a.$stop=!1;let u=Gt.server.routing[`${n.name}-interceptors`]||[];o(u,a,s).then(()=>{a.$stop?s.end():h()}).catch(t=>{a.stop?s.end():c(t)})})});n.app.use((t,e,i)=>{var a=new Error("Not Found");a.status=404,i(a)}),Z.isProd,n.app.use((t,e,i)=>{i.status(t.status||500),e.xhr?i.status(500).send({error:t.toString()}):i.render("error",{message:t.message,error:t}),i.end()})})})})(),await(async()=>{const{Handler:t}=B("flair.app");c("ns","flair.ui"),i("ViewHandler",t,function(){let t="";c("override"),this.construct=((e,i,a,n)=>{e(),t=i||"main",this.viewTransition=n,this.title=this.title+(a?" - "+a:"")}),c("privateSet"),this.viewTransition="",c("protectedSet"),this.name="",c("protectedSet"),this.title="",c("protectedSet"),this.meta=null,this.view=(async e=>{const{ViewTransition:i}=B("flair.ui");if(this.name=this.name||this.$self.id+"_"+st(),this.viewTransition){let t=b(await d(this.viewTransition),i);this.viewTransition=t?new t:""}let a=Jt.createElement("div"),n=Jt.getElementById(t);a.id=this.name,a.setAttribute("hidden",""),n.appendChild(a),this.load(e,a),await this.swap()}),c("protected"),c("virtual"),c("async"),this.loadView=K,c("private"),this.swap=(async()=>{let e=Jt.getElementById(this.name);if(this.$static.currentView){let i=Jt.getElementById(this.$static.currentView),a;for(let t of this.meta)Jt.head.removeChild(Jt.querySelector('meta[name="'+t+'"]'));this.viewTransition?(await this.viewTransition.leave(i,e),await this.viewTransition.enter(e,i)):(i.hidden=!0,e.hidden=!1),Jt.getElementById(t).removeChild(i)}for(let t of this.meta){var i=document.createElement("meta");for(let e in t)i[e]=t[e];Jt.head.appendChild(i)}this.$static.currentView||(e.hidden=!1),Jt.title=this.title,this.$static.currentView=this.name,this.$static.currentViewMeta=this.meta}),c("static"),this.currentView="",c("static"),this.currentViewMeta=[]})})(),await(async()=>{c("ns","flair.ui"),i("ViewInterceptor",function(){c("virtual"),c("async"),this.run=K})})(),await(async()=>{c("singleton"),c("ns","flair.ui"),i("ViewState",function(){c("state"),c("private"),this.store={},this.get=((t,e)=>(t=t||"",e=e||"",this.store[t+"/"+e]||null)),this.set=((t,e,i)=>{t=t||"",e=e||"","boolean"==typeof i||i?this.store[t+"/"+e]=i:delete this.store[t+"/"+e]}),this.clear=(()=>{this.store=null})})})(),await(async()=>{c("ns","flair.ui"),i("ViewTransition",function(){c("virtual"),c("async"),this.enter=K,c("virtual"),c("async"),this.leave=K})})(),await(async()=>{const{VueComponentMembers:t}=B("flair.ui.vue");c("ns","flair.ui.vue"),i("VueComponent",[t],function(){this.factory=(async()=>{let t=this.define();return this.props&&Array.isArray(this.props)&&(t.props=this.props),this.data&&"function"==typeof this.data&&(t.data=this.data),this.name&&(t.name=this.name),this.model&&(t.model=this.model),"boolean"==typeof this.inheritAttrs&&(t.inheritAttrs=this.inheritAttrs),t}),c("protected"),this.props=null,c("protected"),this.data=null,c("protected"),this.model=null,c("protected"),this.inheritAttrs=null})})(),await(async()=>{c("ns","flair.ui.vue"),i("VueDirective",function(){c("virtual"),c("async"),this.factory=K})})(),await(async()=>{c("ns","flair.ui.vue"),i("VueFilter",function(){c("virtual"),c("async"),this.factory=K})})(),await(async()=>{c("ns","flair.ui.vue"),i("VueLayout",function(){c("protected"),this.html="",c("protected"),this.style="",c("protected"),this.viewArea="view",c("protectedSet"),this.areas=[],this.merge=(async t=>{let e=f("clientFile");this.style&&this.style.endsWith(".css")&&(this.style=await e(this.style)),this.html&&this.html.endsWith(".html")&&(this.html=await e(this.html));let i=Jt.createElement("div");if(this.style){let t=Jt.createElement("style");t.innerHTML=this.style.trim(),t.setAttribute("scoped",""),i.append(t)}if(this.html){let t=Jt.createElement("div");t.innerHTML=this.html.trim(),i.append(t)}this.viewArea=this.viewArea||"view";let a=i.content.getElementById(this.viewArea);a&&(a.innerHTML=t);let n=null;if(this.layout&&this.layout.areas&&Array.isArray(this.layout.areas))for(let t of this.layout.areas)if(n=i.content.getElementById(t.area)){let e=Jt.createElement("component");e.setAttribute("is",t.component),n.append(e)}return i.innerHTML})})})(),await(async()=>{c("ns","flair.ui.vue"),i("VueMixin",function(){c("virtual"),c("async"),this.factory=K})})(),await(async()=>{c("ns","flair.ui.vue"),i("VuePlugin",function(){this.construct=(t=>{Gt.client.vue.pluginOptions[t]&&(this.options=Object.assign({},Gt.client.vue.pluginOptions[t]))}),c("virtual"),c("async"),this.factory=K,this.options=null})})(),await(async()=>{const{Bootware:t}=B("flair.app");c("ns","flair.ui.vue"),i("VueSetup",t,function(){c("override"),this.construct=(t=>{t("Vue Setup")}),c("override"),this.boot=(async t=>{t();const e=await d("vue/vue{.min}.js"),{VueComponent:i,VueFilter:a,VueDirective:n,VuePlugin:r,VueMixin:s}=B("flair.ui.vue");let o=Gt.client.vue.plugins,l=null,c=null;for(let t of o){if(!t.name)throw q.OperationFailed(`Plugin name cannot be empty. (${t.type})`);if(!t.type)throw q.OperationFailed(`Plugin type cannot be empty. (${t.name})`);if(!(l=b(await d(t.type),r)))throw q.InvalidArgument(t.type);try{c=new l(t.name),e.use(await c.factory(),c.options||{})}catch(e){throw q.OperationFailed(`Plugin registration failed. (${t.type})`,e)}}let p=Gt.client.vue.mixins,h=null,u=null;for(let t of p){if(!t.name)throw q.OperationFailed(`Mixin name cannot be empty. (${t.type})`);if(!t.type)throw q.OperationFailed(`Mixin type cannot be empty. (${t.name})`);if(!(h=b(await d(t.type),s)))throw q.InvalidArgument(t.type);try{u=new h,e.mixin(await u.factory())}catch(e){throw q.OperationFailed(`Mixin registration failed. (${t.type})`,e)}}let f=Gt.client.vue.directives,m=null,y=null;for(let t of f){if(!t.name)throw q.OperationFailed(`Directive name cannot be empty. (${t.type})`);if(!t.type)throw q.OperationFailed(`Directive type cannot be empty. (${t.name})`);if(!(m=b(await d(t.type),n)))throw q.InvalidArgument(t.type);try{y=new m,e.directive(t.name,await y.factory())}catch(e){throw q.OperationFailed(`Directive registration failed. (${t.type})`,e)}}let v=Gt.client.vue.filters,w=null,g=null;for(let t of v){if(!t.name)throw q.OperationFailed(`Filter name cannot be empty. (${t.type})`);if(!t.type)throw q.OperationFailed(`Filter type cannot be empty. (${t.name})`);if(!(w=b(await d(t.type),a)))throw q.InvalidArgument(t.type);try{g=new w,e.filter(t.name,await g.factory())}catch(e){throw q.OperationFailed(`Filter registration failed. (${t.type})`,e)}}let $=Gt.client.vue.components,x=null,O=null;for(let t of $){if(!t.name)throw q.OperationFailed(`Component name cannot be empty. (${t.type})`);if(!t.type)throw q.OperationFailed(`Component type cannot be empty. (${t.name})`);if(!(x=b(await d(t.name),i)))throw q.InvalidArgument(t.type);try{if(O=new x,e.options.components[t.name])throw q.Duplicate(`Component already registered. (${t.name})`);e.component(t.name,await O.factory())}catch(e){throw q.OperationFailed(`Component registration failed. (${t.type})`,e)}}})})})(),await(async()=>{const{ViewHandler:t}=B("flair.ui"),{VueComponentMembers:e}=B("flair.ui.vue");c("ns","flair.ui.vue"),i("VueView",t,[e],function(){let t=!1;c("override"),this.construct=(t=>{t(Gt.client.view.el,Gt.client.view.title,Gt.client.view.transition)}),c("private"),this.factory=(async()=>{if(this.layout&&this.layout.areas&&Array.isArray(this.layout.areas)){this.components=this.components||[];for(let t of this.layout.areas)this.components.push({name:t.component,type:t.type})}let t=this.define();return t.el="#"+this.name,this.propsData&&(t.propsData=this.propsData),this.data&&"function"!=typeof this.data&&(t.data=this.data),this.layout&&(t.template=await this.layout.merge(t.template)),t}),c("protected"),c("override"),c("sealed"),this.loadView=(async(e,i,a)=>{if(!t){t=!0,e();const n=await d("vue/vue{.min}.js");await this.load(i,a),new n(await this.factory())}}),c("protected"),c("virtual"),c("async"),this.load=K,c("protected"),this.el=null,c("protected"),this.propsData=null,c("protected"),this.data=null,c("protected"),this.layout=null})})(),l.context.current().currentAssemblyBeingLoaded(""),l.registerAdo('{"name":"flair.app","file":"./flair.app{.min}.js","mainAssembly":"flair","desc":"True Object Oriented JavaScript","title":"Flair.js","version":"0.6.82","lupdate":"Mon, 13 May 2019 19:15:31 GMT","builder":{"name":"flairBuild","version":"1","format":"fasm","formatVersion":"1","contains":["init","func","type","vars","reso","asst","rout","sreg"]},"copyright":"(c) 2017-2019 Vikas Burman","license":"MIT","types":["flair.app.Bootware","flair.app.Handler","flair.app.App","flair.app.Host","flair.ui.vue.VueComponentMembers","flair.api.RestHandler","flair.api.RestInterceptor","flair.app.BootEngine","flair.app.ClientHost","flair.app.ServerHost","flair.boot.ClientRouter","flair.boot.DIContainer","flair.boot.Middlewares","flair.boot.NodeEnv","flair.boot.ResHeaders","flair.boot.ServerRouter","flair.ui.ViewHandler","flair.ui.ViewInterceptor","flair.ui.ViewState","flair.ui.ViewTransition","flair.ui.vue.VueComponent","flair.ui.vue.VueDirective","flair.ui.vue.VueFilter","flair.ui.vue.VueLayout","flair.ui.vue.VueMixin","flair.ui.vue.VuePlugin","flair.ui.vue.VueSetup","flair.ui.vue.VueView"],"resources":[],"assets":[],"routes":[]}'),Object.freeze({name:"flair.app",settings:Gt,config:Qt})});