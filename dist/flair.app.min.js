/**
 * @preserve
 * Flair.js
 * True Object Oriented JavaScript
 * 
 * Assembly: flair.app
 *     File: ./flair.app.js
 *  Version: 0.50.45
 *  Sun, 05 May 2019 02:38:39 GMT
 * 
 * (c) 2017-2019 Vikas Burman
 * Licensed under MIT
 */
(()=>{"use strict";const t=void 0!==!0?require("flairjs"):(!0).flair,{Class:e,Struct:i,Enum:r,Interface:a,Mixin:s,Aspects:o,AppDomain:n,$$:c,attr:l,bring:p,Container:f,include:u,Port:d,on:h,post:y,telemetry:$,Reflector:v,Serializer:m,Tasks:w,as:g,is:b,isComplies:S,isDerivedFrom:A,isAbstract:O,isSealed:I,isStatic:k,isSingleton:E,isDeprecated:B,isImplements:D,isInstanceOf:M,isMixed:j,getAssembly:C,getAttr:T,getContext:x,getResource:P,getRoute:W,getType:z,ns:H,getTypeOf:F,getTypeName:L,typeOf:R,dispose:V,using:J,Args:N,Exception:U,noop:_,nip:q,nim:G,nie:K,event:Q}=t,{TaskInfo:X}=t.Tasks,{env:Y}=t.options,Z=Y.isServer||Y.isWorker?null:(!0).document,{forEachAsync:tt,replaceAll:et,splitAndTrim:it,findIndexByProp:rt,findItemByProp:at,which:st,guid:ot,isArrowFunc:nt,isASyncFunc:ct,sieve:lt,b64EncodeUnicode:pt,b64DecodeUnicode:ft}=t.utils,{$$static:ut,$$abstract:dt,$$virtual:ht,$$override:yt,$$sealed:$t,$$private:vt,$$privateSet:mt,$$protected:wt,$$protectedSet:gt,$$readonly:bt,$$async:St,$$overload:At,$$enumerate:Ot,$$dispose:It,$$post:kt,$$on:Et,$$timer:Bt,$$type:Dt,$$args:Mt,$$inject:jt,$$resource:Ct,$$asset:Tt,$$singleton:xt,$$serialize:Pt,$$deprecate:Wt,$$session:zt,$$state:Ht,$$conditional:Ft,$$noserialize:Lt,$$ns:Rt}=c,Vt=n.context.current().name;let Jt=Y.isServer?__filename:(!0).document.currentScript.src.replace((!0).document.location.href,"./"),Nt=Jt.substr(0,Jt.lastIndexOf("/")+1);n.loadPathOf("flair.app",Nt);const Ut=t=>{n.onError(t)};let _t=JSON.parse('{"host":"flair.app.ServerHost | flair.app.ClientHost","app":"flair.app.App","load":[],"container":{}}'),qt=t.Port("settingsReader");if("function"==typeof qt){let t=qt("flair.app");t&&(_t=Object.assign(_t,t))}_t=Object.freeze(_t);let Gt={};Gt=Object.freeze(Gt);let Kt=()=>{};n.context.current().currentAssemblyBeingLoaded("./flair.app{.min}.js");try{(async()=>{try{c("abstract"),c("ns","flair.app"),e("Bootware",function(){c("virtual"),this.construct=((t,e,i)=>{let r=N("name: string, version: string","name: string, version: string, isMountSpecific: boolean","name: string, isMountSpecific: boolean","name: string")(t,e,i);r.throwOnError(this.construct),this.info=Object.freeze({name:r.values.name||"",version:r.values.version||"",isMountSpecific:r.values.isMountSpecific||!1})}),c("virtual"),c("async"),this.boot=_,c("readonly"),this.info=null,c("virtual"),c("async"),this.ready=_,c("virtual"),this.dispose=_})}catch(t){Ut(t)}})(),(async()=>{try{const{IDisposable:t}=H();c("ns","flair.app"),e("Handler",[t],function(){c("virtual"),this.construct=(()=>{}),c("virtual"),this.dispose=(()=>{})})}catch(t){Ut(t)}})(),(async()=>{try{const{IDisposable:t}=H(),{Bootware:i}=H("flair.app");c("ns","flair.app"),e("App",i,[t],function(){c("override"),this.construct=(t=>{let e=C(this);t(e.title,e.version)}),c("override"),this.boot=(async t=>{t(),n.host().error.add(this.onError)}),c("virtual"),this.start=(async()=>{if(!Y.isServer&&!Y.isWorker){const{ViewState:t}=H("flair.ui");new t}}),c("virtual"),this.stop=(async()=>{if(!Y.isServer&&!Y.isWorker){const{ViewState:t}=H("flair.ui");(new t).clear()}}),c("virtual"),this.onError=(t=>{throw U.OperationFailed(t.error,this.onError)}),c("override"),this.dispose=(()=>{n.host().error.remove(this.onError)})})}catch(t){Ut(t)}})(),(async()=>{try{const{IDisposable:t}=H(),{Bootware:i}=H("flair.app");c("ns","flair.app"),e("Host",i,[t],function(){c("privateSet"),this.isStarted=!1,c("virtual"),this.start=(async()=>{this.isStarted=!0}),c("virtual"),this.stop=(async()=>{this.isStarted=!1}),this.restart=(async()=>{await this.stop(),await this.start()}),this.error=Q(t=>({error:t})),this.raiseError=(t=>{this.error(t)})})}catch(t){Ut(t)}})(),(async()=>{try{const{Bootware:t}=H("flair.app");c("static"),c("ns","flair.app"),e("BootEngine",function(){this.start=async function(){let e=[],i=[];const r=async()=>{let r=null,a=null,s=null;for(let o of _t.load)(o=st(o))&&(r=await u(o))&&"boolean"!=typeof r&&(a=g(r,t))&&(s=new a,e.push(s),s.info.isMountSpecific&&i.push(s))},a=async t=>{if(Y.isWorker){0!==i.length&&console.warn("Mount specific bootwares are not supported for worker environment. Revisit worker:flair.app->load setting.");for(let i of e)i.info.isMountSpecific||await i[t]()}else{let r=n.host().mounts,a=Object.keys(r),s="",o=null;o=r[s="main"];for(let i of e)await i[t](o);for(let e of a)if("main"!==e){o=r[e];for(let e of i)await e[t](o)}}},s=async()=>{if(!Y.isWorker){let e=st(_t.host),i=g(await u(e),t),r=null;if(!i)throw U.InvalidDefinition(e,this.start);r=new i,await r.boot(),n.host(r)}await a("boot");let e=st(_t.app),i=g(await u(e),t),r=null;if(!i)throw U.InvalidDefinition(e,this.start);r=new i,await r.boot(),n.app(r)},o=async()=>{Y.isWorker||await n.host().start(),await n.app().start()},c=()=>new Promise((t,e)=>{"loading"!==document.readyState?t():(!0).document.addEventListener("DOMContentLoaded",()=>{t()})}),l=()=>new Promise((t,e)=>{(!0).document.addEventListener("deviceready",()=>{t()},!1)}),p=async()=>{Y.isClient&&!Y.isWorker&&(await c(),Y.isCordova&&await l()),Y.isWorker||await n.host().ready(),await a("ready"),await n.app().ready()};await r(),await s(),await o(),await p(),console.log("ready!")}})}catch(t){Ut(t)}})(),(async()=>{try{const{Bootware:t}=H("flair.app");c("sealed"),c("ns","flair.boot"),e("DIContainer",t,function(){c("override"),this.construct=(t=>{t("DI Container")}),c("override"),this.boot=(async()=>{let t=_t.container;for(let e in t)t.hasOwnProperty(e)&&f.register(e,t[e])})})}catch(t){Ut(t)}})()}catch(t){Ut(t)}n.context.current().currentAssemblyBeingLoaded(""),n.registerAdo('{"name":"flair.app","file":"./flair.app{.min}.js","mainAssembly":"flair","desc":"True Object Oriented JavaScript","title":"Flair.js","version":"0.50.45","lupdate":"Sun, 05 May 2019 02:38:39 GMT","builder":{"name":"<<name>>","version":"<<version>>","format":"fasm","formatVersion":"1","contains":["initializer","functions","types","enclosureVars","enclosedTypes","resources","assets","routes","selfreg"]},"copyright":"(c) 2017-2019 Vikas Burman","license":"MIT","types":["flair.app.Bootware","flair.app.Handler","flair.app.App","flair.app.Host","flair.app.BootEngine","flair.boot.DIContainer"],"resources":[],"assets":[],"routes":[]}'),"function"==typeof Kt&&(Kt(),Kt=_)})();