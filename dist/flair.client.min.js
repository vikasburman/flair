/**
 * @preserve
 * Flair.js
 * True Object Oriented JavaScript
 * 
 * Assembly: flair.client
 *     File: ./flair.client.js
 *  Version: 0.51.67
 *  Tue, 07 May 2019 00:06:47 GMT
 * 
 * (c) 2017-2019 Vikas Burman
 * MIT
 */
!function(e,t){"use strict";"function"==typeof!0&&(!0).amd?(!0)(t):"object"==typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=t),module.exports=exports=t):e["flair.client"]=t}(this,async function(){"use strict";const e=void 0!==!0?require("flairjs"):(!0).flair,{Class:t,Struct:i,Enum:s,Interface:n,Mixin:r,Aspects:a,AppDomain:o,$$:l,attr:c,bring:d,Container:u,include:h,Port:p,on:f,post:m,telemetry:$,Reflector:v,Serializer:y,Tasks:w,as:b,is:g,isComplies:T,isDerivedFrom:x,isAbstract:S,isSealed:V,isStatic:I,isSingleton:A,isDeprecated:C,isImplements:O,isInstanceOf:j,isMixed:E,getAssembly:B,getAttr:k,getContext:R,getResource:z,getRoute:H,getType:L,ns:M,getTypeOf:P,getTypeName:D,typeOf:F,dispose:J,using:N,Args:U,Exception:_,noop:q,nip:W,nim:G,nie:K,event:Q}=e,{TaskInfo:X}=e.Tasks,{env:Y}=e.options,{forEachAsync:Z,replaceAll:ee,splitAndTrim:te,findIndexByProp:ie,findItemByProp:se,which:ne,guid:re,isArrowFunc:ae,isASyncFunc:oe,sieve:le,b64EncodeUnicode:ce,b64DecodeUnicode:de}=e.utils,{$$static:ue,$$abstract:he,$$virtual:pe,$$override:fe,$$sealed:me,$$private:$e,$$privateSet:ve,$$protected:ye,$$protectedSet:we,$$readonly:be,$$async:ge,$$overload:Te,$$enumerate:xe,$$dispose:Se,$$post:Ve,$$on:Ie,$$timer:Ae,$$type:Ce,$$args:Oe,$$inject:je,$$resource:Ee,$$asset:Be,$$singleton:ke,$$serialize:Re,$$deprecate:ze,$$session:He,$$state:Le,$$conditional:Me,$$noserialize:Pe,$$ns:De}=l,Fe=Y.isServer||Y.isWorker?null:(!0).document,Je=o.context.current().name,Ne=Y.isServer?__filename:(!0).document.currentScript.src.replace((!0).document.location.href,"./"),Ue=Ne.substr(0,Ne.lastIndexOf("/")+1);o.loadPathOf("flair.client",Ue);let _e=JSON.parse('{"el":"main","title":"","viewTransition":"","components":[],"transitions":[],"filters":[],"mixins":[],"directives":[],"plugins":[],"pluginOptions":{},"url":{"404":"/404","home":"/"},"mounts":{"main":"/"},"main-options":[],"main-interceptors":[]}'),qe=e.Port("settingsReader");if("function"==typeof qe){let e=qe("flair.client");e&&(_e=Object.assign(_e,e))}_e=Object.freeze(_e);let We=JSON.parse("{}");We=Object.freeze(We),o.context.current().currentAssemblyBeingLoaded("./flair.client{.min}.js"),await(async()=>{l("ns","flair.ui"),t("ViewTransition",function(){l("virtual"),l("async"),this.enter=q,l("virtual"),l("async"),this.leave=q})})(),await(async()=>{const{Host:e}=M("flair.app");l("sealed"),l("ns","flair.app"),t("ClientHost",e,function(){let e={},t=(!0).page,i=null;l("override"),this.construct=(e=>{e("Page","1.x")}),this.app=(()=>this.mounts["main"]),this.mounts={get:()=>e,set:q},l("override"),this.boot=(async i=>{i();let s=null,n="",r=null;const a=e=>{let t={},i=_e[`${e}-options`];if(i&&i.length>0)for(let e of i)t[e.name]=e.value;return t.click=!1,t.popstate=!1,t.dispatch=!1,t.hashbang=!1,t.decodeURLComponents=!0,t};s=a("main");let o=t(s);o.strict(s.strict),o.base("/");for(let i of Object.keys(_e.mounts))"main"===i?(n="/",r=o):(s=a(i),n=_e.mounts[i],(r=t.create(s)).strict(s.strict),r.base(n)),e[i]=Object.freeze({name:i,root:n,app:r});e=Object.freeze(e)}),l("override"),this.start=(async e=>{e(),i=(()=>{let e=(!0).location.hash;"#!/"===e.substr(0,3)&&(e=e.substr(3)),"#!"===e.substr(0,2)&&(e=e.substr(2)),"#/"===e.substr(0,2)&&(e=e.substr(2)),"#"===e.substr(0,1)&&(e=e.substr(1));let t=null,i="";for(let s of this.mounts)if(e.startsWith(s.root)){t=s.app,e=e.substr(s.root.length),i=s;break}t||(i="main",t=this.mounts[i]),"/"!==e.substr(0,1)&&(e="/"+e),setTimeout(()=>{try{t(e)}catch(e){this.error(e)}},0)})}),l("override"),this.ready=(async e=>{e(),(!0).addEventListener("hashchange",i),this.app.redirect(_e.url.home),console.log(`${o.app().info.name}, v${o.app().info.version}`)}),l("override"),this.stop=(async e=>{e(),(!0).removeEventListener("hashchange",i)}),l("override"),this.dispose=(t=>{t(),e=null})})})(),await(async()=>{const{Bootware:e}=M("flair.app"),{ViewHandler:i,ViewInterceptor:s}=M("flair.ui");l("sealed"),l("ns","flair.boot"),t("ClientRouter",e,function(){let e=null;l("override"),this.construct=(e=>{e("Client Router",!0)}),l("override"),this.boot=(async(t,n)=>{t(),e||(e=o.context.current().allRoutes(!0)).sort((e,t)=>e.index<t.index?-1:e.index>t.index?1:0);const r=(e,t)=>new Promise((i,s)=>{try{let n;(new e).run(t).then(()=>{t.$stop?s():i()}).catch(s)}catch(e){s(e)}}),a=(e,t)=>Z(e,(e,i,n)=>{h(n).then(a=>{let o=b(a,s);o?r(o,t).then(e).catch(i):i(_.InvalidDefinition(`Invalid interceptor type. (${n})`))}).catch(i)});let l="view";for(let t of e)t.mount===n.name&&n.app(t.path,e=>{const s=e=>{o.host().raiseError(e)},r=e=>{n.app.redirect(e)},c=()=>{h(t.handler).then(n=>{let a=b(n,i);if(a)try{N(new a,t=>{t[l](e).then(()=>{e.handled=!0,e.$redirect&&r(e.$redirect)}).catch(s)})}catch(e){s(e)}else s(_.InvalidDefinition(`Invalid route handler. (${t.handler})`))}).catch(s)};e.$stop=!1,e.$redirect="";let d=_e[`${n.name}-interceptors`]||[];a(d,e).then(()=>{e.$stop?(e.handled=!0,e.$redirect&&r(e.$redirect)):c()}).catch(t=>{e.$stop?(e.handled=!0,e.$redirect&&r(e.$redirect)):s(t)})});n.app("*",e=>{let t=_e.url["404"];t?(e.handled=!0,n.app.redirect(t)):(!0).history.back()})})})})(),await(async()=>{const{Handler:e}=M("flair.app"),{ViewTransition:i}=M("flair.ui");l("ns","flair.ui"),t("ViewHandler",e,function(){let e="";l("override"),this.construct=((t,i,s,n)=>{t(),e=i||"main",this.viewTransition=n,this.title=this.title+(s?" - "+s:"")}),l("privateSet"),this.viewTransition="",l("protectedSet"),this.name="",l("protectedSet"),this.title="",l("protectedSet"),this.meta=null,this.view=(async t=>{if(this.name=this.name||this.$self.id+"_"+re(),this.viewTransition){let e=b(await h(this.viewTransition),i);this.viewTransition=e?new e:""}let s=Fe.createElement("div"),n=Fe.getElementById(e);s.id=this.name,s.setAttribute("hidden",""),n.appendChild(s),this.load(t,s),await this.swap()}),l("protected"),l("virtual"),l("async"),this.loadView=q,l("private"),this.swap=(async()=>{let t=Fe.getElementById(this.name);if(this.$static.currentView){let i=Fe.getElementById(this.$static.currentView),s;for(let e of this.meta)Fe.head.removeChild(Fe.querySelector('meta[name="'+e+'"]'));this.viewTransition?(await this.viewTransition.leave(i,t),await this.viewTransition.enter(t,i)):(i.hidden=!0,t.hidden=!1),Fe.getElementById(e).removeChild(i)}for(let e of this.meta){var i=document.createElement("meta");for(let t in e)i[t]=e[t];Fe.head.appendChild(i)}this.$static.currentView||(t.hidden=!1),Fe.title=this.title,this.$static.currentView=this.name,this.$static.currentViewMeta=this.meta}),l("static"),this.currentView="",l("static"),this.currentViewMeta=[]})})(),await(async()=>{l("ns","flair.ui"),t("ViewInterceptor",function(){l("virtual"),l("async"),this.run=q})})(),await(async()=>{l("singleton"),l("ns","flair.ui"),t("ViewState",function(){l("state"),l("private"),this.store={},this.get=((e,t)=>(e=e||"",t=t||"",this.store[e+"/"+t]||null)),this.set=((e,t,i)=>{e=e||"",t=t||"","boolean"==typeof i||i?this.store[e+"/"+t]=i:delete this.store[e+"/"+t]}),this.clear=(()=>{this.store=null})})})(),o.context.current().currentAssemblyBeingLoaded(""),o.registerAdo('{"name":"flair.client","file":"./flair.client{.min}.js","mainAssembly":"flair","desc":"True Object Oriented JavaScript","title":"Flair.js","version":"0.51.67","lupdate":"Tue, 07 May 2019 00:06:47 GMT","builder":{"name":"flairBuild","version":"1","format":"fasm","formatVersion":"1","contains":["init","func","type","vars","reso","asst","rout","sreg"]},"copyright":"(c) 2017-2019 Vikas Burman","license":"MIT","types":["flair.ui.ViewTransition","flair.app.ClientHost","flair.boot.ClientRouter","flair.ui.ViewHandler","flair.ui.ViewInterceptor","flair.ui.ViewState"],"resources":[],"assets":[],"routes":[]}'),"function"==typeof onLoadComplete&&onLoadComplete()});