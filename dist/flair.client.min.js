/**
 * @preserve
 * Flair.js
 * True Object Oriented JavaScript
 * 
 * Assembly: flair.client
 *     File: ./flair.client.js
 *  Version: 0.17.11
 *  Sun, 17 Mar 2019 01:31:02 GMT
 * 
 * (c) 2017-2019 Vikas Burman
 * Licensed under MIT
 */
(()=>{"use strict";const e=void 0!==!0?require("flair"):"undefined"!=typeof WorkerGlobalScope?WorkerGlobalScope.flair:(!0).flair,{Class:t,Struct:s,Enum:r,Interface:i,Mixin:n}=e,{Aspects:o}=e,{AppDomain:a}=e,l=e.AppDomain.context.current().name,{$$:c,attr:p}=e,{bring:u,Container:d,include:f}=e,{Port:m}=e,{on:h,post:v,telemetry:b}=e,{Reflector:y}=e,{Serializer:g}=e,{Tasks:$}=e,{TaskInfo:A}=e.Tasks,{as:x,is:O,isComplies:S,isDerivedFrom:k,isImplements:T,isInstanceOf:j,isMixed:w}=e,{getAssembly:C,getAttr:R,getContext:z,getResource:D,getRoute:I,getType:B,ns:E,getTypeOf:P,typeOf:F}=e,{dispose:L,using:M}=e,{Args:W,Exception:G,noop:U,nip:V,nim:H,nie:J,event:q}=e,{env:N}=e.options,{forEachAsync:K,replaceAll:Q,splitAndTrim:X,findIndexByProp:Y,findItemByProp:Z,which:_,isArrowFunc:ee,isASyncFunc:te,sieve:se,b64EncodeUnicode:re,b64DecodeUnicode:ie}=e.utils,{$static:ne,$abstract:oe,$virtual:ae,$override:le,$sealed:ce,$private:pe,$privateSet:ue,$protected:de,$protectedSet:fe,$readonly:me,$async:he}=c,{$enumerate:ve,$dispose:be,$post:ye,$on:ge,$timer:$e,$type:Ae,$args:xe,$inject:Oe,$resource:Se,$asset:ke,$singleton:Te,$serialize:je,$deprecate:we,$session:Ce,$state:Re,$conditional:ze,$noserialize:De,$ns:Ie}=c;let Be=JSON.parse('{"mounts":{"main":"/"},"main-appSettings":[{"name":"strict","value":false},{"name":"click","value":false},{"name":"popstate","value":false},{"name":"dispatch","value":false},{"name":"hashbang","value":false},{"name":"decodeURLComponents","value":true}],"main-middlewares":[]}'),Ee=e.Port("settingsReader");if("function"==typeof Ee){let e=Ee("flair.client");e&&(Be=Object.assign(Be,e))}Be=Object.freeze(Be),e.AppDomain.context.current().currentAssemblyBeingLoaded("./flair.client{.min}.js"),(async()=>{const{Bootware:e}=E();c("sealed"),c("ns","flair.bw.client"),t("Router",e,function(){let e=null;c("override"),this.construct=(e=>{e("Client Router",!0)}),c("override"),this.boot=(async t=>{e||(e=a.context.current().allRoutes(!0)).sort((e,t)=>e.index<t.index?-1:e.index>t.index?1:0);let s=null,r=!1;for(let i of e)i.mount===t.name&&t.app(i.path,(e,t)=>{const n=e=>{e||t()},o=e=>{throw G.OperationFailed(e,s[i.verb])};s=new i.Handler;try{"function"==typeof(r=s[i.verb](e)).then?r.then(e=>{n(e)}).catch(o):n(r)}catch(e){o(e)}})})})})(),(async()=>{const{App:e}=E("flair.boot");c("ns","flair.client"),t("App",e,function(){c("override"),this.construct=(()=>{}),c("override"),this.boot=(async()=>{}),c("override"),this.start=(async()=>{}),c("override"),this.stop=(async()=>{}),c("override"),this.ready=(async()=>{}),c("override"),this.dispose=(()=>{})})})(),(async()=>{const e=await f("[Page]","page"),{ClientHost:s}=E("flair.boot");c("sealed"),c("ns","flair.client"),t("Client",s,function(){let t={},s=null;c("override"),this.construct=(e=>{e("Page","1.x")}),this.mounts={get:()=>t,set:U},c("override"),this.boot=(async s=>{s();let r=null,i="",n=null;const o=e=>{let t={},s=Be[`${e}-appSettings`];if(s&&s.length>0)for(let e of s)t[e.name]=e.value;return t};r=o("main");let a=e.create(r);a.strict(r.strict),a.base("/");for(let s of Object.keys(Be.mounts))"main"===s?(i="/",n=a):(r=o(s),i=Be.mounts[s],(n=e.create(r)).strict(r.strict),n.base(i)),t[s]=Object.freeze({name:s,root:i,app:n});t=Object.freeze(t)}),c("override"),this.start=(async e=>{e(),s=(()=>{let e=N.global.location.hash;"#!/"===e.substr(0,3)&&(e=e.substr(3)),"#!"===e.substr(0,2)&&(e=e.substr(2)),"#/"===e.substr(0,2)&&(e=e.substr(2)),"#"===e.substr(0,1)&&(e=e.substr(1));let t=null;for(let s of this.mounts)if(e.startsWith(s.root)){t=s.app,e=e.substr(s.root.length);break}t||(t=this.mounts["main"]),setTimeout(()=>{t(e)},0)}),N.global.addEventListener("hashchange",s)}),c("override"),this.stop=(async e=>{e(),N.global.removeEventListener("hashchange",s)}),c("override"),this.ready=(async e=>{e()}),c("override"),this.dispose=(e=>{e(),t=null})})})(),(async()=>{const{App:e}=E("flair.boot");c("ns","flair.client"),t("WorkerApp",e,function(){c("override"),this.construct=(()=>{}),c("override"),this.boot=(async()=>{}),c("override"),this.start=(async()=>{}),c("override"),this.stop=(async()=>{}),c("override"),this.ready=(async()=>{}),c("override"),this.dispose=(()=>{})})})(),e.AppDomain.context.current().currentAssemblyBeingLoaded(""),e.AppDomain.registerAdo('{"name":"flair.client","file":"./flair.client{.min}.js","desc":"True Object Oriented JavaScript","title":"Flair.js","version":"0.17.11","lupdate":"Sun, 17 Mar 2019 01:31:02 GMT","builder":{"name":"<<name>>","version":"<<version>>","format":"fasm","formatVersion":"1","contains":["initializer","types","enclosureVars","enclosedTypes","resources","assets","routes","selfreg"]},"copyright":"(c) 2017-2019 Vikas Burman","license":"MIT","types":["flair.bw.client.Router","flair.client.App","flair.client.Client","flair.client.WorkerApp"],"resources":[],"assets":[],"routes":[]}')})();
//# sourceMappingURL=./flair.client.min.js.map