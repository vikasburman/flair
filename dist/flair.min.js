/**
 * FlairJS
 * True Object Oriented JavaScript
 * Version 0.15.27
 * Thu, 17 Jan 2019 23:19:04 GMT
 * (c) 2017-2019 Vikas Burman
 * MIT
 * https://flairjs.com
 */
(function(e){"use strict";new Function("try {return this===global;}catch(e){return false;}")()&&(e.build=require("./flair.build.js")),"function"==typeof define&&define.amd?define(function(){return e}):"object"==typeof exports?(void 0!==module&&module.exports&&(exports=module.exports=e),exports.flair=e,module.exports=exports=e):this===!0&&(this.flair=e)}).call(this,e=>{"use strict";if(this.flair&&"function"!=typeof this.flair)return this.flair;let n=new Function("try {return this===global;}catch(e){return false;}")(),t=new Function("try {return (this===global ? global : window);}catch(e){return window;}");"string"==typeof e&&(e={symbols:e.split(",").map(e=>e.trim())});const r=()=>{return"_xxxxxxxx_xxxx_4xxx_yxxx_xxxxxxxxxxxx".replace(/[xy]/g,e=>{var n=16*Math.random()|0,t="x"==e?n:3&n|8;return t.toString(16)})},i=(e,n,t,i={})=>{if(!n||"string"!=typeof n)throw`000000: Invalid type name ${n}.`;let s=i;return s.name=n,s.type=e,s.namespace=null,s.assembly=(()=>{return u.Assembly.get(n)||null}),s.id=r(),s.__={},t._=s,u.Namespace(t),t._=Object.freeze(t._),Object.freeze(t)},s=(e,n,t={})=>{let i=t;return i.type=e,i.id=r(),i.__={},n._=i,n._=Object.freeze(n._),Object.freeze(n)};let u={},o=()=>{},c=e.symbols||[],f=(e,n)=>{e()},a=Object.freeze({symbols:Object.freeze(c),env:Object.freeze({type:e.env||(n?"server":"client"),isServer:n,isClient:!n,isProd:c.indexOf("PROD")!==-1,isDebug:c.indexOf("DEBUG")!==-1,global:t(),supressGlobals:"undefined"!=typeof e.supressGlobals&&e.supressGlobals,args:n?process.argv:new URLSearchParams(location.search)}),loaders:Object.freeze({module:Object.freeze({server:e.moduleLoaderServer||null,client:e.moduleLoaderClient||null}),file:Object.freeze({server:e.fileLoaderServer||null,client:e.fileLoaderClient||null}),define:(e,n)=>{let t=u.options.loaderOverrides;switch(e){case"sm":t.moduleLoaderServer=t.moduleLoaderServer||n;break;case"cm":t.moduleLoaderClient=t.moduleLoaderClient||n;break;case"sf":t.fileLoaderServer=t.fileLoaderServer||n;break;case"cf":t.fileLoaderClient=t.fileLoaderClient||n}}}),loaderOverrides:{moduleLoaderServer:null,moduleLoaderClient:null,fileLoaderServer:null,fileLoaderClient:null}});if(a.env.isProd&&a.env.isDebug)throw`DEBUG and PROD symbols are mutually exclusive. Use only one.`;u._=Object.freeze({name:"FlairJS",version:"0.15.27",copyright:"(c) 2017-2019 Vikas Burman",license:"MIT",link:"https://flairjs.com",lupdate:new Date("Thu, 17 Jan 2019 23:19:04 GMT")}),u.info=u._,u.options=a,u.Exception=function(e,n,t){let r={};return r.code=e||"",r.message=n||"",r.error=t||null,Object.freeze(r)};let l={},p={};u.Assembly=(e=>{if("object"!=typeof e||Array.isArray(e.types)||Array.isArray(e.assets))throw`Not an assembly definition object.`;let n=u.which(e.file,!0),t={name:()=>{return e.name},file:()=>{return n},desc:()=>{return e.desc},version:()=>{return e.version},copyright:()=>{return e.copyright},license:()=>{return e.license},isLoaded:()=>{return t._.isLoaded},types:()=>{return e.types.slice()},settings:()=>{return Object.freeze(e.settings)},assets:()=>{return e.assets.slice()},hasAssets:()=>{return e.assets.length>0},load:()=>{return u.Assembly.load(n)}};return t._={name:e.name,type:"assembly",namespace:null,ado:Object.freeze(e),isLoaded:!1,markLoaded:()=>{t._.isLoaded=!0}},u.Namespace(t),Object.freeze(t)}),u.Assembly.register=((...e)=>{for(let n of e){let e=u.Assembly(n);if(e){let n=e.file();if(l[n])throw`Assembly ${n} already registered.`;l[n]=e;for(let t of e.types()){if(p[t])throw`Type ${t} defined in assembly ${e.name} is already registered.`;p[t]=e}}}}),u.Assembly.load=(e=>{if(u.Assembly.isRegistered(e))return new Promise((t,r)=>{if(l[e].isLoaded())t();else if(n)try{require(e),l[e]._.markLoaded(),t()}catch(e){r(e)}else{const n=u.options.env.global.document.createElement("script");n.onload=(()=>{l[e]._.markLoaded(),t()}),n.onerror=(e=>{r(e)}),n.async=!0,n.src=e,u.options.env.global.document.body.appendChild(n)}});throw`Assembly ${e} must be registered first.`}),u.Assembly.isRegistered=(e=>{return"undefined"!=typeof l[e]}),u.Assembly.isLoaded=(e=>{return"undefined"!=typeof l[e]&&l[e].isLoaded()}),u.Assembly.get=(e=>{return p[e]||null}),u.Assembly.all=(()=>{return Object.freeze(l)}),u.Assembly.allTypes=(()=>{return Object.freeze(p)}),u.Namespace=(e=>{if(["class","enum","interface","mixin","resource","structure","proc"].indexOf(e._.type)===-1)throw`Type (${e._.type}) cannot be placed in a namespace.`;if(e._.namespace)throw`Type (${e._.name}) is already contained in a namespace.`;let n=!1;e._.name.startsWith("~")&&(e._.name=e._.name.substr(1),n=!0);let t=u.Namespace.root,r=e._.name,i="",s=null,o=r.substr(0,r.lastIndexOf("."));if(r=r.substr(r.lastIndexOf(".")+1),o){s=o.split(".");for(let n of s)if(n){if("_"===n)throw`Special name "_" is used as namespace in ${e._.name}.`;if(t[n]=t[n]||{},i=n,t[n]._&&"namespace"!==t[n]._.type)throw`${e._.name} cannot be contained in another type (${t[n]._.name})`;t=t[n]}}else if(!n)return;if(t[r])throw`Type ${r} already contained at ${o}.`;t[r]=e,e._.namespace=t,t._=t._||{},t._.name=t._.name||i,t._.type=t._.type||"namespace",t._.types=t._.types||[],t._.types.push(e);let c=()=>{return t._.types.slice()},f=e=>{let n=null,r=t;if(e.indexOf(".")!==-1){let t=e.split(".");for(let i of t)if(i){if("_"===i)throw`Special name "_" is used as name in ${e}.`;if(r=r[i],!r)break}n=r}else n=r[e];return n&&n._&&["class","enum","interface","mixin","resource","structure","proc"].indexOf(n._.type)!==-1?n:null},a=(e,...n)=>{let r=t.getType(e);if(r&&"class"!=r._.type)throw`${name} is not a class.`;return r?new r(...n):null};t.getTypes=t.getTypes||c,t.getType=t.getType||f,t.createInstance=t.createInstance||a}),u.Namespace.root={},u.Namespace.getType=(e=>{return u.Namespace.root.getType?u.Namespace.root.getType(e):null}),u.Namespace.getTypes=(()=>{return u.Namespace.root.getTypes?u.Namespace.root.getTypes():[]}),u.Namespace.createInstance=((e,...n)=>{return u.Namespace.root.createInstance?u.Namespace.root.createInstance(e,...n):null}),u.Class=((e,n,t,r)=>{let i=e,s=null,c=[],l=[],p=null;"function"==typeof t?(p=t,Array.isArray(n)?c=n:s=n):"function"==typeof r?(s=n,c=t,p=r):"function"==typeof n&&(p=n);let d=[];for(let m of c)switch(m._.type){case"mixin":d.push(m);break;case"interface":l.push(m)}c=d;let _=function(e,n,...t){let r=_._.inherits,d={},m={},b=null,y=[],h={},g={},w=[],x=[],O=!1,v=null,A="__flag__",j=null;if(b=_._.singleInstance())return b;if(e&&e===A?(v=n,O=!0,x=t):(v=_._.static,"undefined"!=typeof e?(x=x.concat([e]),"undefined"!=typeof n&&(x=x.concat([n]),"undefined"!=typeof t&&(x=x.concat(t)))):x=t),r&&(d=new r(A,v,...x),r._.isSealed()||r._.isSingleton()))throw`${i} cannot inherit from a sealed/singleton class ${r._.name}.`;const k=()=>{return"_xxxxxxxx_xxxx_4xxx_yxxx_xxxxxxxxxxxx".replace(/[xy]/g,e=>{var n=16*Math.random()|0,t="x"==e?n:3&n|8;return t.toString(16)})},S=()=>{return B("singleton",h._constructor)},I=()=>{return B("abstract",h._constructor)},z=e=>{return["constructor","dispose","_constructor","_dispose","_"].indexOf(e)!==-1},C=e=>{return"undefined"!=typeof h[e]},M=e=>{return!C(e)&&d._.instanceOf.findIndex(n=>{return!!n.meta[e]})!==-1},E=e=>{let n="";if("undefined"!=typeof h[e])n=h[e].type;else for(let t of d._.instanceOf)if(t.meta[e]){n=t.meta[e].type;break}return n},P=e=>{return B("sealed",h[e])},N=e=>{return B("static",h[e])},T=e=>{return B("private",h[e])},L=e=>{return B("hide",h[e])},D=e=>{return H("protected",e)},R=e=>{return H("serialize",e)},F=e=>{let n=!0,t=h[e],r="";if(t)for(let i of t)if("conditional"===i.name){switch(n=!1,r=i.args&&i.args.length>0?i.args[0]:""){case"server":n=a.env.isServer===!0;break;case"client":n=a.env.isServer===!1;break;default:n=a.symbols.indexOf(r)!==-1}break}return n},J=e=>{Object.defineProperty(m,e,Object.getOwnPropertyDescriptor(d,e))},U=e=>{return!e.hasOwnProperty("prototype")},V=(e,...n)=>{let t=null;"string"==typeof e?t=u.Container.get(e)[0]:(t=e,e=t._.name),y.push({name:e,Attr:t,args:n})},G=(e,n)=>{let t=null;for(let r of d._.instanceOf)if(r.meta[n]){for(let i of r.meta[n])if(i.name===e){t=i.args;break}if(t)break}return null!==t?t:[]},W=e=>{let n=null,t=h[e].type,r=null,i=null,s=null;for(let u of h[e])if(n=u.Attr,n&&(r=u.args||[],i=new n(...r),s=i.decorator(),"function"==typeof s)){let n=Object.getOwnPropertyDescriptor(d,e);s(d,t,e,n),Object.defineProperty(d,e,n)}},B=(e,n)=>{let t=!1;return n&&(t=n.findIndex(n=>{return n.name===e})!==-1),t},H=(e,n)=>{return d._.instanceOf.findIndex(t=>{return!!t.meta[n]&&B(e,t.meta[n])})!==-1},K=e=>{let n=!1,t=d._.instanceOf.length,r=1;for(let i of d._.instanceOf){if(i.meta[e]&&r!==t){n=!0;break}r++}return n},$=(e,n)=>{let t=d[e],r=[],s=[],u=[],o=null,c=null;for(let f of n)o=new f,c=o.before(),"function"==typeof c&&r.push(c),c=o.around(),"function"==typeof c&&u.push(c),c=o.after(),"function"==typeof c&&s.push(c);u.length>0&&u.reverse();let a=function(...n){let o=null,c=null,f={obj:()=>{return d},className:()=>{return i},funcName:()=>{return e},error:e=>{return e&&(o=e),o},result:e=>{return"undefined"!=typeof e&&(c=e),c},args:()=>{return n},data:{}};for(let a of r)try{a(f)}catch(e){o=e}const l=e=>{for(let n of s)try{n(e)}catch(e){f.error(e)}};let p=t,m=!1,_=null;for(let b of u)p=b(f,p);try{_=p(...n),_&&"function"==typeof _.then?(m=!0,f.result(new Promise((e,n)=>{_.then(n=>{f.result(n),l(f),e(f.result())}).catch(e=>{f.error(e),l(f),n(f.error())})}))):(f.result(_),l(f))}catch(e){f.error(e)}return f.result()}.bind(d);return a},q=()=>{if(["Attribute","Aspect"].indexOf(i)===-1&&!d._.isInstanceOf("Attribute")&&!d._.isInstanceOf("Aspect")){let e=[];for(let n in h)h.hasOwnProperty(n)&&"func"===h[n].type&&!z(n)&&(e=u.Aspects.get(i,n,h[n]),e.length>0&&(h[n].aspects=e.slice(),Object.defineProperty(d,n,{value:$(n,e)})))}},Q=(e,n,t)=>{let r="";for(let i in d)d.hasOwnProperty(i)&&("prop"!==E(i)||!R(i)||H("readonly",i)||N(i)||T(i)||D(i)||z(i)||(r=G("serialize",i)[0]||i,t?n[i]=e[r]||n[i]:n[r]=e[i]))};d.func=((e,n)=>{if("function"==typeof e&&(n=e,e="constructor"),"_"===e)throw`${i}.${e} is not allowed.`;n||(n=o),z(e)&&(e="_"+e),null!==j&&V("mixed",j),h[e]=[].concat(y),h[e].type="func",h[e].aspects=[],h[e].interfaces=[],y=[];let t=h[e];if(!F(e))return void delete h[e];if(B("override",t)){let r=Object.getOwnPropertyDescriptor(d,e);if(!r||"function"!=typeof r.value)throw"_constructor"===e&&(e="constructor"),"_dispose"===e&&(e="dispose"),`${i}.${e} is not a function to override.`;if(H("sealed",e)&&!B("sealed",t))throw"_constructor"===e&&(e="constructor"),"_dispose"===e&&(e="dispose"),`${i}.${e} cannot override a sealed function.`;let s=d[e].bind(d);Object.defineProperty(d,e,{value:function(...e){let t=[s].concat(e);return U(n)?n(...t):n.apply(d,t)}.bind(d)})}else{if(K(e))throw"_constructor"===e&&(e="constructor"),"_dispose"===e&&(e="dispose"),`${i}.${e} is already defined.`;Object.defineProperty(d,e,{configurable:!0,enumerable:!0,writable:!1,value:function(...e){return U(n)?n(...e):n.apply(d,e)}.bind(d)})}W(e),h[e].ref=d[e],h[e].raw=n}),d.construct=((...e)=>{d.func.apply(d,["constructor"].concat(e))}),d.destruct=((...e)=>{d.func.apply(d,["dispose"].concat(e))}),d.prop=((e,n,t)=>{if(z(e))throw`${i}.${e} can only be defined as a function.`;"undefined"==typeof n&&"undefined"==typeof t&&(n=null),null!==j&&V("mixed",j),h[e]=[].concat(y),h[e].type="prop",h[e].aspects=[],h[e].interfaces=[],y=[];let r=h[e];if(!F(e))return void delete h[e];if(B("override",r)){let n=Object.getOwnPropertyDescriptor(d,e);if(!n||"function"!=typeof n.get)throw`Not a property to override. (${i}.${e})`;if(H("sealed",e)&&!B("sealed",r))throw`Cannot override a sealed property. (${i}.${e})`;if(H("static",e)&&!B("static",r))throw`Cannot override a static property. (${i}.${e})`}else if(K(e))throw`${i}.${e} is already defined.`;if("function"!=typeof n){let t=null,s="",u=!1;if(H("static",e)){if(s=e,H("session",e)||H("state",e))throw`A static property cannot be stored in session/state. (${i}.${e})`;t=v,t[s]||(t[s]=n)}else if(H("session",e)){if(!sessionStorage)throw`Session store (sessionStorage) is not available. (${i}.${e})`;s=i+"_"+e,t=sessionStorage,u=!0,"undefined"==typeof t[s]&&(t[s]=JSON.stringify({value:n}))}else if(H("state",e)){if(!sessionStorage)throw`State store (localStorage) is not available. (${i}.${e})`;s=i+"_"+e,t=localStorage,u=!0,"undefined"==typeof t[s]&&(t[s]=JSON.stringify({value:n}))}else s=e,t=g,t[s]=n;Object.defineProperty(d,e,{__proto__:null,configurable:!0,enumerable:!0,get:()=>{return u?JSON.parse(t[s]).value:t[s]},set:B("readonly",r)?n=>{if(!(d._.constructing||B("once",r)&&!t[s]))throw`${e} is readonly.`;u?t[s]=JSON.stringify({value:n}):t[s]=n}:e=>{u?t[s]=JSON.stringify({value:e}):t[s]=e}})}else{if(B("static",r))throw`Static properties cannot be defined with a getter/setter. (${i}.${e})`;if(B("session",r)||B("state",r))throw`Properties defined with a getter/setter cannot be stored in session/state. (${i}.${e})`;Object.defineProperty(d,e,{__proto__:null,configurable:!0,enumerable:!0,get:n,set:B("readonly",r)?i=>{if(!(d._.constructing||B("once",r)&&!n()))throw`${e} is readonly.`;"function"==typeof t&&t(i)}:e=>{"function"==typeof t&&t(e)}})}W(e),h[e].ref={get:()=>{return d[e]},set:n=>{d[e]=n}}}),d.event=((e,n)=>{if(z(e))throw`${i}.${e} can only be defined as a function.`;if(K(e))throw`${i}.${e} is already defined.`;h[e]=[],h[e].type="event",h[e].aspects=[],h[e].interfaces=[],y.length>0&&(console.warn(`Attributes can only be applied to properties or functions. ${i}.${e} is an event.`),y=[]);let t=function(...t){let r={};"function"==typeof n&&(r=n(...t));let i={name:e,args:r,stop:!1};for(let s of w)if(s(i),i.stop)break}.bind(d);t.subscribe=(e=>{w.push(e)}),t.subscribe.all=(()=>{return w.slice()}),t.unsubscribe=(e=>{let n=w.indexOf(e);n!==-1&&w.splice(n,1)}),t.unsubscribe.all=(()=>{w=[]}),Object.defineProperty(d,e,{configurable:!1,enumerable:!0,value:t,writable:!1}),h[e].ref=d[e]}),d.noop=o,d.noopAsync=f,d._=d._||{},d._.type="instance",d._.name=i,d._.id=k(),d._.instanceOf=d._.instanceOf||[],s||d._.instanceOf.push({name:"Object",type:Object,meta:[],mixins:[],interfaces:[]}),d._.instanceOf.push({name:i,type:_,meta:h,mixins:c,interfaces:l}),d._.inherits=_,d._.isInstanceOf=(e=>{return d._.instanceOf.findIndex(n=>{return n.name===e})!==-1}),d._.raw=(e=>{return h[e]&&h[e].raw?h[e].raw:null}),d._.isMixed=(e=>{let n=!1;for(let t of d._.instanceOf)for(let r of t.mixins){if(r._.name===e){n=!0;break}if(n)break}return n}),d._.isImplements=(e=>{let n=!1;for(let t of d._.instanceOf)for(let r of t.interfaces){if(r._.name===e){n=!0;break}if(n)break}return n}),d._._={hasAttr:B,hasAttrEx:H,isOwnMember:C,isDerivedMember:M,isProtectedMember:D,isSealedMember:P,isSerializableMember:R},d._.serialize=(()=>{let e={};return Q(d,e),e}),d._.deserialize=(e=>{Q(e,d,!0)});const X=V;if(X.attr=V,p.apply(d,[X]),e!==A&&I())throw`Cannot create instance of an abstract class. (${i})`;if(0!==c.length)for(let Y of c)"mixin"===Y._.type&&(j=Y,Y.apply(d,[X]),j=null);delete d.func,delete d.construct,delete d.destruct,delete d.prop,delete d.event,delete d.noop,delete d.noopAsync,q(),O||("function"==typeof d._constructor&&(d._.constructing=!0,d._constructor(...x),d._.constructor=this._constructor,delete d._constructor,delete d._.constructing),"function"==typeof d._dispose&&(d._.dispose=d._dispose,delete d._dispose));let Z=!1;J("_");for(let ee in d)Z=!1,d.hasOwnProperty(ee)&&(Z=!0,C(ee)?(T(ee)&&(Z=!1),Z&&D(ee)&&!O&&(Z=!1)):(D(ee)&&!O&&(Z=!1),Z&&!M(ee)&&(Z=!1))),Z&&L(ee)&&(Z=!1),Z&&J(ee);for(let ee in m)!z(ee)&&C(ee)&&P(ee)&&Object.defineProperty(m,ee,{configurable:!1});if(0!==l.length)for(let ne of l)for(let te in ne)if(ne.hasOwnProperty(te)&&"_"!==te){let e=ne[te],n=typeof m[te];if("undefined"===n)throw`${ne._.name}.${te} is not defined.`;switch(e.type){case"func":if("function"!==n)throw`${ne._.name}.${te} is not a function.`;h[te].interfaces.indexOf(ne)===-1&&h[te].interfaces.push(ne);break;case"prop":if("function"===n)throw`${ne._.name}.${te} is not a property.`;h[te].interfaces.indexOf(ne)===-1&&h[te].interfaces.push(ne);break;case"event":if("function"!==n||"function"!=typeof m[te].subscribe)throw`${ne._.name}.${te} is not an event.`;h[te].interfaces.indexOf(ne)===-1&&h[te].interfaces.push(ne)}}return d._.pu=O?null:m,d._.pr=O?null:d,S()?(_._.isSingleton=(()=>{return!0}),_._.singleInstance=(()=>{return Object.freeze(m)}),_._.singleInstance.clear=(()=>{_._.singleInstance=(()=>{return null}),_._.isSingleton=(()=>{return!1})}),_._.singleInstance()):P("_constructor")?(_._.isSealed=(()=>{return!0}),Object.freeze(m)):m};return _._={inherits:s,mixins:c,interfaces:l,name:i,type:"class",namespace:null,singleInstance:()=>{return null},isSingleton:()=>{return!1},isSealed:()=>{return!1},isDerivedFrom:e=>{let n="Object"===e,t=s;if(!n)while(!0){if(null===t)break;if(t._.name===e){n=!0;break}t=t._.inherits}return n},isMixed:e=>{let n=!1;for(let t of c)if(t._.name===e){n=!0;break}return n},isImplements:e=>{let n=!1;for(let t of l)if(t._.name===e){n=!0;break}return n},static:{}},_._.singleInstance.clear=(()=>{}),u.Namespace(_),_}),u.Mixin=((e,n)=>{return n._={name:e,type:"mixin",namespace:null},u.Namespace(n),n}),u.Interface=((e,n)=>{let t={},r={};const i=e=>{return["constructor","dispose","_constructor","_dispose","_"].indexOf(e)!==-1};return r.func=(n=>{if("undefined"!=typeof t[n])throw`${e}.${n} is already defined.`;if(i(n))throw`${e}.${n} can only be defined for a class.`;t[n]=[],t[n].type="func"}),r.prop=(n=>{if("undefined"!=typeof t[n])throw`${e}.${n} is already defined.`;if(i(n))throw`${e}.${n} can only be defined as a function for a class.`;t[n]=[],t[n].type="prop"}),r.event=(n=>{if("undefined"!=typeof t[n])throw`${e}.${n} is already defined.`;if(i(n))throw`${e}.${n} can only be defined as a function for a class.`;t[n]=[],t[n].type="event"}),t._={name:e,type:"interface",namespace:null},u.Namespace(t),n.apply(r),delete r.func,delete r.prop,delete r.event,t}),u.Enum=((e,n)=>{if("object"!=typeof n&&!Array.isArray(n))throw u.Exception("ENUM01","Invalid enum data.");let t=n;if(Array.isArray(n)){let e=0,t={};for(let r of n)t[e]=r,e++}let r={keys:()=>{let e=[];for(let n in t)t.hasOwnProperty(n)&&"_"!==n&&e.push(n);return e},values:()=>{let e=[];for(let n in t)t.hasOwnProperty(n)&&"_"!==n&&e.push(t[n]);return e}};return i("enum",e,t,r)}),u.Enum.getKeys=(e=>{try{return e._.keys()}catch(e){throw u.Exception("ENUM02","Object is not an Enum.",e)}}),u.Enum.getValues=(e=>{try{return e._.values()}catch(e){throw u.Exception("ENUM02","Object is not an Enum.",e)}}),u.Enum.isDefined=((e,n)=>{return u.Enum.getKeys().indexOf(n)!==-1||u.Enum.getValues().indexOf(n)!==-1}),u.Proc=((e,n,t)=>{"function"==typeof n&&(t=n,n=!1);let r=t;return r.isASync=(()=>{return n}),r._={name:e,type:"proc",namespace:null,invoke:(...e)=>{t(...e)}},u.Namespace(r),Object.freeze(r)}),u.Resource=((e,n,t)=>{const r=e=>{return btoa(encodeURIComponent(e).replace(/%([0-9A-F]{2})/g,function e(n,t){return String.fromCharCode("0x"+t)}))},i=e=>{return decodeURIComponent(atob(e).split("").map(function(e){return"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2)}).join(""))};let s=t,o=n.substr(n.lastIndexOf(".")+1).toLowerCase(),c=["txt","xml","js","json","md","css","html"];if(c.indexOf(o)!==-1)if(u.options.env.isServer){let e=new Buffer(s).toString("base64");s=e.toString("utf8")}else s=i(s);else u.options.env.isServer&&(s=new Buffer(s).toString("base64"));let f={file:()=>{return n},type:()=>{return o},get:()=>{return s},load:(...e)=>{if(u.options.env.isClient&&!f._.isLoaded)if(f._.isLoaded=!0,["gif","jpeg","jpg","png"].indexOf(o)!==-1){let n=e[0];if(n){let e=new Image;e.src="data:image/png;base64,"+t,n.appendChild(e),f._.isLoaded=!0}}else{let t,r,i,c=null;switch(o){case"css":t=u.options.env.global.document.createElement("style"),t.type="text/css",t.name=n,t.innerHTML=s,u.options.env.global.document.head.appendChild(t);break;case"js":r=u.options.env.global.document.createElement("script"),r.type="text/javascript",r.name=n,r.src=s,"function"==typeof cb&&(r.onload=e[0],r.onerror=(()=>{f._.isLoaded=!1})),u.options.env.global.document.head.appendChild(r);break;case"html":i=e[0],c=e[1]||"",i&&(c?i.innerHTML=s:i.insertAdjacentHTML(c,s))}}return f._.isLoaded}};if(f._={name:e,type:"resource",namespace:null,file:n,isLoaded:!1,data:()=>{return s}},f.JSON=null,"json"===f.type())try{f.JSON=Object.freeze(JSON.parse(s))}catch(e){}return u.Namespace(f),Object.freeze(f)}),u.Resource.get=(e=>{let n=u.Namespace.getType(e);return n._&&"resource"===n._.type?n.get():null}),u.Structure=((e,n)=>{if("function"!=typeof n)throw u.Exception("STRU01","Invalid structure definition type.");let t=function(...e){let r={};n.apply(r,...e);let i={inherits:t};return s("sinstance",r,i)},r={};return i("structure",e,t,r)}),u.which=((e,n)=>{if(n){if(e.indexOf("{.min}")!==-1)return u.options.env.isProd?e.replace("{.min}",".min"):e.replace("{.min}","")}else if(e.indexOf("|")!==-1){let n=e.split("|"),t="";return t=u.options.env.isServer?n[0].trim():n[1].trim(),"x"===t&&(t=""),t}return e}),u.using=((e,n)=>{try{n(e)}finally{e._&&"function"==typeof e._.dispose&&e._.dispose()}}),u.as=((e,n)=>{if(!e||!e._||"instance"!==e._.type)throw new u.Exception("AS01",`Unknown/unsupported object type: ${e&&e._&&e._.type?e._.type:""}`);if("string"==typeof n)switch(n){case"public":return e._.pu;break;case"protected":case"private":return e._.pr;break;default:throw new u.Exception("AS03",`Unknown scope type: ${n}`)}else switch(n._.type){case"interface":if(e._.isImplements(n._.name))return e;break;case"mixin":if(e._.isMixed(n._.name))return e;break;case"class":if(e._.isInstanceOf(n._.name))return e;break;default:throw new u.Exception("AS02",`Unknown/unsupported interface type: ${n}`)}return null}),u.is=((e,n)=>{if("string"!=typeof n)return null!==u.as(e);throw new u.Exception("IS01",`Scope types are not supported: ${n}`)}),u.classOf=(e=>{if(e._&&"instance"===e._.type)return e._.inherits;throw"Invalid arguments."}),u.isDerivedFrom=((e,n)=>{if(e._&&"class"===e._.type&&n._&&"class"===n._.type)return!!e._.isDerivedFrom(n._.name);throw"Invalid arguments."}),u.isImplements=((e,n)=>{if(e._&&("class"===e._.type||"instance"===e._.type)&&n._&&"interface"===n._.type)return!!e._.isImplements(n._.name);throw"Invalid arguments."}),u.isInstanceOf=((e,n)=>{if(e._&&"instance"===e._.type&&n._&&"class"===n._.type)return!!e._.isInstanceOf(n._.name);throw"Invalid arguments."}),u.isMixed=((e,n)=>{if(e._&&("class"===e._.type||"instance"===e._.type)&&n._&&"mixin"===n._.type)return!!e._.isMixed(n._.name);throw"Invalid arguments."});let d={};u.Container={},u.Container.register=((e,n)=>{"function"==typeof e&&(n=e,e=n._.name),"string"==typeof e&&"string"==typeof n&&(n=u.which(n),n.endsWith(".js")||n.endsWith(".mjs")||(n=u.Namespace.getType(n))),d[e]||(d[e]=[]),d[e].push(n)}),u.Container.isRegistered=(e=>{return"undefined"!=typeof d[e]}),u.Container.get=(e=>{return(d[e]||[]).slice()}),u.Container.resolve=((e,n,...t)=>{let r=null,i=e=>{let n=e;return e._&&e._.type&&["class","structure"].indexOf(e._.type)!==-1&&(n=new e(...t)),n};if(d[e]&&d[e].length>0)if(n){r=[];for(let n of d[e])r.push(i(n))}else{let n=d[e][0];r=i(n)}return r}),u.Attribute=u.Class("Attribute",function(e){let n=null;e("abstract"),this.construct((...e)=>{this.args=[];for(let n of e)if("string"==typeof n)if(n.startsWith("[")&&n.endsWith("]")){let e=n.replace("[","").replace("]",""),t=function(){let n=this[e];return"function"==typeof n?n():n};this.args.push(t)}else this.args.push(n);else this.args.push(n)}),this.prop("args",[]),this.func("decorator",e=>{return"function"==typeof e&&(n=e),n}),this.func("resetEventInterface",(e,n)=>{n.subscribe=e.subscribe,n.unsubscribe=e.unsubscribe,delete e.subscribe,delete e.unsubscribe})}),u.Container.register(u.Class("async",u.Attribute,function(){this.decorator((e,n,t,r)=>{if(["func"].indexOf(n)===-1)throw`async attribute cannot be applied on ${n} members.`;if(["_constructor","_dispose"].indexOf(n)!==-1)throw`async attribute cannot be applied on special function.`;let i=r.value;r.value=function(...e){return new Promise((n,t)=>{let r=[n,t].concat(e);i(...r)})}.bind(e)})})),u.Container.register(u.Class("deprecate",u.Attribute,function(){this.decorator((e,n,t,r)=>{if(["_constructor","_dispose"].indexOf(n)!==-1)throw`deprecate attribute cannot be applied on special function.`;let i=`${t} is deprecated.`,s,u,o,c=null;switch("undefined"!=typeof this.args[0]&&(i+=" "+this.args[0]),n){case"prop":r.get&&(s=r.get,r.get=function(){return console.warn(i),s()}.bind(e)),r.set&&(u=r.set,r.set=function(e){return console.warn(i),u(e)}.bind(e));break;case"func":o=r.value,r.value=function(...e){console.warn(i),o(...e)}.bind(e);break;case"event":c=r.value,r.value=function(...e){console.warn(i),c(...e)}.bind(e),this.resetEventInterface(o,r.value)}})})),u.Container.register(u.Class("enumerate",u.Attribute,function(){this.decorator((e,n,t,r)=>{if(["_constructor","_dispose"].indexOf(n)!==-1)throw`enumerate attribute cannot be applied on special function.`;let i=this.args[0];r.enumerable=i})})),u.Container.register(u.Class("inject",u.Attribute,function(){this.decorator((e,n,t,r)=>{if(["func","prop"].indexOf(n)===-1)throw`inject attribute cannot be applied on ${n} members.`;if(["_constructor","_dispose"].indexOf(t)!==-1)throw`inject attribute cannot be applied on special function.`;let i=this.args[0],s=this.args[1],o=null,c=null;switch(Array.isArray(s)||(s=[s]),"string"==typeof i?(i=u.which(i),o=u.Container.resolve(i,!1,...s)):o=new i(...s),n){case"func":c=r.value,r.value=function(...e){c(o,...e)}.bind(e);break;case"prop":e[t]=o}})})),u.Container.register(u.Class("multiinject",u.Attribute,function(){this.decorator((e,n,t,r)=>{if(["func","prop"].indexOf(n)===-1)throw`multiinject attribute cannot be applied on ${n} members.`;if(["_constructor","_dispose"].indexOf(t)!==-1)throw`multiinject attribute cannot be applied on special function.`;let i=this.args[0],s=this.args[1],o=null,c=null;if(Array.isArray(s)||(s=[s]),"string"!=typeof i)throw`multiinject attribute does not support direct type injections.`;switch(i=u.which(i),o=u.Container.resolve(i,!0,...s),n){case"func":c=r.value,r.value=function(...e){c(o,...e)}.bind(e);break;case"prop":e[t]=o}})}));let m=[],_=e=>{return e.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&")},b=e=>{return new RegExp("^"+e.split(/\*+/).map(_).join(".*")+"$")};u.Aspects={},u.Aspects.raw=(()=>{return m}),u.Aspects.register=((e,n)=>{let t=e||"~",r="",i="",s="",u="~",o="";if(t.indexOf("/")!==-1){let e=t.split("/");t=e[0].trim(),u=e[1].trim()}if("~"===t)r="~",i="~",s="~";else if(""===t)r="^",i="~",s="~";else if(t.indexOf(".")===-1)if(r="^",t.indexOf(":")===-1)i=t,s="~";else{let e=t.split(":");i=e[0].trim(),s=e[1].trim()}else if(r=t.substr(0,t.lastIndexOf(".")),t=t.substr(t.lastIndexOf(".")+1),t.indexOf(":")===-1)i=t,s="~";else{let e=t.split(":");i=e[0].trim(),s=e[1].trim()}"*"!==r&&""!==r||(r="~"),"*"!==i&&""!==i||(i="~"),"*"!==s&&""!==s||(s="~"),"*"!==u&&""!==u||(u="~"),o=`${r}=${i}=${s}=${u}`,m[o]=m[o]||[],m[o].push(n)}),u.Aspects.get=((e,n,t)=>{let r=[],i="",s="",u=n.trim();e.indexOf(".")!==-1?(i=e.substr(0,e.lastIndexOf(".")).trim(),s=e.substr(e.lastIndexOf(".")+1).trim()):(i="^",s=e.trim());for(let o in m){let e=o.split("="),n=e[0],c=b(n),f=e[1],a=b(f),l=e[2],p=b(l),d=e[3],_=b(d),y="~"===d;if((i===n||c.test(i))&&(s===f||a.test(s))&&(u===l||p.test(u))){if(!y)for(let e of t)if(e.name===d||_.test(e.name)){y=!0;break}if(y)for(let n of m[o])r.indexOf(n)===-1&&r.push(n)}}return r}),u.Aspect=u.Class("Aspect",function(e){let n=null,t=null,r=null;e("abstract"),this.construct((...e)=>{this.args=e}),this.prop("args",[]),this.func("before",e=>{return"function"==typeof e&&(n=e),n}),this.func("after",e=>{return"function"==typeof e&&(t=e),t}),this.func("around",e=>{return"function"==typeof e&&(r=e),r})}),u.Serializer={},u.Serializer.serialize=(e=>{return"instance"===e._.type?e._.serialize():null}),u.Serializer.deserialize=((e,n)=>{let t=new e;return"instance"===t._.type?(t._.deserialize(n),t):null}),u.Reflector={},u.Reflector.get=(e=>{const n=function(e){this.getType=(()=>{return e._.type}),this.getName=(()=>{return e._.name||""}),this.getNamespace=(()=>{let n=e._.namespace;return n?new h(n):null}),this.getAssembly=(()=>{let n=u.Assembly.get(e._.name);return n?new g(n):null}),this.getTarget=(()=>{return e}),this.isInstance=(()=>{return"instance"===e._.type}),this.isClass=(()=>{return"class"===e._.type}),this.isEnum=(()=>{return"enum"===e._.type}),this.isProc=(()=>{return"proc"===e._.type}),this.isStructure=(()=>{return"structure"===e._.type}),this.isStructureInstance=(()=>{return"sinstance"===e._.type}),this.isNamespace=(()=>{return"namespace"===e._.type}),this.isResource=(()=>{return"resource"===e._.type}),this.isAssembly=(()=>{return"assembly"===e._.type}),this.isMixin=(()=>{return"mixin"===e._.type}),this.isInterface=(()=>{return"interface"===e._.type})},t=function(e,n,t){this.getType=(()=>{return"member"}),this.getMemberType=(()=>{return e}),this.getTarget=(()=>{return n}),this.getTargetType=(()=>{return n._.type}),this.getName=(()=>{return t})},r=function(e,n,t,r){this.getType=(()=>{return"attribute"}),this.getName=(()=>{return n}),this.getTarget=(()=>{return r}),this.getArgs=(()=>{return t.slice()}),this.getClass=(()=>{return e?new d(e):null})},i=function(e,n){this.getType=(()=>{return"aspect"}),this.getName=(()=>{return e._.name}),this.getTarget=(()=>{return n}),this.getClass=(()=>{return e?new d(e):null})},s=function(e,n,i,s){let u=new t(e,n,i);return u.getRef=(()=>{return s}),u.getAttributes=(()=>{let e=[],t=[];for(let s of n._.instanceOf)if(s.meta[i]){t=s.meta[i];for(let u of t)e.push(new r(u.Attr,u.name,u.args,n))}return e}),u.hasAttribute=(e=>{let t=!1,r=[];for(let s of n._.instanceOf){if(s.meta[i]){r=s.meta[i];for(let n of r)if(n.name==e){t=!0;break}}if(t)break}return t}),u.getAttribute=(e=>{let t=null;for(let s of n._.instanceOf){if(s.meta[i]){let u=s.meta[i];for(let o of u)if(o.name===e){t=new r(o.Attr,o.name,o.args,n);break}}if(null!==t)break}return t}),u.isEnumerable=(()=>{return!!n[i]&&Object.getOwnPropertyDescriptor(n,i).enumerable}),u.isDeprecated=(()=>{return n._._.hasAttrEx("deprecate",i)}),u.isConditional=(()=>{return n._._.hasAttrEx("conditional",i)}),u.isOverridden=(()=>{return n._._.hasAttrEx("override",i)}),u.isOwn=(()=>{return n._.isOwnMember(i)}),u.isDerived=(()=>{return n._._.isDerivedMember(i)}),u.isPrivate=(()=>{return n._._.hasAttrEx("private",i)}),u.isProtected=(()=>{return n._._.isProtectedMember(i)}),u.isPublic=(()=>{return!u.isPrivate&&!u.isProtected}),u.isSealed=(()=>{return n._._.isSealedMember(i)}),u.isMixed=(()=>{return n._._.hasAttrEx("mixed",i)}),u.getMixin=(()=>{if(u.isMixed()){let e=u.getAttribute("mixed").getArgs()[0];return new w(e)}return null}),u.isInterfaceEnforced=(()=>{return u.getInterfaces().length>0}),u.getInterfaces=(()=>{let e=[],t=[];for(let r of n._.instanceOf)if(r.meta[i]){t=r.meta[i].interfaces;for(let s of t)e.push(new x(s,n))}return e}),u.isProp=(()=>{return"prop"===e}),u.isFunc=(()=>{return"func"===e}),u.isEvent=(()=>{return"event"===e}),u},o=function(e,n,t){let r=new s("prop",e,n,t);return r.getValue=(()=>{return e[n]}),r.setValue=(t=>{return e[n]=t}),r.getRaw=(()=>{return t}),r.isReadOnly=(()=>{return e._._.hasAttrEx("readonly",n)}),r.isSetOnce=(()=>{return e._._.hasAttrEx("readonly",n)&&e._._.hasAttrEx("once",n)}),r.isStatic=(()=>{return e._._.hasAttrEx("static",n)}),r.isSerializable=(()=>{return e._._.isSerializableMember(n)}),r},c=function(e,n,t,r){let u=new s("func",e,n,t);return u.invoke=((...t)=>{return e[n](...t)}),u.getAspects=(()=>{let t=[],r=[];for(let s of e._.instanceOf)if(s.meta[n]){r=s.meta[n].aspects;for(let u of r)t.push(new i(u,e))}return t}),u.getRaw=(()=>{return r}),u.isASync=(()=>{return e._._.hasAttrEx("async",n)}),u.isConstructor=(()=>{return"_constructor"===n}),u.isDisposer=(()=>{return"_dispose"===n}),u},f=function(e,n,t){let r=new s("event",e,n,t);return r.raise=((...e)=>{return t(...e)}),r.isSubscribed=(()=>{return t.subscribe.all().length>0}),r},a=function(e,n){let r=new t("key",e,n);return r.getValue=(()=>{return e[n]}),r},l=function(e){
let t=new n(e),r=(e,n,t)=>{if(""===n&&0===t.length)return e.slice();let r=[],i=!0;for(let s of e)if("member"===s.getType()&&(""===n||s.getMemberType()===n)){if(i=!0,0!==t.length)for(let e of t)if(!s.hasAttribute(e)){i=!1;break}i&&r.push(s)}return r},i=n=>{let t=[],i=[],s=null,u=null;for(let a of e._.instanceOf){for(let r in a.meta){if(a.meta.hasOwnProperty(r)){switch(i=a.meta[r],a.meta[r].type){case"func":s=new c(e,r,a.meta[r].ref,a.meta[r].raw),t.push(s);break;case"prop":s=new o(e,r,a.meta[r].ref),t.push(s);break;case"event":s=new f(e,r,a.meta[r].argNames,a.meta[r].ref),t.push(s);break;default:throw"Unknown member type"}"undefined"!=typeof n&&r===n&&(t=[],u=s)}if(null!==u)break}if(null!==u)break}return null!==u?u:{all:(...e)=>{return r(t,"",e)},func:(...e)=>{return r(t,"func",e)},prop:(...e)=>{return r(t,"prop",e)},event:(...e)=>{return r(t,"event",e)}}};return t.getClass=(()=>{return null!==e._.inherits?new d(e._.inherits):null}),t.getFamily=(()=>{let n=[],t=e._.inherits;while(!0){if(null===t)break;n.push(new d(t)),t=t._.inherits}return n}),t.getMixins=(()=>{let e=[],n=t.getFamily();for(let r of n)e=e.concat(r.getMixins());return e}),t.getInterfaces=(()=>{let e=[],n=t.getFamily();for(let r of n)e=e.concat(r.getInterfaces());return e}),t.getMembers=((...e)=>{let n=i();return 0!==e.length?n.all(...e):n}),t.getMember=(e=>{return i(e)}),t.isSingleton=(()=>{return t.getClass().isSingleton()}),t.isInstanceOf=(n=>{return e._.isInstanceOf(n)}),t.isMixed=(n=>{return e._.isMixed(n)}),t.isImplements=(n=>{return e._.isImplements(n)}),t},p=function(e){let t=new n(e);return t.getStructure=(()=>{return null!==e._.inherits?new y(e._.inherits):null}),t.getMembers=(()=>{let n=Object.keys(e),t=n.indexOf("_");return t!==-1&&n.splice(t,1),n}),t.getMember=(n=>{return e[n]}),t.invoke=((...n)=>{return e[name](...n)}),t.isInstanceOf=(n=>{return e._.inherits._.name===n}),t},d=function(e){let t=new n(e);return t.getParent=(()=>{return null!==e._.inherits?new d(e._.inherits):null}),t.getFamily=(()=>{let n=[],t=e._.inherits;while(!0){if(null===t)break;n.push(new d(t)),t=t._.inherits}return n}),t.getMixins=(()=>{let n=[];for(let t of e._.mixins)n.push(new w(t));return n}),t.getInterfaces=(()=>{let n=[];for(let t of e._.interfaces)n.push(new x(t));return n}),t.isSingleton=(()=>{return e._.isSingleton()}),t.isSingleInstanceCreated=(()=>{return null!==e._.singleInstance()}),t.isSealed=(()=>{return e._.isSealed()}),t.isDerivedFrom=(n=>{return e._.isDerivedFrom(n)}),t.isMixed=(n=>{return e._.isMixed(n)}),t.isImplements=(n=>{return e._.isImplements(n)}),t},m=function(e){let t=new n(e);return t.getMembers=(()=>{let n=e._.keys(),t=[];for(let r of n)t.push(new a(e,r));return t}),t.getMember=(n=>{if("undefined"==typeof e[n])throw`${n} is not defined.`;return new a(e,n)}),t.getKeys=(()=>{return e._.keys()}),t.getValues=(()=>{return e._.values()}),t},_=function(e){let t=new n(e);return t.isASync=(()=>{e.isASync()}),t.invoke=((...n)=>{return e._.invoke(...n)}),t},b=function(e){let t=new n(e);return t.getFile=(()=>{return e.file()}),t.getResType=(()=>{return e.type()}),t.getContent=(()=>{return e.get()}),t},y=function(e){let t=new n(e);return t},h=function(e){let t=new n(e);return t.getMembers=(()=>{let n=e.getTypes(),t=[];if(n)for(let r of n)switch(r._.type){case"class":t.push(new d(r));break;case"enum":t.push(new m(r));break;case"structure":t.push(new y(r));break;case"mixin":t.push(new w(r));break;case"interface":t.push(new x(r))}return t}),t.getMember=(n=>{let t=e.getType(n),r=null;if(t)switch(t._.type){case"class":r=new d(t);break;case"enum":r=new m(t);break;case"structure":r=new y(t);break;case"mixin":r=new w(t);break;case"interface":r=new x(t)}return r}),t.createInstance=((n,...t)=>{return e.createInstance(n,...t)}),t},g=function(e){let t=new n(e);return t.getTypes=(()=>{return e.types()}),t.getAssets=(()=>{return e.assets()}),t.getADO=(()=>{return e._.ado}),t.load=(()=>{return e.load()}),t},w=function(e){let t=new n(e);return t},x=function(e){let r=new n(e),i=()=>{let n=[];for(let r in e)e.hasOwnProperty(r)&&"_"!==r&&n.push(new t(e[r].type,e,r));return n};return r.getMembers=(()=>{return i()}),r.getMember=(n=>{if("undefined"==typeof e[n])throw`${n} is not defined.`;return new t(e[n].type,e,n)}),r};let O=null;switch(e._.type){case"instance":O=new l(e);break;case"sinstance":O=new p(e);break;case"class":O=new d(e);break;case"enum":O=new m(e);break;case"proc":O=new _(e);break;case"resource":O=new b(e);break;case"structure":O=new y(e);break;case"namespace":O=new h(e);break;case"assembly":O=new g(e);break;case"mixin":O=new w(e);break;case"interface":O=new x(e);break;default:throw`Unknown type ${e._.type}.`}return O});let y=a.env.global;return a.env.supressGlobals||(y.Exception=Object.freeze(u.Exception),y.Class=Object.freeze(u.Class),y.Mixin=Object.freeze(u.Mixin),y.Interface=Object.freeze(u.Interface),y.Structure=Object.freeze(u.Structure),y.Enum=Object.freeze(u.Enum),y.Proc=Object.freeze(u.Proc),y.Resource=Object.freeze(u.Resource),y.Assembly=Object.freeze(u.Assembly),y.Namespace=Object.freeze(u.Namespace),y.which=Object.freeze(u.which),y.bring=Object.freeze(u.bring),y.using=Object.freeze(u.using),y.as=Object.freeze(u.as),y.is=Object.freeze(u.is),y.isDerivedFrom=Object.freeze(u.isDerivedFrom),y.isImplements=Object.freeze(u.isImplements),y.isInstanceOf=Object.freeze(u.isInstanceOf),y.isMixed=Object.freeze(u.isMixed),y.classOf=Object.freeze(u.classOf),y.Attribute=Object.freeze(u.Attribute),y.Aspects=Object.freeze(u.Aspects),y.Aspect=Object.freeze(u.Aspect),y.Container=Object.freeze(u.Container),y.Serializer=Object.freeze(u.Serializer),y.Reflector=Object.freeze(u.Reflector)),y.flair=Object.freeze(u),y.flair});